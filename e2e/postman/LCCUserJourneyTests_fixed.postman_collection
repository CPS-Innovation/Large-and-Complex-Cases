{
    "info":  {
                 "_postman_id":  "b2320ee5-aa8b-48c8-b9b6-4802b9a1a2af",
                 "name":  "LCC User Journey Tests (with Case Registration) Copy 3",
                 "description":  "Complete LCC API testing collection with AUTOMATIC authentication and Case Registration.\n\n## Quick Start\n\n**Just set 4 variables and run!**\n\n| Variable | Your Value |\n|----------|------------|\n| `azureUsername` | Your Azure AD email |\n| `azurePassword` | Your Azure AD password |\n| `cmsUsername` | Your CMS username (e.g., Name.CIN3) |\n| `cmsPassword` | Your CMS password |\n| `egressWorkspaceName` | Workspace name (sets defendant surname) |\n\n## Sections\n\n1. **Authentication** - Azure AD \u0026 CMS auth (auto-handled)\n2. **Case Registration** - Register cases with defendants matching workspace name\n3. **Case Management** - Search and manage cases  \n4. **Egress Integration** - List Egress files via LCC API\n5. **NetApp Integration** - List NetApp files\n6. **File Transfer** - Egress \u003c-\u003e NetApp transfers (includes Register Case)\n7. **System** - Health checks\n8. **Egress Direct Upload** - 100MB automated file upload\n\n## Egress to NetApp Workflow\n\n1. Run **5.0 Register Case** - Creates case with defendant = workspace name\n2. Run **5.1 List Egress Files** - Gets files from workspace\n3. Run **5.2 Validate Transfer** - Validates transfer\n4. Run **5.3 Initiate Transfer** - Starts the transfer\n5. Run **5.4 Get Transfer Status** - Monitor progress\n\n## Pre-configured (DEV Environment)\n\n- `baseUrl` - LCC API\n- `caseApiBaseUrl` - Case Management API (fa-cm-api-dev)\n- `ddeiBaseUrl` - DDEI API\n- `egressBaseUrl` - Egress API",
                 "schema":  "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
                 "_exporter_id":  "49647760",
                 "_collection_link":  "https://go.postman.co/collection/49647760-b2320ee5-aa8b-48c8-b9b6-4802b9a1a2af?source=collection_link"
             },
    "item":  [
                 {
                     "name":  "1. Authentication",
                     "item":  [
                                  {
                                      "name":  "1.1 Get Azure AD Token (ROPC)",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "console.log(\u0027Getting Azure AD token via ROPC flow...\u0027);",
                                                                                    "console.log(\u0027Username:\u0027, pm.environment.get(\u0027azureUsername\u0027));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    ",
                                                                                    "    if (response.access_token) {",
                                                                                    "        // Save to environment",
                                                                                    "        pm.environment.set(\u0027accessToken\u0027, response.access_token);",
                                                                                    "        pm.environment.set(\u0027bearerToken\u0027, response.access_token);",
                                                                                    "        ",
                                                                                    "        const expiresIn = response.expires_in;",
                                                                                    "        const expiryTime = Date.now() + (expiresIn * 1000);",
                                                                                    "        pm.environment.set(\u0027accessTokenExpiry\u0027, String(expiryTime));",
                                                                                    "        ",
                                                                                    "        console.log(\u0027[OK] Azure AD Token obtained\u0027);",
                                                                                    "        console.log(\u0027Expires in:\u0027, expiresIn, \u0027seconds\u0027);",
                                                                                    "        ",
                                                                                    "        pm.test(\u0027Access token obtained\u0027, function() {",
                                                                                    "            pm.expect(response.access_token).to.be.a(\u0027string\u0027);",
                                                                                    "        });",
                                                                                    "    } else {",
                                                                                    "        console.error(\u0027No access_token in response\u0027);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    const error = pm.response.json();",
                                                                                    "    console.error(\u0027Error:\u0027, error.error, \u0027-\u0027, error.error_description);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "client_id",
                                                                                          "value":  "{{apiClientId}}",
                                                                                          "type":  "text"
                                                                                      },
                                                                                      {
                                                                                          "key":  "scope",
                                                                                          "value":  "api://{{apiClientId}}/user_impersonation",
                                                                                          "type":  "text"
                                                                                      },
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{azureUsername}}",
                                                                                          "type":  "text"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{azurePassword}}",
                                                                                          "type":  "text"
                                                                                      },
                                                                                      {
                                                                                          "key":  "grant_type",
                                                                                          "value":  "password",
                                                                                          "type":  "text"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "https://login.microsoftonline.com/{{tenantId}}/oauth2/v2.0/token",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "login",
                                                                               "microsoftonline",
                                                                               "com"
                                                                           ],
                                                                  "path":  [
                                                                               "{{tenantId}}",
                                                                               "oauth2",
                                                                               "v2.0",
                                                                               "token"
                                                                           ]
                                                              },
                                                      "description":  "Get Azure AD token using Resource Owner Password Credentials (ROPC) flow.\n\n**Required Variables:**\n- `tenantId` - Azure AD tenant ID\n- `uiClientId` - UI application client ID\n- `apiClientId` - API application client ID\n- `azureUsername` - Your Azure AD email\n- `azurePassword` - Your Azure AD password\n\n**Outputs:**\n- `accessToken` - JWT token for API calls\n- `bearerToken` - Same as accessToken"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "1.2 Get CMS Auth (DDEI)",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "console.log(\u0027Getting CMS auth via DDEI...\u0027);",
                                                                                    "console.log(\u0027Username:\u0027, pm.environment.get(\u0027cmsUsername\u0027));"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    ",
                                                                                    "    if (response.Cookies) {",
                                                                                    "        const compactJson = JSON.stringify(response);",
                                                                                    "        const encoded = encodeURIComponent(compactJson);",
                                                                                    "        ",
                                                                                    "        // Save to environment",
                                                                                    "        pm.environment.set(\u0027cmsAuth\u0027, encoded);",
                                                                                    "        pm.environment.set(\u0027cmsAuthValues\u0027, encoded);",
                                                                                    "        ",
                                                                                    "        if (response.ExpiryTime) {",
                                                                                    "            pm.environment.set(\u0027cmsAuthExpiry\u0027, String(new Date(response.ExpiryTime).getTime()));",
                                                                                    "        }",
                                                                                    "        ",
                                                                                    "        console.log(\u0027[OK] CMS Auth obtained\u0027);",
                                                                                    "        console.log(\u0027Token:\u0027, response.Token);",
                                                                                    "        ",
                                                                                    "        pm.test(\u0027CMS cookies obtained\u0027, function() {",
                                                                                    "            pm.expect(response.Cookies).to.include(\u0027.CMSAUTH\u0027);",
                                                                                    "        });",
                                                                                    "    } else {",
                                                                                    "        console.error(\u0027No Cookies in response\u0027);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Auth failed:\u0027, pm.response.text());",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     },
                                                                     {
                                                                         "key":  "x-functions-key",
                                                                         "value":  "{{ddeiAccessKey}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{cmsUsername}}",
                                                                                          "type":  "text"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{cmsPassword}}",
                                                                                          "type":  "text"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{ddeiBaseUrl}}/authenticate",
                                                                  "host":  [
                                                                               "{{ddeiBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "authenticate"
                                                                           ]
                                                              },
                                                      "description":  "Get CMS authentication cookie via DDEI /authenticate endpoint.\n\n**Required Variables:**\n- `ddeiBaseUrl` - DDEI API URL\n- `ddeiAccessKey` - DDEI function key (x-functions-key)\n- `cmsUsername` - CMS username (e.g., Name.CIN3)\n- `cmsPassword` - CMS password\n\n**Outputs:**\n- `cmsAuth` - URL-encoded CMS auth JSON\n- `cmsAuthValues` - Same as cmsAuth"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "1.3 Verify Auth",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "console.log(\u0027Correlation ID:\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027API is accessible\u0027, function() {",
                                                                                    "    pm.expect(pm.response.code).to.be.oneOf([200, 401, 403]);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const token = pm.environment.get(\u0027accessToken\u0027);",
                                                                                    "const cmsAuth = pm.environment.get(\u0027cmsAuth\u0027);",
                                                                                    "",
                                                                                    "console.log(\u0027\u0027);",
                                                                                    "console.log(\u0027=== Authentication Status ===\u0027);",
                                                                                    "console.log(\u0027Bearer Token: \u0027 + (token ? \u0027PRESENT\u0027 : \u0027MISSING\u0027));",
                                                                                    "console.log(\u0027CMS Auth: \u0027 + (cmsAuth ? \u0027PRESENT\u0027 : \u0027MISSING\u0027));",
                                                                                    "console.log(\u0027\u0027);",
                                                                                    "",
                                                                                    "if (token \u0026\u0026 cmsAuth) {",
                                                                                    "    console.log(\u0027Ready to make API calls!\u0027);",
                                                                                    "} else {",
                                                                                    "    if (!token) console.error(\u0027Run 1.1 Get Azure AD Token first\u0027);",
                                                                                    "    if (!cmsAuth) console.error(\u0027Run 1.2 Get CMS Auth first\u0027);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/status",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "status"
                                                                           ]
                                                              },
                                                      "description":  "Verify that authentication tokens are set.\n\nRun this after 1.1 and 1.2 to confirm both tokens are obtained."
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "Authentication requests for LCC API.\n\n## Flow\n\n1. **1.1 Get Azure AD Token** - ROPC flow â†’ `accessToken`\n2. **1.2 Get CMS Auth** - DDEI â†’ `cmsAuth`\n3. **1.3 Verify Auth** - Check both tokens are set\n\n## Required Variables\n\n| Variable | Description |\n|----------|-------------|\n| `azureUsername` | Azure AD email |\n| `azurePassword` | Azure AD password |\n| `cmsUsername` | CMS username (e.g., Name.CIN3) |\n| `cmsPassword` | CMS password |"
                 },
                 {
                     "name":  "Case Registration",
                     "item":  [
                                  {
                                      "name":  "Register Case - With Defendants (Workspace Name)",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate new unique ref for this request",
                                                                                    "const uniqueRef = String(Math.floor(10000 + Math.random() * 90000));",
                                                                                    "pm.environment.set(\"urnUniqueRef\", uniqueRef);",
                                                                                    "console.log(\"Generated URN Ref:\", uniqueRef);",
                                                                                    "",
                                                                                    "// Get workspace name for defendant surname",
                                                                                    "const workspaceName = pm.environment.get(\"egressWorkspaceName\") || \"Automation-Testing\";",
                                                                                    "pm.environment.set(\"defendantSurname\", workspaceName);",
                                                                                    "console.log(\"Defendant Surname (from workspace):\", workspaceName);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200 OK\", function () {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "var responseBody = pm.response.json();",
                                                                                    "",
                                                                                    "pm.test(\"caseId is greater than 0\", function () {",
                                                                                    "    pm.expect(responseBody.caseId).to.be.above(0);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\"caseId is an integer\", function () {",
                                                                                    "    pm.expect(Number.isInteger(responseBody.caseId)).to.be.true;",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\"URN format valid\", function () {",
                                                                                    "    const urnPattern = /^\\d{2}[A-Z0-9]{2}\\d{7}$/;",
                                                                                    "    pm.expect(responseBody.urn).to.match(urnPattern);",
                                                                                    "});",
                                                                                    "",
                                                                                    "// Store for Egress workflow",
                                                                                    "if (responseBody.caseId) {",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);",
                                                                                    "    pm.environment.set(\"lastCreatedUrn\", responseBody.urn);",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);",
                                                                                    "    console.log(\"=== CASE CREATED ===\");",
                                                                                    "    console.log(\"Case ID:\", responseBody.caseId);",
                                                                                    "    console.log(\"URN:\", responseBody.urn);",
                                                                                    "    console.log(\"Defendant Surname:\", pm.environment.get(\"defendantSurname\"));",
                                                                                    "    console.log(\"Ready for Egress workflow\");",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"urn\": {\n        \"policeForce\": \"45\",\n        \"policeUnit\": \"EL\",\n        \"uniqueRef\": \"{{urnUniqueRef}}\",\n        \"year\": 25\n    },\n    \"registeringAreaId\": 1001,\n    \"registeringUnitId\": 2002,\n    \"allocatedWcuId\": 2012391,\n    \"crest\": \"\",\n    \"operationName\": \"\",\n    \"courtLocationId\": 0,\n    \"courtLocationName\": \"\",\n    \"hearingDate\": null,\n    \"defendants\": [\n        {\n            \"isDefendant\": true,\n            \"surname\": \"{{defendantSurname}}\",\n            \"firstname\": \"TestUser\",\n            \"companyName\": \"\",\n            \"dateOfBirth\": \"1984-05-23\",\n            \"gender\": \"M\",\n            \"disability\": \"U\",\n            \"ethnicity\": \"W1\",\n            \"religion\": \"NP\",\n            \"type\": \"UN\",\n            \"arrestDate\": null,\n            \"seriousDangerousOffender\": false,\n            \"arrestSummonsNumber\": \"\",\n            \"isNotYetCharged\": false,\n            \"aliases\": [\n                {\n                    \"listOrder\": 0,\n                    \"surname\": \"AliasTest\",\n                    \"firstNames\": \"Automation\"\n                }\n            ],\n            \"charges\": [\n                {\n                    \"offenceCode\": \"FI68036\",\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\n                    \"offenceId\": \"22336\",\n                    \"dateFrom\": \"2025-10-01\",\n                    \"dateTo\": null,\n                    \"comment\": \"Automation test charge\",\n                    \"offenceLocation\": {\n                        \"addressLine1\": \"123 Test Street\",\n                        \"addressLine2\": \"\",\n                        \"townCity\": \"London\",\n                        \"postcode\": \"SW1A 1AA\"\n                    },\n                    \"victimIndexId\": 0,\n                    \"chargeDetailsSummary\": \"\",\n                    \"modeOfTrial\": \"EW\"\n                }\n            ]\n        }\n    ],\n    \"victims\": [\n        {\n            \"surname\": \"VictimTest\",\n            \"forename\": \"Automation\",\n            \"isVulnerable\": false,\n            \"isIntimidated\": false,\n            \"isWitness\": true\n        }\n    ],\n    \"complexity\": \"\",\n    \"caseWeight\": \"\",\n    \"monitoringCodes\": [\n        {\n            \"code\": \"ATRY\",\n            \"selected\": true\n        }\n    ],\n    \"prosecutorId\": 0,\n    \"caseWorker\": \"\",\n    \"oicRank\": \"\",\n    \"oicSurname\": \"\",\n    \"oicFirstnames\": \"\",\n    \"oicShoulderNumber\": \"\",\n    \"oicPoliceUnit\": \"\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{caseApiBaseUrl}}/api/v1/cases",
                                                                  "host":  [
                                                                               "{{caseApiBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "cases"
                                                                           ]
                                                              },
                                                      "description":  "Creates case with defendant surname matching Egress workspace name.\nThis links case registration to Egress workflow for end-to-end testing.\n\n**Defendant surname = egressWorkspaceName**"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "Register Case - No Defendants",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const uniqueRef = String(Math.floor(10000 + Math.random() * 90000));",
                                                                                    "pm.environment.set(\"urnUniqueRef\", uniqueRef);",
                                                                                    "console.log(\"Generated URN Ref:\", uniqueRef);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200 OK\", function () {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "var responseBody = pm.response.json();",
                                                                                    "",
                                                                                    "pm.test(\"caseId is greater than 0\", function () {",
                                                                                    "    pm.expect(responseBody.caseId).to.be.above(0);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (responseBody.caseId) {",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);",
                                                                                    "    console.log(\"Case ID:\", responseBody.caseId);",
                                                                                    "    console.log(\"URN:\", responseBody.urn);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"urn\": {\n        \"policeForce\": \"45\",\n        \"policeUnit\": \"EL\",\n        \"uniqueRef\": \"{{urnUniqueRef}}\",\n        \"year\": 25\n    },\n    \"registeringAreaId\": 1001,\n    \"registeringUnitId\": 2002,\n    \"allocatedWcuId\": 2012391,\n    \"crest\": \"\",\n    \"operationName\": \"\",\n    \"courtLocationId\": 0,\n    \"courtLocationName\": \"\",\n    \"hearingDate\": null,\n    \"defendants\": [],\n    \"victims\": [],\n    \"complexity\": \"\",\n    \"caseWeight\": \"\",\n    \"monitoringCodes\": [\n        {\n            \"code\": \"CSEA\",\n            \"selected\": true\n        }\n    ],\n    \"prosecutorId\": 0,\n    \"caseWorker\": \"\",\n    \"oicRank\": \"\",\n    \"oicSurname\": \"\",\n    \"oicFirstnames\": \"\",\n    \"oicShoulderNumber\": \"\",\n    \"oicPoliceUnit\": \"\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{caseApiBaseUrl}}/api/v1/cases",
                                                                  "host":  [
                                                                               "{{caseApiBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "cases"
                                                                           ]
                                                              },
                                                      "description":  "Creates a case without defendants."
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "Case Registration API tests.\n\n## Requests\n\n1. **Register Case - With Defendants** - Creates case with defendant surname = workspace name\n2. **Register Case - No Defendants** - Simple case without defendants\n\n## Integration\n\nThe defendant surname is automatically set from `egressWorkspaceName` variable to link with Egress workflow."
                 },
                 {
                     "name":  "2. Case Management",
                     "item":  [
                                  {
                                      "name":  "2.1 Search Cases",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = pm.variables.replaceIn(\u0027{{$guid}}\u0027);",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Validate auth - need BOTH Azure AD token AND CMS cookies",
                                                                                    "const bearerToken = pm.environment.get(\u0027bearerToken\u0027);",
                                                                                    "const cmsAuthValues = pm.environment.get(\u0027cmsAuthValues\u0027);",
                                                                                    "",
                                                                                    "if (!bearerToken) {",
                                                                                    "    console.warn(\u0027WARNING: No bearerToken - Azure AD authentication required\u0027);",
                                                                                    "}",
                                                                                    "if (!cmsAuthValues) {",
                                                                                    "    console.warn(\u0027WARNING: No cmsAuthValues - run tactical login first\u0027);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is JSON\u0027, function() {",
                                                                                    "    pm.response.to.be.json;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    try {",
                                                                                    "        const response = pm.response.json();",
                                                                                    "        ",
                                                                                    "        // Store first case ID for subsequent requests",
                                                                                    "        if (Array.isArray(response) \u0026\u0026 response.length \u003e 0) {",
                                                                                    "            const firstCase = response[0];",
                                                                                    "            const caseId = firstCase.id || firstCase.caseId || firstCase.case_id || firstCase.CaseId;",
                                                                                    "            if (caseId) {",
                                                                                    "                pm.environment.set(\u0027caseId\u0027, caseId);",
                                                                                    "                console.log(\u0027Stored caseId:\u0027, caseId);",
                                                                                    "            }",
                                                                                    "            ",
                                                                                    "            pm.test(\u0027Search returned results\u0027, function() {",
                                                                                    "                pm.expect(response.length).to.be.greaterThan(0);",
                                                                                    "            });",
                                                                                    "            ",
                                                                                    "            console.log(\u0027Search results count:\u0027, response.length);",
                                                                                    "        } else if (response.results || response.data || response.cases) {",
                                                                                    "            const results = response.results || response.data || response.cases;",
                                                                                    "            if (results \u0026\u0026 results.length \u003e 0) {",
                                                                                    "                const caseId = results[0].id || results[0].caseId || results[0].CaseId;",
                                                                                    "                pm.environment.set(\u0027caseId\u0027, caseId);",
                                                                                    "                console.log(\u0027Stored caseId:\u0027, caseId);",
                                                                                    "            }",
                                                                                    "            console.log(\u0027Search results count:\u0027, results?.length || 0);",
                                                                                    "        } else {",
                                                                                    "            console.log(\u0027Response structure:\u0027, Object.keys(response));",
                                                                                    "        }",
                                                                                    "            ",
                                                                                    "    } catch (e) {",
                                                                                    "        console.error(\u0027Error parsing response:\u0027, e.message);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "description":  "CMS session cookies",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/case-search?defendant-name={{defendantName}}\u0026area={{areaCode}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "case-search"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "defendant-name",
                                                                                    "value":  "{{defendantName}}",
                                                                                    "description":  "Defendant name to search"
                                                                                },
                                                                                {
                                                                                    "key":  "area",
                                                                                    "value":  "{{areaCode}}",
                                                                                    "description":  "Area code (e.g., 1001)"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Search for cases by defendant name and area.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n- `cmsAuthValues` - CMS cookies from tactical login\n\n**Query Parameters:**\n- `defendant-name` - Name to search\n- `area` - Area code\n\n**Outputs:**\n- `caseId` - First result stored for subsequent requests"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "2.2 Get Case Details",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\u0027{{$guid}}\u0027);",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "const caseId = pm.environment.get(\u0027caseId\u0027);",
                                                                                    "if (!caseId) {",
                                                                                    "    console.warn(\u0027WARNING: No caseId - run case search first\u0027);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is JSON\u0027, function() {",
                                                                                    "    pm.response.to.be.json;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    ",
                                                                                    "    pm.test(\u0027Case has required fields\u0027, function() {",
                                                                                    "        pm.expect(response).to.have.property(\u0027id\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    console.log(\u0027Case details retrieved for:\u0027, response.id || response.caseId);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "description":  "CMS session cookies",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/cases/{{caseId}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "cases",
                                                                               "{{caseId}}"
                                                                           ]
                                                              },
                                                      "description":  "Get detailed information for a specific case.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n- `cmsAuthValues` - CMS cookies\n- `caseId` from previous search"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "2.3 List Areas",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\u0027{{$guid}}\u0027);",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is JSON array or object\u0027, function() {",
                                                                                    "    pm.response.to.be.json;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    const areas = Array.isArray(response) ? response : (response.areas || response.data || []);",
                                                                                    "    console.log(\u0027Areas count:\u0027, areas.length);",
                                                                                    "    ",
                                                                                    "    if (areas.length \u003e 0) {",
                                                                                    "        pm.environment.set(\u0027areaId\u0027, areas[0].id || areas[0].areaId);",
                                                                                    "        pm.environment.set(\u0027areaCode\u0027, areas[0].code || areas[0].areaCode || areas[0].id);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "description":  "CMS session cookies",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/areas",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "areas"
                                                                           ]
                                                              },
                                                      "description":  "List all available areas.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n- `cmsAuthValues` - CMS cookies"
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "Case search and management endpoints"
                 },
                 {
                     "name":  "3. Egress Integration",
                     "item":  [
                                  {
                                      "name":  "3.1 List Workspace Files",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\u0027{{$guid}}\u0027);",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "const bearerToken = pm.environment.get(\u0027bearerToken\u0027);",
                                                                                    "const cmsAuthValues = pm.environment.get(\u0027cmsAuthValues\u0027);",
                                                                                    "const egressWorkspaceId = pm.environment.get(\u0027egressWorkspaceId\u0027);",
                                                                                    "",
                                                                                    "if (!bearerToken) {",
                                                                                    "    console.warn(\u0027WARNING: No bearerToken\u0027);",
                                                                                    "}",
                                                                                    "if (!cmsAuthValues) {",
                                                                                    "    console.warn(\u0027WARNING: No cmsAuthValues\u0027);",
                                                                                    "}",
                                                                                    "if (!egressWorkspaceId) {",
                                                                                    "    console.warn(\u0027WARNING: No egressWorkspaceId - set this in environment\u0027);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is JSON\u0027, function() {",
                                                                                    "    pm.response.to.be.json;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    try {",
                                                                                    "        const response = pm.response.json();",
                                                                                    "        const files = response.files || response.items || response.data || response;",
                                                                                    "        ",
                                                                                    "        if (Array.isArray(files)) {",
                                                                                    "            console.log(\u0027Egress files count:\u0027, files.length);",
                                                                                    "            ",
                                                                                    "            if (files.length \u003e 0) {",
                                                                                    "                // Store first file info for potential transfer",
                                                                                    "                const firstFile = files[0];",
                                                                                    "                pm.environment.set(\u0027egressFileId\u0027, firstFile.id || firstFile.fileId);",
                                                                                    "                pm.environment.set(\u0027egressFileName\u0027, firstFile.name || firstFile.fileName);",
                                                                                    "                console.log(\u0027First file:\u0027, firstFile.name || firstFile.fileName);",
                                                                                    "            }",
                                                                                    "        } else {",
                                                                                    "            console.log(\u0027Response structure:\u0027, Object.keys(response));",
                                                                                    "        }",
                                                                                    "    } catch (e) {",
                                                                                    "        console.error(\u0027Error parsing response:\u0027, e.message);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "description":  "CMS session cookies",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/workspaces/{{egressWorkspaceId}}/files?folder-id={{egressFolderId}}\u0026skip={{egressSkip}}\u0026take={{egressTake}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "folder-id",
                                                                                    "value":  "{{egressFolderId}}",
                                                                                    "description":  "Folder ID to list (empty for root)"
                                                                                },
                                                                                {
                                                                                    "key":  "skip",
                                                                                    "value":  "{{egressSkip}}",
                                                                                    "description":  "Number of items to skip (pagination)"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "{{egressTake}}",
                                                                                    "description":  "Number of items to return (default 50)"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "List files in an Egress workspace.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n- `cmsAuthValues` - CMS cookies\n- `egressWorkspaceId` - Egress workspace ID\n\n**Query Parameters:**\n- `folder-id` - Folder to list (empty for root)\n- `skip` - Pagination offset\n- `take` - Page size (default 50)\n\n**Outputs:**\n- `egressFileId` - First file ID\n- `egressFileName` - First file name"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "3.2 Create Egress Connection",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\"{{\\}}\");",
                                                                                    "pm.environment.set(\"correlationId\", correlationId);",
                                                                                    "",
                                                                                    "const bearerToken = pm.environment.get(\"bearerToken\");",
                                                                                    "const caseId = pm.environment.get(\"caseId\");",
                                                                                    "const workspaceId = pm.environment.get(\"egressWorkspaceId\");",
                                                                                    "",
                                                                                    "if (!bearerToken) {",
                                                                                    "    console.warn(\"WARNING: No bearerToken - run 1.1 Get Azure AD Token first\");",
                                                                                    "}",
                                                                                    "if (!caseId) {",
                                                                                    "    console.warn(\"WARNING: No caseId - run Case Registration first\");",
                                                                                    "}",
                                                                                    "if (!workspaceId) {",
                                                                                    "    console.warn(\"WARNING: No egressWorkspaceId - set this in variables\");",
                                                                                    "}",
                                                                                    "",
                                                                                    "console.log(\"Creating Egress connection:\");",
                                                                                    "console.log(\"  Workspace ID:\", workspaceId);",
                                                                                    "console.log(\"  Case ID:\", caseId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200\", function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    console.log(\"=== EGRESS CONNECTION CREATED ===\");",
                                                                                    "    console.log(\"Workspace ID:\", pm.environment.get(\"egressWorkspaceId\"));",
                                                                                    "    console.log(\"Case ID:\", pm.environment.get(\"caseId\"));",
                                                                                    "    console.log(\"\");",
                                                                                    "    console.log(\"Egress workspace now linked to case!\");",
                                                                                    "} else {",
                                                                                    "    console.error(\"Failed to create connection:\", pm.response.text());",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\n    \"caseId\": {{caseId}}\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/connections",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Creates a connection between an Egress workspace and a case in the Case Management System.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n- `egressWorkspaceId` - Egress workspace ID\n- `caseId` - Case ID from Case Registration\n\n**Request Body:**\n- `egressWorkspaceId` - The Egress workspace to link\n- `caseId` - The case to link to"
                                                  },
                                      "response":  [
                                                       {
                                                           "name":  "Success - 200 OK",
                                                           "originalRequest":  {
                                                                                   "method":  "POST",
                                                                                   "header":  [
                                                                                                  {
                                                                                                      "key":  "Authorization",
                                                                                                      "value":  "Bearer {{bearerToken}}"
                                                                                                  },
                                                                                                  {
                                                                                                      "key":  "Content-Type",
                                                                                                      "value":  "application/json"
                                                                                                  }
                                                                                              ],
                                                                                   "body":  {
                                                                                                "mode":  "raw",
                                                                                                "raw":  "{\"egressWorkspaceId\":\"{{egressWorkspaceId}}\",\"caseId\":2178476}"
                                                                                            },
                                                                                   "url":  {
                                                                                               "raw":  "{{baseUrl}}/api/v1/egress/connections",
                                                                                               "host":  [
                                                                                                            "{{baseUrl}}"
                                                                                                        ],
                                                                                               "path":  [
                                                                                                            "api",
                                                                                                            "v1",
                                                                                                            "egress",
                                                                                                            "connections"
                                                                                                        ]
                                                                                           }
                                                                               },
                                                           "status":  "OK",
                                                           "code":  200,
                                                           "_postman_previewlanguage":  "text",
                                                           "header":  [
                                                                          {
                                                                              "key":  "Content-Length",
                                                                              "value":  "0"
                                                                          },
                                                                          {
                                                                              "key":  "Cache-Control",
                                                                              "value":  "no-store, no-cache, must-revalidate, proxy-revalidate"
                                                                          }
                                                                      ],
                                                           "cookie":  [

                                                                      ],
                                                           "body":  ""
                                                       }
                                                   ]
                                  }
                              ],
                     "description":  "Egress Secure Workspace integration endpoints\n\n## Requests\n\n1. **3.1 List Workspace Files** - List files in an Egress workspace\n2. **3.2 Create Egress Connection** - Link an Egress workspace to a case"
                 },
                 {
                     "name":  "4. NetApp Integration",
                     "item":  [
                                  {
                                      "name":  "4.1 List NetApp Files",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\u0027{{$guid}}\u0027);",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "const bearerToken = pm.environment.get(\u0027bearerToken\u0027);",
                                                                                    "const cmsAuthValues = pm.environment.get(\u0027cmsAuthValues\u0027);",
                                                                                    "",
                                                                                    "if (!bearerToken) {",
                                                                                    "    console.warn(\u0027WARNING: No bearerToken\u0027);",
                                                                                    "}",
                                                                                    "if (!cmsAuthValues) {",
                                                                                    "    console.warn(\u0027WARNING: No cmsAuthValues\u0027);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is JSON\u0027, function() {",
                                                                                    "    pm.response.to.be.json;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    try {",
                                                                                    "        const response = pm.response.json();",
                                                                                    "        const files = response.files || response.items || response.data || response;",
                                                                                    "        ",
                                                                                    "        // Store continuation token for pagination",
                                                                                    "        if (response.continuationToken || response[\u0027continuation-token\u0027]) {",
                                                                                    "            pm.environment.set(\u0027netappContinuationToken\u0027, response.continuationToken || response[\u0027continuation-token\u0027]);",
                                                                                    "            console.log(\u0027Continuation token stored\u0027);",
                                                                                    "        }",
                                                                                    "        ",
                                                                                    "        if (Array.isArray(files)) {",
                                                                                    "            console.log(\u0027NetApp files count:\u0027, files.length);",
                                                                                    "            ",
                                                                                    "            if (files.length \u003e 0) {",
                                                                                    "                // Store first file info for potential transfer",
                                                                                    "                const firstFile = files[0];",
                                                                                    "                pm.environment.set(\u0027netappFilePath\u0027, firstFile.path || firstFile.name);",
                                                                                    "                pm.environment.set(\u0027netappFileName\u0027, firstFile.name || firstFile.fileName);",
                                                                                    "                console.log(\u0027First file:\u0027, firstFile.name || firstFile.path);",
                                                                                    "            }",
                                                                                    "        } else {",
                                                                                    "            console.log(\u0027Response structure:\u0027, Object.keys(response));",
                                                                                    "        }",
                                                                                    "    } catch (e) {",
                                                                                    "        console.error(\u0027Error parsing response:\u0027, e.message);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "description":  "CMS session cookies",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/files?path={{netappPath}}\u0026take={{netappTake}}\u0026continuation-token={{netappContinuationToken}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "path",
                                                                                    "value":  "{{netappPath}}",
                                                                                    "description":  "NetApp folder path (e.g., capricorn/)"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "{{netappTake}}",
                                                                                    "description":  "Number of items to return (default 50)"
                                                                                },
                                                                                {
                                                                                    "key":  "continuation-token",
                                                                                    "value":  "{{netappContinuationToken}}",
                                                                                    "description":  "Token for pagination (from previous response)"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "List files from NetApp storage.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n- `cmsAuthValues` - CMS cookies\n\n**Query Parameters:**\n- `path` - NetApp folder path (e.g., capricorn/)\n- `take` - Page size (default 50)\n- `continuation-token` - Pagination token from previous response\n\n**Outputs:**\n- `netappFilePath` - First file path\n- `netappFileName` - First file name\n- `netappContinuationToken` - Token for next page"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "4.2 Get NetApp Folders",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\"{{\\}}\");",
                                                                                    "pm.environment.set(\"correlationId\", correlationId);",
                                                                                    "",
                                                                                    "const bearerToken = pm.environment.get(\"bearerToken\");",
                                                                                    "",
                                                                                    "if (!bearerToken) {",
                                                                                    "    console.warn(\"WARNING: No bearerToken - run 1.1 Get Azure AD Token first\");",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200\", function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\"Response is JSON\", function() {",
                                                                                    "    pm.response.to.be.json;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    try {",
                                                                                    "        const response = pm.response.json();",
                                                                                    "        const folders = response.data?.folders || [];",
                                                                                    "        const files = response.data?.files || [];",
                                                                                    "        ",
                                                                                    "        console.log(\"=== NetApp Folders ===\");",
                                                                                    "        console.log(\"Root path:\", response.data?.rootPath || \"(root)\");",
                                                                                    "        console.log(\"Folders found:\", folders.length);",
                                                                                    "        console.log(\"Files found:\", files.length);",
                                                                                    "        ",
                                                                                    "        if (folders.length \u003e 0) {",
                                                                                    "            console.log(\"\");",
                                                                                    "            console.log(\"Available folders:\");",
                                                                                    "            folders.forEach((f, i) =\u003e {",
                                                                                    "                console.log(\"  \" + (i+1) + \". \" + f.folderPath + (f.caseId ? \" (Case: \" + f.caseId + \")\" : \"\"));",
                                                                                    "            });",
                                                                                    "            ",
                                                                                    "            // Store first folder for connection",
                                                                                    "            pm.environment.set(\"netappFolderPath\", folders[0].folderPath);",
                                                                                    "            console.log(\"\");",
                                                                                    "            console.log(\"Stored netappFolderPath:\", folders[0].folderPath);",
                                                                                    "        }",
                                                                                    "        ",
                                                                                    "        // Store continuation token if present",
                                                                                    "        if (response.pagination?.nextContinuationToken) {",
                                                                                    "            pm.environment.set(\"netappContinuationToken\", response.pagination.nextContinuationToken);",
                                                                                    "        }",
                                                                                    "    } catch (e) {",
                                                                                    "        console.error(\"Error parsing response:\", e.message);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/folders?operation-name={{operationName}}\u0026path=\u0026take=50\u0026continuation-token=",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "folders"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "operation-name",
                                                                                    "value":  "{{operationName}}",
                                                                                    "description":  "The operation name to scope the folder listing"
                                                                                },
                                                                                {
                                                                                    "key":  "path",
                                                                                    "value":  "",
                                                                                    "description":  "Path within the operation folder (empty for root)"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50",
                                                                                    "description":  "Number of items to return"
                                                                                },
                                                                                {
                                                                                    "key":  "continuation-token",
                                                                                    "value":  "",
                                                                                    "description":  "Token for pagination (empty for first page)"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Lists folders and files within a NetApp storage location for a given operation.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n\n**Query Parameters:**\n- `operation-name` - The operation name to scope the folder listing\n- `path` - Path within the operation folder (empty for root)\n- `take` - Number of items to return\n- `continuation-token` - Token for pagination\n\n**Outputs:**\n- `netappFolderPath` - First folder path (for use with Create Connection)"
                                                  },
                                      "response":  [
                                                       {
                                                           "name":  "Success - Folder List",
                                                           "originalRequest":  {
                                                                                   "method":  "GET",
                                                                                   "header":  [
                                                                                                  {
                                                                                                      "key":  "Authorization",
                                                                                                      "value":  "Bearer {{bearerToken}}"
                                                                                                  }
                                                                                              ],
                                                                                   "url":  {
                                                                                               "raw":  "{{baseUrl}}/api/v1/netapp/folders?operation-name=AUTOMATION-TESTING9\u0026path=\u0026take=50\u0026continuation-token=",
                                                                                               "host":  [
                                                                                                            "{{baseUrl}}"
                                                                                                        ],
                                                                                               "path":  [
                                                                                                            "api",
                                                                                                            "v1",
                                                                                                            "netapp",
                                                                                                            "folders"
                                                                                                        ],
                                                                                               "query":  [
                                                                                                             {
                                                                                                                 "key":  "operation-name",
                                                                                                                 "value":  "AUTOMATION-TESTING9"
                                                                                                             },
                                                                                                             {
                                                                                                                 "key":  "path",
                                                                                                                 "value":  ""
                                                                                                             },
                                                                                                             {
                                                                                                                 "key":  "take",
                                                                                                                 "value":  "50"
                                                                                                             },
                                                                                                             {
                                                                                                                 "key":  "continuation-token",
                                                                                                                 "value":  ""
                                                                                                             }
                                                                                                         ]
                                                                                           }
                                                                               },
                                                           "status":  "OK",
                                                           "code":  200,
                                                           "_postman_previewlanguage":  "json",
                                                           "header":  [
                                                                          {
                                                                              "key":  "Content-Type",
                                                                              "value":  "application/json; charset=utf-8"
                                                                          }
                                                                      ],
                                                           "cookie":  [

                                                                      ],
                                                           "body":  "{\"data\":{\"rootPath\":\"\",\"folders\":[{\"folderPath\":\"{{netappFolderPath}}\",\"caseId\":null},{\"folderPath\":\"Delta/\",\"caseId\":null},{\"folderPath\":\"Gamma/\",\"caseId\":null}],\"files\":[]},\"pagination\":{\"nextContinuationToken\":null,\"maxKeys\":1000}}"
                                                       }
                                                   ]
                                  },
                                  {
                                      "name":  "4.3 Create NetApp Connection",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\"{{\\}}\");",
                                                                                    "pm.environment.set(\"correlationId\", correlationId);",
                                                                                    "",
                                                                                    "const bearerToken = pm.environment.get(\"bearerToken\");",
                                                                                    "const caseId = pm.environment.get(\"caseId\");",
                                                                                    "const operationName = pm.environment.get(\"operationName\");",
                                                                                    "const folderPath = pm.environment.get(\"netappFolderPath\");",
                                                                                    "",
                                                                                    "if (!bearerToken) {",
                                                                                    "    console.warn(\"WARNING: No bearerToken - run 1.1 Get Azure AD Token first\");",
                                                                                    "}",
                                                                                    "if (!caseId) {",
                                                                                    "    console.warn(\"WARNING: No caseId - run Case Registration first\");",
                                                                                    "}",
                                                                                    "if (!operationName) {",
                                                                                    "    console.warn(\"WARNING: No operationName - set this in variables\");",
                                                                                    "}",
                                                                                    "if (!folderPath) {",
                                                                                    "    console.warn(\"WARNING: No netappFolderPath - run 4.2 Get NetApp Folders first\");",
                                                                                    "}",
                                                                                    "",
                                                                                    "console.log(\"Creating NetApp connection:\");",
                                                                                    "console.log(\"  Operation:\", operationName);",
                                                                                    "console.log(\"  Folder:\", folderPath);",
                                                                                    "console.log(\"  Case ID:\", caseId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200\", function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    console.log(\"=== NETAPP CONNECTION CREATED ===\");",
                                                                                    "    console.log(\"Operation:\", pm.environment.get(\"operationName\"));",
                                                                                    "    console.log(\"Folder:\", pm.environment.get(\"netappFolderPath\"));",
                                                                                    "    console.log(\"Case ID:\", pm.environment.get(\"caseId\"));",
                                                                                    "    console.log(\"\");",
                                                                                    "    console.log(\"NetApp folder now linked to case!\");",
                                                                                    "} else {",
                                                                                    "    console.error(\"Failed to create connection:\", pm.response.text());",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{bearerToken}}",
                                                                         "description":  "Azure AD JWT token",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"operationName\": \"{{operationName}}\",\n    \"folderPath\": \"{{netappFolderPath}}\",\n    \"caseId\": {{caseId}}\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/connections",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Creates a connection between a NetApp folder and a case in the Case Management System.\n\n**Prerequisites:**\n- `bearerToken` - Azure AD JWT token\n- `operationName` - Operation name (e.g., AUTOMATION-TESTING9)\n- `netappFolderPath` - Folder path from 4.2 Get NetApp Folders\n- `caseId` - Case ID from Case Registration\n\n**Request Body:**\n- `operationName` - The operation name\n- `folderPath` - The NetApp folder path to link\n- `caseId` - The case to link to"
                                                  },
                                      "response":  [
                                                       {
                                                           "name":  "Success - 200 OK",
                                                           "originalRequest":  {
                                                                                   "method":  "POST",
                                                                                   "header":  [
                                                                                                  {
                                                                                                      "key":  "Authorization",
                                                                                                      "value":  "Bearer {{bearerToken}}"
                                                                                                  },
                                                                                                  {
                                                                                                      "key":  "Content-Type",
                                                                                                      "value":  "application/json"
                                                                                                  }
                                                                                              ],
                                                                                   "body":  {
                                                                                                "mode":  "raw",
                                                                                                "raw":  "{\"operationName\":\"AUTOMATION-TESTING9\",\"folderPath\":\"{{netappFolderPath}}\",\"caseId\":2178476}"
                                                                                            },
                                                                                   "url":  {
                                                                                               "raw":  "{{baseUrl}}/api/v1/netapp/connections",
                                                                                               "host":  [
                                                                                                            "{{baseUrl}}"
                                                                                                        ],
                                                                                               "path":  [
                                                                                                            "api",
                                                                                                            "v1",
                                                                                                            "netapp",
                                                                                                            "connections"
                                                                                                        ]
                                                                                           }
                                                                               },
                                                           "status":  "OK",
                                                           "code":  200,
                                                           "_postman_previewlanguage":  "text",
                                                           "header":  [
                                                                          {
                                                                              "key":  "Content-Length",
                                                                              "value":  "0"
                                                                          },
                                                                          {
                                                                              "key":  "Cache-Control",
                                                                              "value":  "no-store, no-cache, must-revalidate, proxy-revalidate"
                                                                          }
                                                                      ],
                                                           "cookie":  [

                                                                      ],
                                                           "body":  ""
                                                       }
                                                   ]
                                  }
                              ],
                     "description":  "NetApp storage integration endpoints\n\n## Requests\n\n1. **4.1 List NetApp Files** - List files from NetApp storage\n2. **4.2 Get NetApp Folders** - List folders in NetApp storage by operation\n3. **4.3 Create NetApp Connection** - Link a NetApp folder to a case"
                 },
                 {
                     "name":  "5. File Transfer",
                     "item":  [
                                  {
                                      "name":  "5.0 Register Case (for Transfer)",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate unique ref",
                                                                                    "const uniqueRef = String(Math.floor(10000 + Math.random() * 90000));",
                                                                                    "pm.environment.set(\"urnUniqueRef\", uniqueRef);",
                                                                                    "",
                                                                                    "// Get workspace name for defendant",
                                                                                    "const workspaceName = pm.environment.get(\"egressWorkspaceName\") || \"Automation-Testing\";",
                                                                                    "pm.environment.set(\"defendantSurname\", workspaceName);",
                                                                                    "",
                                                                                    "console.log(\"=== REGISTER CASE FOR TRANSFER ===\");",
                                                                                    "console.log(\"URN Ref:\", uniqueRef);",
                                                                                    "console.log(\"Defendant/Workspace:\", workspaceName);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200 OK\", function () {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "var responseBody = pm.response.json();",
                                                                                    "",
                                                                                    "pm.test(\"caseId is valid\", function () {",
                                                                                    "    pm.expect(responseBody.caseId).to.be.above(0);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (responseBody.caseId) {",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);",
                                                                                    "    pm.environment.set(\"lastCreatedUrn\", responseBody.urn);",
                                                                                    "    ",
                                                                                    "    console.log(\"=== CASE REGISTERED ===\");",
                                                                                    "    console.log(\"Case ID:\", responseBody.caseId);",
                                                                                    "    console.log(\"URN:\", responseBody.urn);",
                                                                                    "    console.log(\"Workspace:\", pm.environment.get(\"egressWorkspaceName\"));",
                                                                                    "    console.log(\"\");",
                                                                                    "    console.log(\"Ready for file transfer!\");",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"urn\": {\n        \"policeForce\": \"45\",\n        \"policeUnit\": \"EL\",\n        \"uniqueRef\": \"{{urnUniqueRef}}\",\n        \"year\": 25\n    },\n    \"registeringAreaId\": 1001,\n    \"registeringUnitId\": 2002,\n    \"allocatedWcuId\": 2012391,\n    \"crest\": \"\",\n    \"operationName\": \"{{egressWorkspaceName}}\",\n    \"courtLocationId\": 0,\n    \"courtLocationName\": \"\",\n    \"hearingDate\": null,\n    \"defendants\": [\n        {\n            \"isDefendant\": true,\n            \"surname\": \"{{defendantSurname}}\",\n            \"firstname\": \"AutoTest\",\n            \"companyName\": \"\",\n            \"dateOfBirth\": \"1985-06-15\",\n            \"gender\": \"M\",\n            \"disability\": \"U\",\n            \"ethnicity\": \"W1\",\n            \"religion\": \"NP\",\n            \"type\": \"UN\",\n            \"arrestDate\": null,\n            \"seriousDangerousOffender\": false,\n            \"arrestSummonsNumber\": \"\",\n            \"isNotYetCharged\": false,\n            \"aliases\": [],\n            \"charges\": [\n                {\n                    \"offenceCode\": \"FI68036\",\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\n                    \"offenceId\": \"22336\",\n                    \"dateFrom\": \"2025-10-01\",\n                    \"dateTo\": null,\n                    \"comment\": \"E2E Transfer Test\",\n                    \"offenceLocation\": {\n                        \"addressLine1\": \"Test Address\",\n                        \"addressLine2\": \"\",\n                        \"townCity\": \"London\",\n                        \"postcode\": \"SW1A 1AA\"\n                    },\n                    \"victimIndexId\": 0,\n                    \"chargeDetailsSummary\": \"\",\n                    \"modeOfTrial\": \"EW\"\n                }\n            ]\n        }\n    ],\n    \"victims\": [\n        {\n            \"surname\": \"TestVictim\",\n            \"forename\": \"Transfer\",\n            \"isVulnerable\": false,\n            \"isIntimidated\": false,\n            \"isWitness\": true\n        }\n    ],\n    \"complexity\": \"\",\n    \"caseWeight\": \"\",\n    \"monitoringCodes\": [\n        {\n            \"code\": \"ATRY\",\n            \"selected\": true\n        }\n    ],\n    \"prosecutorId\": 0,\n    \"caseWorker\": \"\",\n    \"oicRank\": \"\",\n    \"oicSurname\": \"\",\n    \"oicFirstnames\": \"\",\n    \"oicShoulderNumber\": \"\",\n    \"oicPoliceUnit\": \"\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{caseApiBaseUrl}}/api/v1/cases",
                                                                  "host":  [
                                                                               "{{caseApiBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "cases"
                                                                           ]
                                                              },
                                                      "description":  "Register a new case before initiating file transfer.\n\n**Run this FIRST** in the File Transfer workflow to create a case.\n\nThe defendant surname matches the Egress workspace name for traceability."
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5.1 Create Egress Connection",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\"{{\\}}\");",
                                                                                    "pm.environment.set(\"correlationId\", correlationId);",
                                                                                    "",
                                                                                    "const caseId = pm.environment.get(\"caseId\");",
                                                                                    "const workspaceId = pm.environment.get(\"egressWorkspaceId\");",
                                                                                    "",
                                                                                    "console.log(\"=== CREATE EGRESS CONNECTION ===\");",
                                                                                    "console.log(\"Workspace ID:\", workspaceId);",
                                                                                    "console.log(\"Case ID:\", caseId);",
                                                                                    "",
                                                                                    "if (!caseId) {",
                                                                                    "    console.error(\"ERROR: No caseId - run 5.0 Register Case first!\");",
                                                                                    "}",
                                                                                    "if (!workspaceId) {",
                                                                                    "    console.error(\"ERROR: No egressWorkspaceId - set in variables!\");",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200\", function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    console.log(\"=== EGRESS CONNECTION CREATED ===\");",
                                                                                    "    console.log(\"Workspace:\", pm.environment.get(\"egressWorkspaceId\"));",
                                                                                    "    console.log(\"Case ID:\", pm.environment.get(\"caseId\"));",
                                                                                    "    console.log(\"\");",
                                                                                    "    console.log(\"Next: Run 5.2 Get NetApp Folders\");",
                                                                                    "} else {",
                                                                                    "    console.error(\"Failed:\", pm.response.text());",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\n    \"caseId\": {{caseId}}\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/connections",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Links the Egress workspace to the case.\n\n**Run after 5.0 Register Case**\n\nThis creates the connection between Egress workspace and CMS case."
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5.2 Get NetApp Folders",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\"{{\\}}\");",
                                                                                    "pm.environment.set(\"correlationId\", correlationId);",
                                                                                    "",
                                                                                    "console.log(\"=== GET NETAPP FOLDERS ===\");",
                                                                                    "console.log(\"Operation:\", pm.environment.get(\"operationName\"));"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200\", function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    const folders = response.data?.folders || [];",
                                                                                    "    ",
                                                                                    "    console.log(\"=== NETAPP FOLDERS ===\");",
                                                                                    "    console.log(\"Found:\", folders.length, \"folders\");",
                                                                                    "    ",
                                                                                    "    if (folders.length \u003e 0) {",
                                                                                    "        folders.forEach((f, i) =\u003e {",
                                                                                    "            const linked = f.caseId ? \" (Case: \" + f.caseId + \")\" : \" (Available)\";",
                                                                                    "            console.log(\"  \" + (i+1) + \". \" + f.folderPath + linked);",
                                                                                    "        });",
                                                                                    "        ",
                                                                                    "        // Find first unlinked folder or use first folder",
                                                                                    "        const availableFolder = folders.find(f =\u003e !f.caseId) || folders[0];",
                                                                                    "        pm.environment.set(\"netappFolderPath\", availableFolder.folderPath);",
                                                                                    "        console.log(\"\");",
                                                                                    "        console.log(\"Selected folder:\", availableFolder.folderPath);",
                                                                                    "        console.log(\"Next: Run 5.3 Create NetApp Connection\");",
                                                                                    "    } else {",
                                                                                    "        console.warn(\"No folders found!\");",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/folders?operation-name={{operationName}}\u0026path=\u0026take=50\u0026continuation-token=",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "folders"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "operation-name",
                                                                                    "value":  "{{operationName}}",
                                                                                    "description":  "Operation name"
                                                                                },
                                                                                {
                                                                                    "key":  "path",
                                                                                    "value":  "",
                                                                                    "description":  "Path (empty for root)"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50",
                                                                                    "description":  "Items to return"
                                                                                },
                                                                                {
                                                                                    "key":  "continuation-token",
                                                                                    "value":  "",
                                                                                    "description":  "Pagination token"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Lists available NetApp folders for the operation.\n\n**Run after 5.1 Create Egress Connection**\n\nStores first available folder in `netappFolderPath` for connection."
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5.3 Create NetApp Connection",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\"{{\\}}\");",
                                                                                    "pm.environment.set(\"correlationId\", correlationId);",
                                                                                    "",
                                                                                    "const caseId = pm.environment.get(\"caseId\");",
                                                                                    "const operationName = pm.environment.get(\"operationName\");",
                                                                                    "const folderPath = pm.environment.get(\"netappFolderPath\");",
                                                                                    "",
                                                                                    "console.log(\"=== CREATE NETAPP CONNECTION ===\");",
                                                                                    "console.log(\"Operation:\", operationName);",
                                                                                    "console.log(\"Folder:\", folderPath);",
                                                                                    "console.log(\"Case ID:\", caseId);",
                                                                                    "",
                                                                                    "if (!caseId) console.error(\"ERROR: No caseId!\");",
                                                                                    "if (!operationName) console.error(\"ERROR: No operationName!\");",
                                                                                    "if (!folderPath) console.error(\"ERROR: No netappFolderPath - run 5.2 first!\");"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200\", function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    console.log(\"=== NETAPP CONNECTION CREATED ===\");",
                                                                                    "    console.log(\"Operation:\", pm.environment.get(\"operationName\"));",
                                                                                    "    console.log(\"Folder:\", pm.environment.get(\"netappFolderPath\"));",
                                                                                    "    console.log(\"Case ID:\", pm.environment.get(\"caseId\"));",
                                                                                    "    console.log(\"\");",
                                                                                    "    console.log(\"=== CONNECTIONS COMPLETE ===\");",
                                                                                    "    console.log(\"Both Egress and NetApp are now linked to the case!\");",
                                                                                    "    console.log(\"Next: Run 5.4 List Egress Files\");",
                                                                                    "} else {",
                                                                                    "    console.error(\"Failed:\", pm.response.text());",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"operationName\": \"{{operationName}}\",\n    \"folderPath\": \"{{netappFolderPath}}\",\n    \"caseId\": {{caseId}}\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/connections",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Links the NetApp folder to the case.\n\n**Run after 5.2 Get NetApp Folders**\n\nCompletes the storage connections for the E2E flow."
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5.4 List Egress Files",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    const files = response.data || [];",
                                                                                    "    ",
                                                                                    "    console.log(\u0027=== Egress Files ===\u0027);",
                                                                                    "    console.log(\u0027Total:\u0027, response.pagination?.totalResults || files.length);",
                                                                                    "    ",
                                                                                    "    if (files.length \u003e 0) {",
                                                                                    "        const firstFile = files[0];",
                                                                                    "        pm.environment.set(\u0027egressFileId\u0027, firstFile.id);",
                                                                                    "        pm.environment.set(\u0027egressFileName\u0027, firstFile.name);",
                                                                                    "        pm.environment.set(\u0027egressFilePath\u0027, firstFile.path + \u0027/\u0027 + firstFile.name);",
                                                                                    "        ",
                                                                                    "        console.log(\u0027First file stored:\u0027);",
                                                                                    "        console.log(\u0027  ID:\u0027, firstFile.id);",
                                                                                    "        console.log(\u0027  Name:\u0027, firstFile.name);",
                                                                                    "        console.log(\u0027  Size:\u0027, firstFile.filesize);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/workspaces/{{egressWorkspaceId}}/files?folder-id={{egressFolderId}}\u0026skip=0\u0026take=50",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "folder-id",
                                                                                    "value":  "{{egressFolderId}}"
                                                                                },
                                                                                {
                                                                                    "key":  "skip",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "List files in Egress workspace folder.\n\n**Outputs:**\n- `egressFileId` - First file ID\n- `egressFileName` - First file name\n- `egressFilePath` - Full path"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5.5 Validate Transfer",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    ",
                                                                                    "    console.log(\u0027=== Transfer Validation ===\u0027);",
                                                                                    "    console.log(\u0027Valid:\u0027, !response.isInvalid);",
                                                                                    "    console.log(\u0027Files:\u0027, response.files?.length || 0);",
                                                                                    "    ",
                                                                                    "    if (response.validationErrors?.length \u003e 0) {",
                                                                                    "        console.error(\u0027Errors:\u0027, response.validationErrors);",
                                                                                    "    }",
                                                                                    "    ",
                                                                                    "    pm.test(\u0027Transfer is valid\u0027, function() {",
                                                                                    "        pm.expect(response.isInvalid).to.be.false;",
                                                                                    "    });",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"transferDirection\": \"EgressToNetApp\",\n    \"transferType\": \"Copy\",\n    \"sourcePaths\": [\n        {\n            \"fileId\": \"{{egressFileId}}\",\n            \"path\": \"{{egressUploadFolderPath}}{{egressFileName}}\",\n            \"isFolder\": false\n        }\n    ],\n    \"destinationPath\": \"{{netappPath}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"sourceRootFolderPath\": \"{{egressUploadFolderPath}}\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/files",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "files"
                                                                           ]
                                                              },
                                                      "description":  "Validate file transfer before initiating.\n\n**Required:**\n- `caseId` - Target case\n- `egressFileId` - File to transfer\n- `egressFileName` - File name\n- `netappPath` - Destination (e.g., capricorn/)"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5.6 Initiate Transfer",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    ",
                                                                                    "    if (response.id) {",
                                                                                    "        pm.environment.set(\u0027transferId\u0027, response.id);",
                                                                                    "        ",
                                                                                    "        console.log(\u0027=== Transfer Initiated ===\u0027);",
                                                                                    "        console.log(\u0027Transfer ID:\u0027, response.id);",
                                                                                    "        console.log(\u0027Status:\u0027, response.status);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"sourcePaths\": [\n        {\n            \"fileId\": \"{{egressFileId}}\",\n            \"path\": \"{{egressFileName}}\",\n            \"relativePath\": null,\n            \"fullFilePath\": \"{{egressUploadFolderPath}}{{egressFileName}}\"\n        }\n    ],\n    \"destinationPath\": \"{{netappPath}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"transferType\": \"Copy\",\n    \"transferDirection\": \"EgressToNetApp\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/initiate",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "initiate"
                                                                           ]
                                                              },
                                                      "description":  "Initiate file transfer from Egress to NetApp.\n\n**Outputs:**\n- `transferId` - Transfer ID for status polling"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5.7 Get Transfer Status",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    ",
                                                                                    "    console.log(\u0027=== Transfer Status ===\u0027);",
                                                                                    "    console.log(\u0027ID:\u0027, response.id);",
                                                                                    "    console.log(\u0027Status:\u0027, response.status);",
                                                                                    "    console.log(\u0027Direction:\u0027, response.direction);",
                                                                                    "    console.log(\u0027Total Files:\u0027, response.totalFiles);",
                                                                                    "    console.log(\u0027Processed:\u0027, response.processedFiles);",
                                                                                    "    console.log(\u0027Successful:\u0027, response.successfulFiles);",
                                                                                    "    console.log(\u0027Failed:\u0027, response.failedFiles);",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027transferStatus\u0027, response.status);",
                                                                                    "    ",
                                                                                    "    if (response.status === \u0027Completed\u0027) {",
                                                                                    "        console.log(\u0027=== TRANSFER COMPLETE ===\u0027);",
                                                                                    "        pm.test(\u0027Transfer completed\u0027, function() {",
                                                                                    "            pm.expect(response.failedFiles).to.equal(0);",
                                                                                    "        });",
                                                                                    "    } else if (response.status === \u0027Failed\u0027) {",
                                                                                    "        console.error(\u0027Transfer failed:\u0027, response.failedItems);",
                                                                                    "    }",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/{{transferId}}/status",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "{{transferId}}",
                                                                               "status"
                                                                           ]
                                                              },
                                                      "description":  "Get transfer status. Poll until status is Completed or Failed."
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "File transfer between Egress and NetApp with full connection setup.\n\n## E2E Flow\n\n1. **5.0 Register Case** - Create case with defendant = workspace name\n2. **5.1 Create Egress Connection** - Link Egress workspace to case\n3. **5.2 Get NetApp Folders** - List available NetApp folders\n4. **5.3 Create NetApp Connection** - Link NetApp folder to case\n5. **5.4 List Egress Files** - Get files from Egress workspace\n6. **5.5 Validate Transfer** - Validate before transfer\n7. **5.6 Initiate Transfer** - Start the file transfer\n8. **5.7 Get Transfer Status** - Poll until complete\n\n## Required Variables\n\n| Variable | Description |\n|----------|-------------|\n|  | Egress workspace ID |\n|  | Workspace name (sets defendant) |\n|  | NetApp operation name |\n|  | Auto-set from 5.2 |"
                 },
                 {
                     "name":  "6. Activity Logs",
                     "item":  [
                                  {
                                      "name":  "6.1 Get Activity Logs",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate dynamic correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has correct structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027data\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027pagination\u0027);",
                                                                                    "    pm.expect(response.data).to.be.an(\u0027array\u0027);",
                                                                                    "    pm.expect(response.pagination).to.have.property(\u0027count\u0027);",
                                                                                    "    pm.expect(response.pagination).to.have.property(\u0027totalResults\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const logs = response.data || [];",
                                                                                    "",
                                                                                    "console.log(\u0027=== Activity Logs ===\u0027);",
                                                                                    "console.log(\u0027Total:\u0027, response.pagination?.totalResults);",
                                                                                    "console.log(\u0027Returned:\u0027, logs.length);",
                                                                                    "",
                                                                                    "if (logs.length \u003e 0) {",
                                                                                    "    // Validate log structure",
                                                                                    "    pm.test(\u0027Activity log has required fields\u0027, function() {",
                                                                                    "        const log = logs[0];",
                                                                                    "        pm.expect(log).to.have.property(\u0027id\u0027);",
                                                                                    "        pm.expect(log).to.have.property(\u0027caseId\u0027);",
                                                                                    "        pm.expect(log).to.have.property(\u0027actionType\u0027);",
                                                                                    "        pm.expect(log).to.have.property(\u0027userName\u0027);",
                                                                                    "        pm.expect(log).to.have.property(\u0027resourceType\u0027);",
                                                                                    "        pm.expect(log).to.have.property(\u0027timestamp\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    // Get latest activity",
                                                                                    "    const latestLog = logs[0];",
                                                                                    "    pm.environment.set(\u0027latestActivityId\u0027, latestLog.id);",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Latest activity:\u0027);",
                                                                                    "    console.log(\u0027    ID:\u0027, latestLog.id);",
                                                                                    "    console.log(\u0027    Type:\u0027, latestLog.actionType);",
                                                                                    "    console.log(\u0027    User:\u0027, latestLog.userName);",
                                                                                    "    console.log(\u0027    Time:\u0027, latestLog.timestamp);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/logs?caseId={{caseId}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "logs"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "caseId",
                                                                                    "value":  "{{caseId}}"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Get activity logs for a case.\n\n**Outputs:**\n- `latestActivityId` - ID of most recent activity"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "6.2 Download Activity Log",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is downloadable content\u0027, function() {",
                                                                                    "    const contentType = pm.response.headers.get(\u0027Content-Type\u0027);",
                                                                                    "    pm.expect(contentType).to.satisfy(function(ct) {",
                                                                                    "        return ct.includes(\u0027text/csv\u0027) || ct.includes(\u0027application/octet-stream\u0027) || ct.includes(\u0027application/json\u0027);",
                                                                                    "    });",
                                                                                    "});",
                                                                                    "",
                                                                                    "console.log(\u0027=== Activity Log Download ===\u0027);",
                                                                                    "console.log(\u0027[OK] Download successful\u0027);",
                                                                                    "console.log(\u0027Content-Type:\u0027, pm.response.headers.get(\u0027Content-Type\u0027));",
                                                                                    "console.log(\u0027Size:\u0027, pm.response.text().length, \u0027bytes\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/{{latestActivityId}}/logs/download",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "{{latestActivityId}}",
                                                                               "logs",
                                                                               "download"
                                                                           ]
                                                              },
                                                      "description":  "Download activity log details.\n\n**Requires:**\n- `latestActivityId` - from 6.1"
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "Activity log operations.\n\n## Endpoints\n- GET /activity/logs - List activity logs\n- GET /activity/{id}/logs/download - Download log details"
                 },
                 {
                     "name":  "6. System",
                     "item":  [
                                  {
                                      "name":  "6.1 Health Check",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027System is healthy\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    // Adjust based on actual response structure",
                                                                                    "    const isHealthy = response.status === \u0027healthy\u0027 || ",
                                                                                    "                      response.status === \u0027ok\u0027 || ",
                                                                                    "                      response.healthy === true;",
                                                                                    "    pm.expect(isHealthy).to.be.true;",
                                                                                    "});",
                                                                                    "",
                                                                                    "console.log(\u0027Health check response:\u0027, pm.response.text());"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json",
                                                                         "type":  "text"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}",
                                                                         "type":  "text"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/status",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "status"
                                                                           ]
                                                              },
                                                      "description":  "Check system health status. Does not require authentication."
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "System status and health endpoints"
                 },
                 {
                     "name":  "7. Egress Upload (PowerShell)",
                     "item":  [
                                  {
                                      "name":  "7.1 Set Egress Upload Info",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Set these values from PowerShell script output",
                                                                                    "// Run: .\\Upload-EgressLargeFile.ps1 -SizeGB 1",
                                                                                    "",
                                                                                    "const fileName = pm.environment.get(\u0027egressUploadFileName\u0027);",
                                                                                    "const workspaceId = pm.environment.get(\u0027egressWorkspaceId\u0027);",
                                                                                    "const folderPath = pm.environment.get(\u0027egressUploadFolderPath\u0027);",
                                                                                    "",
                                                                                    "console.log(\u0027=== Egress Upload Info ===\u0027);",
                                                                                    "console.log(\u0027FileName:\u0027, fileName || \u0027NOT SET\u0027);",
                                                                                    "console.log(\u0027WorkspaceId:\u0027, workspaceId || \u0027NOT SET\u0027);",
                                                                                    "console.log(\u0027FolderPath:\u0027, folderPath || \u0027NOT SET\u0027);",
                                                                                    "",
                                                                                    "if (!fileName) {",
                                                                                    "    console.warn(\u0027Run PowerShell script first, then set egressUploadFileName\u0027);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const fileName = pm.environment.get(\u0027egressUploadFileName\u0027);",
                                                                                    "const workspaceId = pm.environment.get(\u0027egressWorkspaceId\u0027);",
                                                                                    "",
                                                                                    "pm.test(\u0027Egress file info is set\u0027, function() {",
                                                                                    "    pm.expect(fileName).to.be.a(\u0027string\u0027).and.not.empty;",
                                                                                    "    pm.expect(workspaceId).to.be.a(\u0027string\u0027).and.not.empty;",
                                                                                    "});",
                                                                                    "",
                                                                                    "console.log(\u0027Ready to use in subsequent requests!\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "application/json"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{egressBaseUrl}}/api/v1/workspaces/{{egressWorkspaceId}}/files?folder_path={{egressUploadFolderPath}}",
                                                                  "host":  [
                                                                               "{{egressBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "folder_path",
                                                                                    "value":  "{{egressUploadFolderPath}}"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Verify Egress upload info is set.\n\n## How to Use\n\n1. Run PowerShell script:\n   ```\n   .\\Upload-EgressLargeFile.ps1 -SizeGB 1\n   ```\n\n2. Copy output to Postman environment:\n   - `egressUploadFileName`\n   - `egressWorkspaceId`\n   - `egressUploadFolderPath`\n\n3. Run this request to verify"
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "Egress upload is done via PowerShell script.\n\n## Run Upload\n```powershell\nSet-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process\n.\\Upload-EgressLargeFile.ps1 -SizeGB 1\n```\n\n## Variables Set by Script\n- `egressUploadFileName` - Uploaded filename\n- `egressWorkspaceId` - (from collection variables)\n- `egressUploadFolderPath` - Automation API/"
                 },
                 {
                     "name":  "E2E: Egress to NetApp Copy",
                     "item":  [
                                  {
                                      "name":  "1. Get Azure AD Token",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has token structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027access_token\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027token_type\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027expires_in\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.access_token) {",
                                                                                    "    pm.environment.set(\u0027accessToken\u0027, response.access_token);",
                                                                                    "    console.log(\u0027[OK] Azure AD Token obtained\u0027);",
                                                                                    "    console.log(\u0027    Expires in:\u0027, response.expires_in, \u0027seconds\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u00272. Get CMS Auth\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to get token\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "client_id",
                                                                                          "value":  "{{apiClientId}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "scope",
                                                                                          "value":  "api://{{apiClientId}}/user_impersonation"
                                                                                      },
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{azureUsername}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{azurePassword}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "grant_type",
                                                                                          "value":  "password"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "https://login.microsoftonline.com/{{tenantId}}/oauth2/v2.0/token",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "login",
                                                                               "microsoftonline",
                                                                               "com"
                                                                           ],
                                                                  "path":  [
                                                                               "{{tenantId}}",
                                                                               "oauth2",
                                                                               "v2.0",
                                                                               "token"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "2. Get CMS Auth",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has CMS auth structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027Cookies\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027Token\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.Cookies) {",
                                                                                    "    const encoded = encodeURIComponent(JSON.stringify(response));",
                                                                                    "    pm.environment.set(\u0027cmsAuth\u0027, encoded);",
                                                                                    "    console.log(\u0027[OK] CMS Auth obtained\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u0027Register Case\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to get CMS auth\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     },
                                                                     {
                                                                         "key":  "x-functions-key",
                                                                         "value":  "{{ddeiAccessKey}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{cmsUsername}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{cmsPassword}}"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{ddeiBaseUrl}}/authenticate",
                                                                  "host":  [
                                                                               "{{ddeiBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "authenticate"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "Register Case",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {\r",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);\r",
                                                                                    "    return v.toString(16);\r",
                                                                                    "});\r",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200 OK\", function () {\r",
                                                                                    "    pm.response.to.have.status(200);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "var responseBody = pm.response.json();\r",
                                                                                    "\r",
                                                                                    "pm.test(\"caseId is greater than 0\", function () {\r",
                                                                                    "    pm.expect(responseBody.caseId).to.be.above(0);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "pm.test(\"caseId is an integer\", function () {\r",
                                                                                    "    pm.expect(Number.isInteger(responseBody.caseId)).to.be.true;\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "pm.test(\"URN format valid\", function () {\r",
                                                                                    "    const urnPattern = /^\\d{2}[A-Z0-9]{2}\\d{7}$/;\r",
                                                                                    "    pm.expect(responseBody.urn).to.match(urnPattern);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "// Store for subsequent requests\r",
                                                                                    "if (responseBody.caseId) {\r",
                                                                                    "    // Store caseId\r",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);\r",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);\r",
                                                                                    "    \r",
                                                                                    "    // Store full URN for case search\r",
                                                                                    "    pm.environment.set(\"caseUrn\", responseBody.urn);\r",
                                                                                    "    pm.environment.set(\"caseUrn\", responseBody.urn);\r",
                                                                                    "    \r",
                                                                                    "    // Store defendant surname for search\r",
                                                                                    "    const defendantSurname = pm.environment.get(\"defendantSurname\") || \"Miller\";\r",
                                                                                    "    pm.environment.set(\"searchDefendantName\", defendantSurname);\r",
                                                                                    "    pm.environment.set(\"searchDefendantName\", defendantSurname);\r",
                                                                                    "    \r",
                                                                                    "    console.log(\"=== CASE CREATED ===\");\r",
                                                                                    "    console.log(\"Case ID:\", responseBody.caseId);\r",
                                                                                    "    console.log(\"URN:\", responseBody.urn);\r",
                                                                                    "    console.log(\"Defendant:\", defendantSurname);\r",
                                                                                    "    console.log(\"\");\r",
                                                                                    "    console.log(\"Variables set for next calls:\");\r",
                                                                                    "    console.log(\"  caseId =\", responseBody.caseId);\r",
                                                                                    "    console.log(\"  caseUrn =\", responseBody.urn);\r",
                                                                                    "    console.log(\"  searchDefendantName =\", defendantSurname);\r",
                                                                                    "}\r",
                                                                                    "pm.execution.setNextRequest(\u00273. Search Case\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"urn\": {\r\n        \"policeForce\": \"45\",\r\n        \"policeUnit\": \"EL\",\r\n        \"uniqueRef\": \"{{urnUniqueRef}}\",\r\n        \"year\": 25\r\n    },\r\n    \"registeringAreaId\": 1001,\r\n    \"registeringUnitId\": 2002,\r\n    \"allocatedWcuId\": 2012391,\r\n    \"crest\": \"\",\r\n    \"operationName\": \"\",\r\n    \"courtLocationId\": 0,\r\n    \"courtLocationName\": \"\",\r\n    \"hearingDate\": null,\r\n    \"defendants\": [\r\n        {\r\n            \"isDefendant\": true,\r\n            \"surname\": \"{{egressWorkspaceName}}\",\r\n            \"firstname\": \"\",\r\n            \"companyName\": \"\",\r\n            \"dateOfBirth\": \"1984-05-23\",\r\n            \"gender\": \"M\",\r\n            \"disability\": \"U\",\r\n            \"ethnicity\": \"W1\",\r\n            \"religion\": \"NP\",\r\n            \"type\": \"UN\",\r\n            \"arrestDate\": null,\r\n            \"seriousDangerousOffender\": false,\r\n            \"arrestSummonsNumber\": \"\",\r\n            \"isNotYetCharged\": false,\r\n            \"aliases\": [\r\n                {\r\n                    \"listOrder\": 0,\r\n                    \"surname\": \"McCoy\",\r\n                    \"firstNames\": \"William Archibald\"\r\n                }\r\n            ],\r\n            \"charges\": [\r\n                {\r\n                    \"offenceCode\": \"FI68036\",\r\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\r\n                    \"offenceId\": \"22336\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 0,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"isDefendant\": true,\r\n            \"surname\": \"McGinty\",\r\n            \"firstname\": \"Bunty\",\r\n            \"companyName\": \"\",\r\n            \"dateOfBirth\": \"1969-10-14\",\r\n            \"gender\": \"F\",\r\n            \"disability\": \"U\",\r\n            \"ethnicity\": \"W1\",\r\n            \"religion\": \"NP\",\r\n            \"type\": \"UN\",\r\n            \"arrestDate\": null,\r\n            \"seriousDangerousOffender\": true,\r\n            \"arrestSummonsNumber\": \"ASN1234\",\r\n            \"isNotYetCharged\": false,\r\n            \"aliases\": [],\r\n            \"charges\": [\r\n                {\r\n                    \"offenceCode\": \"FI68036\",\r\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\r\n                    \"offenceId\": \"22336\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 0,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                },\r\n                {\r\n                    \"offenceCode\": \"AL79014\",\r\n                    \"offenceDescription\": \"Sold controlled liquor wholesale to a buyer who will sell or supply it through a trade or business\",\r\n                    \"offenceId\": \"38808\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 1,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"victims\": [\r\n        {\r\n            \"surname\": \"Jamieson\",\r\n            \"forename\": \"Bongo\",\r\n            \"isVulnerable\": false,\r\n            \"isIntimidated\": false,\r\n            \"isWitness\": false\r\n        },\r\n        {\r\n            \"surname\": \"McDonald\",\r\n            \"forename\": \"Ronaldo\",\r\n            \"isVulnerable\": false,\r\n            \"isIntimidated\": true,\r\n            \"isWitness\": false\r\n        }\r\n    ],\r\n    \"complexity\": \"\",\r\n    \"caseWeight\": \"\",\r\n    \"monitoringCodes\":[\r\n        {\r\n            \"code\": \"ATRY\",\r\n            \"selected\": true\r\n        }\r\n    ],\r\n    \"prosecutorId\": 0,\r\n    \"caseWorker\": \"\",\r\n    \"oicRank\": \"\",\r\n    \"oicSurname\": \"\",\r\n    \"oicFirstnames\": \"\",\r\n    \"oicShoulderNumber\": \"\",\r\n    \"oicPoliceUnit\": \"\"\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{caseApiBaseUrl}}/api/v1/cases",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-cm-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "cases"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/cases\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Correlation-Id: bc838a6f-a337-437f-8e42-4d65469f9798\u0027 \\\r\n--header \u0027Cookie: Cms-Auth-Values=%7B%22Cookies%22%3A%22ASP.NET_SessionId%3Dulpixrfdcvml3za1hdj422og%3B%20UID%3D107546%3B%20WindowID%3DMASTER%3B%20CMSUSER107546%3Dulpixrfdcvml3za1hdj422og%3B%20.CMSAUTH%3DFD05163543BAC665F4B154276A0CE0E5304706EE1D60FD09496CAB70192F9B9794955DEF363D04BEFBF320F354587066E6F4207F6D0D2A6F9F675E0B820107D8934D67E56C3F68794153A3B4B51D52498CB2EF0A81925FADDC9FC8E4F08E87356DF2157547D3742B010297C8EBCA2C15FB41A42519377A312B79BA1A6E42635066B8FF97%3B%20dtCookie%3Dv_4_srv_4_sn_E09DF4A74B6AAC89D762D0DB73BD9B9B_perc_100000_ol_0_mul_1_app-3A1d479dbf707b0c2a_1%3B%20BIGipServer~ent-s221~CPSACP-LTM-CM-WAN-CIN3-cin3.cps.gov.uk_POOL%3Drd1o00000000000000000000ffff0a02a00do80%22%2C%22Token%22%3A%226db92e06-827e-479b-9bf4-c0f5dd0bf721%22%2C%22ExpiryTime%22%3A%222026-01-15T16%3A56%3A29.8514537%2B00%3A00%22%7D\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--data \u0027{\r\n    \"urn\": {\r\n        \"policeForce\": \"45\",\r\n        \"policeUnit\": \"EL\",\r\n        \"uniqueRef\": \"45155\",\r\n        \"year\": 25\r\n    },\r\n    \"registeringAreaId\": 1001,\r\n    \"registeringUnitId\": 2002,\r\n    \"allocatedWcuId\": 2012391,\r\n    \"crest\": \"\",\r\n    \"operationName\": \"\",\r\n    \"courtLocationId\": 0,\r\n    \"courtLocationName\": \"\",\r\n    \"hearingDate\": null,\r\n    \"defendants\": [],\r\n    \"victims\": [],\r\n    \"complexity\": \"\",\r\n    \"caseWeight\": \"\",\r\n    \"monitoringCodes\":[\r\n        {\r\n            \"code\": \"CSEA\",\r\n            \"selected\": true\r\n        }\r\n    ],\r\n    \"prosecutorId\": 0,\r\n    \"caseWorker\": \"\",\r\n    \"oicRank\": \"\",\r\n    \"oicSurname\": \"\",\r\n    \"oicFirstnames\": \"\",\r\n    \"oicShoulderNumber\": \"\",\r\n    \"oicPoliceUnit\": \"\"\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "3. Search Case",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is array\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.be.an(\u0027array\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (Array.isArray(response) \u0026\u0026 response.length \u003e 0) {",
                                                                                    "    pm.test(\u0027Case has required fields\u0027, function() {",
                                                                                    "        const caseData = response[0];",
                                                                                    "        pm.expect(caseData).to.have.property(\u0027caseId\u0027);",
                                                                                    "        pm.expect(caseData).to.have.property(\u0027urn\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    const caseData = response[0];",
                                                                                    "    pm.environment.set(\u0027caseId\u0027, caseData.caseId);",
                                                                                    "    pm.environment.set(\u0027egressWorkspaceId\u0027, caseData.egressWorkspaceId || pm.environment.get(\u0027egressWorkspaceId\u0027));",
                                                                                    "    pm.environment.set(\u0027netappPath\u0027, caseData.netappFolderPath || \u0027capricorn/\u0027);",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Case found:\u0027, caseData.caseId);",
                                                                                    "    console.log(\u0027    URN:\u0027, caseData.urn);",
                                                                                    "    pm.execution.setNextRequest(\u00274. Egress connection\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027No cases found\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/case-search?urn={{caseUrn}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "case-search"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "urn",
                                                                                    "value":  "{{caseUrn}}"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "4. Egress connection",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00275. Get Netapp Folders\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\r\n    \"caseId\": {{caseId}}\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/connections",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/egress/connections\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027 \\\r\n--data \u0027{\r\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\r\n    \"caseId\": 2178476\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5. Get Netapp Folders",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00276. Create Netapp Connection\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/folders?operation-name={{egressWorkspaceName}}\u0026path=\u0026take=50\u0026continuation-token=",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "folders"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "operation-name",
                                                                                    "value":  "{{egressWorkspaceName}}"
                                                                                },
                                                                                {
                                                                                    "key":  "path",
                                                                                    "value":  ""
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50"
                                                                                },
                                                                                {
                                                                                    "key":  "continuation-token",
                                                                                    "value":  ""
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/netapp/folders?operation-name=AUTOMATION-TESTING9\u0026path=\u0026take=50\u0026continuation-token=\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "6. Create Netapp Connection",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00277. List Egress Files\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"operationName\": \"{{egressWorkspaceName}}\",\r\n    \"folderPath\": \"{{netappFolderPath}}\",\r\n    \"caseId\": {{caseId}}\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/connections",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/netapp/connections\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027 \\\r\n--data \u0027{\r\n    \"operationName\": \"AUTOMATION-TESTING9\",\r\n    \"folderPath\": \"{{netappFolderPath}}\",\r\n    \"caseId\": 2178476\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "7. List Egress Files",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Check if we have a folder ID (means this is the second call to list files in the folder)",
                                                                                    "const folderId = pm.environment.get(\u0027egressTargetFolderId\u0027) || \u0027\u0027;",
                                                                                    "",
                                                                                    "if (!folderId) {",
                                                                                    "    console.log(\u0027[LIST FILES] First call - listing root to find folder\u0027);",
                                                                                    "    // Clear folder-id for root listing",
                                                                                    "    pm.environment.set(\u0027egressTargetFolderId\u0027, \u0027\u0027);",
                                                                                    "} else {",
                                                                                    "    console.log(\u0027[LIST FILES] Second call - listing files in folder:\u0027, folderId);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const allItems = response.data || [];",
                                                                                    "const targetFolderName = \u00274. Served Evidence\u0027;",
                                                                                    "",
                                                                                    "console.log(\u0027=== List Egress Root (Step 7) ===\u0027);",
                                                                                    "console.log(\u0027Items in root:\u0027, allItems.length);",
                                                                                    "",
                                                                                    "// Find the target folder",
                                                                                    "const folder = allItems.find(item =\u003e item.isFolder \u0026\u0026 item.name === targetFolderName);",
                                                                                    "",
                                                                                    "if (folder) {",
                                                                                    "    console.log(\u0027[OK] Found folder:\u0027, targetFolderName);",
                                                                                    "    console.log(\u0027    Folder ID:\u0027, folder.id);",
                                                                                    "    pm.environment.set(\u0027egressServedEvidenceFolderId\u0027, folder.id);",
                                                                                    "    pm.execution.setNextRequest(\u00277b. List Files in Folder\u0027);",
                                                                                    "} else {",
                                                                                    "    console.log(\u0027[ERROR] Folder not found:\u0027, targetFolderName);",
                                                                                    "    console.log(\u0027Available folders:\u0027);",
                                                                                    "    allItems.filter(i =\u003e i.isFolder).forEach(f =\u003e console.log(\u0027  -\u0027, f.name, \u0027ID:\u0027, f.id));",
                                                                                    "    pm.test(\u0027Target folder found\u0027, function() {",
                                                                                    "        pm.expect.fail(\u0027Folder \"\u0027 + targetFolderName + \u0027\" not found\u0027);",
                                                                                    "    });",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.test(\u0027Target folder found\u0027, function() {",
                                                                                    "    pm.expect(folder).to.not.be.undefined;",
                                                                                    "});"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/workspaces/{{egressWorkspaceId}}/files?skip=0\u0026take=100",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "skip",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "100"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "7b. List Files in Folder",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "const folderId = pm.environment.get(\u0027egressServedEvidenceFolderId\u0027);",
                                                                                    "console.log(\u0027[7b] Listing files in folder ID:\u0027, folderId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const files = (response.data || []).filter(f =\u003e !f.isFolder);",
                                                                                    "",
                                                                                    "console.log(\u0027=== List Files in Folder (Step 7b) ===\u0027);",
                                                                                    "console.log(\u0027Files found:\u0027, files.length);",
                                                                                    "",
                                                                                    "// Get preset file names from upload script",
                                                                                    "const presetFileNames = pm.environment.get(\u0027egressFileNames\u0027) || \u0027\u0027;",
                                                                                    "const presetFileName = pm.environment.get(\u0027egressFileName\u0027) || \u0027\u0027;",
                                                                                    "let targetNames = [];",
                                                                                    "",
                                                                                    "if (presetFileNames) {",
                                                                                    "    targetNames = presetFileNames.split(\u0027,\u0027).map(s =\u003e s.trim().split(\u0027/\u0027).pop());",
                                                                                    "} else if (presetFileName) {",
                                                                                    "    targetNames = [presetFileName.trim().split(\u0027/\u0027).pop()];",
                                                                                    "}",
                                                                                    "",
                                                                                    "console.log(\u0027[INFO] Looking for files:\u0027, targetNames.join(\u0027, \u0027));",
                                                                                    "",
                                                                                    "// Match files by name and get LCC API IDs",
                                                                                    "let matchedFiles = [];",
                                                                                    "for (const name of targetNames) {",
                                                                                    "    const match = files.find(f =\u003e f.name === name);",
                                                                                    "    if (match) {",
                                                                                    "        matchedFiles.push(match);",
                                                                                    "        console.log(\u0027[MATCH]\u0027, name);",
                                                                                    "        console.log(\u0027    LCC API ID:\u0027, match.id);",
                                                                                    "    } else {",
                                                                                    "        console.log(\u0027[WARN] File not found:\u0027, name);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "if (matchedFiles.length \u003e 0) {",
                                                                                    "    // IMPORTANT: Update with LCC API file IDs",
                                                                                    "    const lccIds = matchedFiles.map(f =\u003e f.id).join(\u0027,\u0027);",
                                                                                    "    const lccNames = matchedFiles.map(f =\u003e f.name).join(\u0027,\u0027);",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027egressFileIds\u0027, lccIds);",
                                                                                    "    pm.environment.set(\u0027egressFileNames\u0027, lccNames);",
                                                                                    "    pm.environment.set(\u0027egressFileId\u0027, matchedFiles[0].id);",
                                                                                    "    pm.environment.set(\u0027egressFileName\u0027, matchedFiles[0].name);",
                                                                                    "    pm.environment.set(\u0027egressFileCount\u0027, matchedFiles.length.toString());",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Updated environment with LCC API file IDs:\u0027);",
                                                                                    "    console.log(\u0027    egressFileIds:\u0027, lccIds);",
                                                                                    "    console.log(\u0027    egressFileCount:\u0027, matchedFiles.length);",
                                                                                    "} else if (files.length \u003e 0) {",
                                                                                    "    // No match by name, use latest files",
                                                                                    "    console.log(\u0027[WARN] No exact name matches, using latest files\u0027);",
                                                                                    "    const sortedFiles = files.sort((a, b) =\u003e new Date(b.dateUpdated) - new Date(a.dateUpdated));",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027egressFileIds\u0027, sortedFiles.map(f =\u003e f.id).join(\u0027,\u0027));",
                                                                                    "    pm.environment.set(\u0027egressFileNames\u0027, sortedFiles.map(f =\u003e f.name).join(\u0027,\u0027));",
                                                                                    "    pm.environment.set(\u0027egressFileId\u0027, sortedFiles[0].id);",
                                                                                    "    pm.environment.set(\u0027egressFileName\u0027, sortedFiles[0].name);",
                                                                                    "    pm.environment.set(\u0027egressFileCount\u0027, sortedFiles.length.toString());",
                                                                                    "} else {",
                                                                                    "    console.log(\u0027[ERROR] No files found in folder!\u0027);",
                                                                                    "}",
                                                                                    "",
                                                                                    "// Clean up",
                                                                                    "pm.environment.unset(\u0027egressServedEvidenceFolderId\u0027);",
                                                                                    "",
                                                                                    "pm.test(\u0027Files found for transfer\u0027, function() {",
                                                                                    "    const fileId = pm.environment.get(\u0027egressFileId\u0027);",
                                                                                    "    pm.expect(fileId).to.be.a(\u0027string\u0027).and.not.empty;",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.execution.setNextRequest(\u00278. Validate Transfer\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/workspaces/{{egressWorkspaceId}}/files?folder-id={{egressServedEvidenceFolderId}}\u0026skip=0\u0026take=100",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "folder-id",
                                                                                    "value":  "{{egressServedEvidenceFolderId}}"
                                                                                },
                                                                                {
                                                                                    "key":  "skip",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "100"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "8. Validate Transfer",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Build sourcePaths for VALIDATE endpoint",
                                                                                    "// Format: { fileId, path: FULL_PATH, isFolder: false }",
                                                                                    "let sourcePaths = [];",
                                                                                    "const sourceFolder = pm.environment.get(\u0027egressUploadFolderPath\u0027) || \u00274. Served Evidence/\u0027;",
                                                                                    "",
                                                                                    "const fileCount = parseInt(pm.environment.get(\u0027egressFileCount\u0027) || \u00271\u0027);",
                                                                                    "const fileIds = pm.environment.get(\u0027egressFileIds\u0027) || \u0027\u0027;",
                                                                                    "const fileNames = pm.environment.get(\u0027egressFileNames\u0027) || \u0027\u0027;",
                                                                                    "",
                                                                                    "console.log(\u0027[VALIDATE] Building sourcePaths\u0027);",
                                                                                    "console.log(\u0027  Source folder:\u0027, sourceFolder);",
                                                                                    "",
                                                                                    "if (fileCount \u003e 1 \u0026\u0026 fileIds \u0026\u0026 fileNames) {",
                                                                                    "    const ids = fileIds.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const names = fileNames.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const count = Math.min(fileCount, ids.length, names.length);",
                                                                                    "    ",
                                                                                    "    for (let i = 0; i \u003c count; i++) {",
                                                                                    "        let fileName = names[i];",
                                                                                    "        if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "        const fullPath = sourceFolder + fileName;",
                                                                                    "        ",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: ids[i],",
                                                                                    "            path: fullPath,",
                                                                                    "            isFolder: false",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File\u0027, (i+1) + \u0027:\u0027, fullPath);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    const fileId = pm.environment.get(\u0027egressFileId\u0027) || \u0027\u0027;",
                                                                                    "    let fileName = pm.environment.get(\u0027egressFileName\u0027) || \u0027\u0027;",
                                                                                    "    if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "    ",
                                                                                    "    if (fileId \u0026\u0026 fileName) {",
                                                                                    "        const fullPath = sourceFolder + fileName;",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: fileId,",
                                                                                    "            path: fullPath,",
                                                                                    "            isFolder: false",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File:\u0027, fullPath);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.environment.set(\u0027sourcePathsJson\u0027, JSON.stringify(sourcePaths));",
                                                                                    "console.log(\u0027[DEBUG] sourcePathsJson:\u0027, JSON.stringify(sourcePaths, null, 2));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has validation structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027caseId\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027workspaceId\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027files\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027isInvalid\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027validationErrors\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "",
                                                                                    "pm.test(\u0027Transfer is valid\u0027, function() {",
                                                                                    "    pm.expect(response.isInvalid).to.be.false;",
                                                                                    "});",
                                                                                    "",
                                                                                    "console.log(\u0027[INFO] Files to transfer: \u0027 + (response.files ? response.files.length : 0));",
                                                                                    "",
                                                                                    "if (!response.isInvalid) {",
                                                                                    "    console.log(\u0027[OK] Transfer validated\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u00279. Initiate Transfer\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Validation errors:\u0027, response.validationErrors);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"transferDirection\": \"EgressToNetApp\",\n    \"transferType\": \"Copy\",\n    \"sourcePaths\": {{sourcePathsJson}},\n    \"destinationPath\": \"{{netappFolderPath}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"sourceRootFolderPath\": \"{{egressUploadFolderPath}}\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/files",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "files"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "9. Initiate Transfer",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Build sourcePaths for INITIATE endpoint",
                                                                                    "// Format: { fileId, path: FILENAME_ONLY, fullFilePath: FULL_PATH }",
                                                                                    "let sourcePaths = [];",
                                                                                    "const sourceFolder = pm.environment.get(\u0027egressUploadFolderPath\u0027) || \u00274. Served Evidence/\u0027;",
                                                                                    "",
                                                                                    "const fileCount = parseInt(pm.environment.get(\u0027egressFileCount\u0027) || \u00271\u0027);",
                                                                                    "const fileIds = pm.environment.get(\u0027egressFileIds\u0027) || \u0027\u0027;",
                                                                                    "const fileNames = pm.environment.get(\u0027egressFileNames\u0027) || \u0027\u0027;",
                                                                                    "",
                                                                                    "console.log(\u0027[INITIATE] Building sourcePaths\u0027);",
                                                                                    "console.log(\u0027  Source folder:\u0027, sourceFolder);",
                                                                                    "",
                                                                                    "if (fileCount \u003e 1 \u0026\u0026 fileIds \u0026\u0026 fileNames) {",
                                                                                    "    const ids = fileIds.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const names = fileNames.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const count = Math.min(fileCount, ids.length, names.length);",
                                                                                    "    ",
                                                                                    "    for (let i = 0; i \u003c count; i++) {",
                                                                                    "        let fileName = names[i];",
                                                                                    "        if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "        ",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: ids[i],",
                                                                                    "            path: fileName,",
                                                                                    "            fullFilePath: sourceFolder + fileName",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File\u0027, (i+1) + \u0027:\u0027, fileName, \u0027-\u003e fullFilePath:\u0027, sourceFolder + fileName);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    const fileId = pm.environment.get(\u0027egressFileId\u0027) || \u0027\u0027;",
                                                                                    "    let fileName = pm.environment.get(\u0027egressFileName\u0027) || \u0027\u0027;",
                                                                                    "    if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "    ",
                                                                                    "    if (fileId \u0026\u0026 fileName) {",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: fileId,",
                                                                                    "            path: fileName,",
                                                                                    "            fullFilePath: sourceFolder + fileName",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File:\u0027, fileName, \u0027-\u003e fullFilePath:\u0027, sourceFolder + fileName);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.environment.set(\u0027sourcePathsJson\u0027, JSON.stringify(sourcePaths));",
                                                                                    "console.log(\u0027[DEBUG] sourcePathsJson:\u0027, JSON.stringify(sourcePaths, null, 2));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 202\u0027, function() {",
                                                                                    "    pm.response.to.have.status(202);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has transfer initiation structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027id\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027status\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027createdAt\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.id) {",
                                                                                    "    pm.environment.set(\u0027transferId\u0027, response.id);",
                                                                                    "    pm.environment.set(\u0027transferPollCount\u0027, \u00270\u0027);",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Transfer initiated\u0027);",
                                                                                    "    console.log(\u0027    ID:\u0027, response.id);",
                                                                                    "    console.log(\u0027    Status:\u0027, response.status);",
                                                                                    "    pm.execution.setNextRequest(\u002710. Poll Transfer Status\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to initiate\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"sourcePaths\": {{sourcePathsJson}},\n    \"destinationPath\": \"{{netappFolderPath}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"transferType\": \"Copy\",\n    \"transferDirection\": \"EgressToNetApp\",\n    \"sourceRootFolderPath\": \"{{egressUploadFolderPath}}\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/initiate",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "initiate"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "10. Poll Transfer Status",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Add delay between polls",
                                                                                    "const pollCount = parseInt(pm.environment.get(\u0027transferPollCount\u0027) || \u00270\u0027);",
                                                                                    "if (pollCount \u003e 0) {",
                                                                                    "    const waitTime = 2000;",
                                                                                    "    const start = Date.now();",
                                                                                    "    while (Date.now() - start \u003c waitTime) {}",
                                                                                    "}",
                                                                                    "console.log(\u0027Polling status (attempt \u0027 + (pollCount + 1) + \u0027)...\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Handle both 200 and 404 (transfer might not be immediately available)",
                                                                                    "const statusCode = pm.response.code;",
                                                                                    "const pollCount = parseInt(pm.environment.get(\u0027transferPollCount\u0027) || \u00270\u0027);",
                                                                                    "",
                                                                                    "if (statusCode === 404) {",
                                                                                    "    // Transfer not yet available, retry",
                                                                                    "    console.log(\u0027Transfer not found yet (attempt \u0027 + (pollCount + 1) + \u0027), retrying...\u0027);",
                                                                                    "    pm.environment.set(\u0027transferPollCount\u0027, (pollCount + 1).toString());",
                                                                                    "    pm.execution.setNextRequest(\u002710. Poll Transfer Status\u0027);",
                                                                                    "} else if (statusCode === 200) {",
                                                                                    "    pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "        pm.response.to.have.status(200);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    pm.test(\u0027Response has status structure\u0027, function() {",
                                                                                    "        const response = pm.response.json();",
                                                                                    "        pm.expect(response).to.have.property(\u0027status\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    const status = response.status;",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[Poll \u0027 + (pollCount + 1) + \u0027] Status:\u0027, status);",
                                                                                    "    console.log(\u0027    Transfer Type:\u0027, response.transferType);",
                                                                                    "    console.log(\u0027    Direction:\u0027, response.direction);",
                                                                                    "    ",
                                                                                    "    // Log failed items if any",
                                                                                    "    if (response.failedItems \u0026\u0026 response.failedItems.length \u003e 0) {",
                                                                                    "        console.log(\u0027    Failed Items:\u0027);",
                                                                                    "        response.failedItems.forEach(item =\u003e {",
                                                                                    "            console.log(\u0027      - \u0027 + item.sourcePath + \u0027 (\u0027 + item.errorCode + \u0027)\u0027);",
                                                                                    "        });",
                                                                                    "    }",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027transferStatus\u0027, status);",
                                                                                    "    ",
                                                                                    "    // Terminal statuses: Completed, PartiallyCompleted, Failed",
                                                                                    "    // Keep polling for: Initiated, InProgress",
                                                                                    "    if (status === \u0027Completed\u0027 || status === \u0027PartiallyCompleted\u0027 || status === \u0027Failed\u0027) {",
                                                                                    "        console.log(\u0027[DONE] Transfer finished with status:\u0027, status);",
                                                                                    "        ",
                                                                                    "        if (response.completedAt) {",
                                                                                    "            console.log(\u0027    Completed At:\u0027, response.completedAt);",
                                                                                    "        }",
                                                                                    "        ",
                                                                                    "        // FAIL the test if status is not \u0027Completed\u0027",
                                                                                    "        pm.test(\u0027Transfer status is Completed (not PartiallyCompleted or Failed)\u0027, function() {",
                                                                                    "            pm.expect(status).to.equal(\u0027Completed\u0027);",
                                                                                    "        });",
                                                                                    "        ",
                                                                                    "        // Log result",
                                                                                    "        if (status === \u0027Completed\u0027) {",
                                                                                    "            console.log(\u0027[OK] Transfer completed successfully!\u0027);",
                                                                                    "        } else if (status === \u0027PartiallyCompleted\u0027) {",
                                                                                    "            console.log(\u0027[ERROR] Transfer PARTIALLY COMPLETED - some files failed!\u0027);",
                                                                                    "        } else if (status === \u0027Failed\u0027) {",
                                                                                    "            console.log(\u0027[ERROR] Transfer FAILED!\u0027);",
                                                                                    "        }",
                                                                                    "        ",
                                                                                    "        pm.execution.setNextRequest(\u002711. Verify Activity Log\u0027);",
                                                                                    "    } else {",
                                                                                    "        // Still in progress (Initiated or InProgress), continue polling",
                                                                                    "        console.log(\u0027    Transfer in progress, polling again...\u0027);",
                                                                                    "        pm.environment.set(\u0027transferPollCount\u0027, (pollCount + 1).toString());",
                                                                                    "        pm.execution.setNextRequest(\u002710. Poll Transfer Status\u0027);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    pm.test(\u0027Status code is 200 or 404\u0027, function() {",
                                                                                    "        pm.expect(statusCode).to.be.oneOf([200, 404]);",
                                                                                    "    });",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/{{transferId}}/status",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "{{transferId}}",
                                                                               "status"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "11. Verify Activity Log",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Wait for activity log to be recorded",
                                                                                    "const start = Date.now();",
                                                                                    "while (Date.now() - start \u003c 2000) {}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const activities = response.data || [];",
                                                                                    "const transferId = pm.environment.get(\u0027transferId\u0027);",
                                                                                    "",
                                                                                    "console.log(\u0027=== Activity Log Verification ===\u0027);",
                                                                                    "console.log(\u0027Looking for transfer:\u0027, transferId);",
                                                                                    "",
                                                                                    "// Find all activities for this transfer",
                                                                                    "const transferActivities = activities.filter(a =\u003e ",
                                                                                    "    a.details \u0026\u0026 a.details.transferId === transferId",
                                                                                    ");",
                                                                                    "",
                                                                                    "// Find TRANSFER_COMPLETED or TRANSFER_FAILED activity",
                                                                                    "const completedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_COMPLETED\u0027);",
                                                                                    "const failedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_FAILED\u0027);",
                                                                                    "const initiatedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_INITIATED\u0027);",
                                                                                    "",
                                                                                    "// Use completed activity for download, or failed, or initiated as fallback",
                                                                                    "const activityForDownload = completedActivity || failedActivity || initiatedActivity;",
                                                                                    "",
                                                                                    "pm.test(\u0027Transfer activity was logged\u0027, function() {",
                                                                                    "    pm.expect(activityForDownload).to.not.be.undefined;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (activityForDownload) {",
                                                                                    "    // Store activity ID for download",
                                                                                    "    pm.environment.set(\u0027latestActivityId\u0027, activityForDownload.id);",
                                                                                    "    pm.environment.set(\u0027activityId\u0027, activityForDownload.id);",
                                                                                    "    ",
                                                                                    "    const actionType = activityForDownload.actionType || \u0027\u0027;",
                                                                                    "    const details = activityForDownload.details || {};",
                                                                                    "    ",
                                                                                    "    // Extract transfer details",
                                                                                    "    const totalFiles = details.totalFiles || 0;",
                                                                                    "    const transferedFileCount = details.transferedFileCount || 0;",
                                                                                    "    const errorFileCount = details.errorFileCount || 0;",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Transfer activity found:\u0027);",
                                                                                    "    console.log(\u0027    Activity ID:\u0027, activityForDownload.id);",
                                                                                    "    console.log(\u0027    Action Type:\u0027, actionType);",
                                                                                    "    console.log(\u0027    Total Files:\u0027, totalFiles);",
                                                                                    "    console.log(\u0027    Transferred:\u0027, transferedFileCount);",
                                                                                    "    console.log(\u0027    Errors:\u0027, errorFileCount);",
                                                                                    "    console.log(\u0027    Time:\u0027, activityForDownload.createdAt);",
                                                                                    "    ",
                                                                                    "    // Determine actual status based on details (matching UI logic)",
                                                                                    "    let transferStatus = \u0027Unknown\u0027;",
                                                                                    "    if (actionType === \u0027TRANSFER_COMPLETED\u0027 || actionType === \u0027TRANSFER_FAILED\u0027) {",
                                                                                    "        if (!transferedFileCount || transferedFileCount === 0) {",
                                                                                    "            transferStatus = \u0027Failed\u0027;",
                                                                                    "        } else if (totalFiles === transferedFileCount \u0026\u0026 !errorFileCount) {",
                                                                                    "            transferStatus = \u0027Completed\u0027;",
                                                                                    "        } else {",
                                                                                    "            transferStatus = \u0027Completed with errors\u0027;",
                                                                                    "        }",
                                                                                    "    }",
                                                                                    "    ",
                                                                                    "    console.log(\u0027    Status:\u0027, transferStatus);",
                                                                                    "    pm.environment.set(\u0027activityTransferStatus\u0027, transferStatus);",
                                                                                    "    ",
                                                                                    "    // FAIL test if status is not \u0027Completed\u0027",
                                                                                    "    pm.test(\u0027Transfer status is Completed (not Failed or Completed with errors)\u0027, function() {",
                                                                                    "        pm.expect(transferStatus).to.equal(\u0027Completed\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    // Log result",
                                                                                    "    if (transferStatus === \u0027Completed\u0027) {",
                                                                                    "        console.log(\u0027[OK] Transfer completed successfully!\u0027);",
                                                                                    "    } else if (transferStatus === \u0027Failed\u0027) {",
                                                                                    "        console.log(\u0027[ERROR] Transfer FAILED! No files transferred.\u0027);",
                                                                                    "    } else if (transferStatus === \u0027Completed with errors\u0027) {",
                                                                                    "        console.log(\u0027[ERROR] Transfer PARTIALLY COMPLETED! Some files failed.\u0027);",
                                                                                    "        console.log(\u0027    Failed files:\u0027, errorFileCount);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.execution.setNextRequest(\u002712. Download Activity Log\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/logs?caseId={{caseId}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "logs"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "caseId",
                                                                                    "value":  "{{caseId}}"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "12. Download Activity Log",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const transferStatus = pm.environment.get(\u0027activityTransferStatus\u0027) || pm.environment.get(\u0027transferStatus\u0027);",
                                                                                    "",
                                                                                    "console.log(\u0027========================================\u0027);",
                                                                                    "console.log(\u0027  E2E TEST COMPLETE!\u0027);",
                                                                                    "console.log(\u0027========================================\u0027);",
                                                                                    "console.log(\u0027Transfer Status:\u0027, transferStatus);",
                                                                                    "console.log(\u0027Activity Log Downloaded: OK\u0027);",
                                                                                    "",
                                                                                    "// Final status check - fail if not Completed",
                                                                                    "pm.test(\u0027Final transfer status is Completed\u0027, function() {",
                                                                                    "    pm.expect(transferStatus).to.equal(\u0027Completed\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "// Cleanup",
                                                                                    "pm.environment.unset(\u0027transferPollCount\u0027);",
                                                                                    "pm.environment.unset(\u0027activityTransferStatus\u0027);",
                                                                                    "pm.execution.setNextRequest(null);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/{{latestActivityId}}/logs/download",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "{{latestActivityId}}",
                                                                               "logs",
                                                                               "download"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "End-to-end test: Copy file from Egress to NetApp with activity log verification.\n\n## Flow (9 steps)\n1. Get Azure AD Token\n2. Get CMS Auth\n3. Search Case\n4. List Egress Files (gets latest by timestamp)\n5. Validate Transfer\n6. Initiate Transfer\n7. Poll Status (loops until complete)\n8. Verify Activity Log\n9. Download Activity Log\n\n## Response Validation\nEach request validates:\n- HTTP 200 status\n- Required response fields\n- Data structure"
                 },
                 {
                     "name":  "E2E: Egress to NetApp Move",
                     "item":  [
                                  {
                                      "name":  "1. Get Azure AD Token",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has token structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027access_token\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027token_type\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027expires_in\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.access_token) {",
                                                                                    "    pm.environment.set(\u0027accessToken\u0027, response.access_token);",
                                                                                    "    console.log(\u0027[OK] Azure AD Token obtained\u0027);",
                                                                                    "    console.log(\u0027    Expires in:\u0027, response.expires_in, \u0027seconds\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u00272. Get CMS Auth\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to get token\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "client_id",
                                                                                          "value":  "{{apiClientId}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "scope",
                                                                                          "value":  "api://{{apiClientId}}/user_impersonation"
                                                                                      },
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{azureUsername}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{azurePassword}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "grant_type",
                                                                                          "value":  "password"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "https://login.microsoftonline.com/{{tenantId}}/oauth2/v2.0/token",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "login",
                                                                               "microsoftonline",
                                                                               "com"
                                                                           ],
                                                                  "path":  [
                                                                               "{{tenantId}}",
                                                                               "oauth2",
                                                                               "v2.0",
                                                                               "token"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "2. Get CMS Auth",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has CMS auth structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027Cookies\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027Token\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.Cookies) {",
                                                                                    "    const encoded = encodeURIComponent(JSON.stringify(response));",
                                                                                    "    pm.environment.set(\u0027cmsAuth\u0027, encoded);",
                                                                                    "    console.log(\u0027[OK] CMS Auth obtained\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u00273. Register Case\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to get CMS auth\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     },
                                                                     {
                                                                         "key":  "x-functions-key",
                                                                         "value":  "{{ddeiAccessKey}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{cmsUsername}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{cmsPassword}}"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{ddeiBaseUrl}}/authenticate",
                                                                  "host":  [
                                                                               "{{ddeiBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "authenticate"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "3. Register Case",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {\r",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);\r",
                                                                                    "    return v.toString(16);\r",
                                                                                    "});\r",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200 OK\", function () {\r",
                                                                                    "    pm.response.to.have.status(200);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "var responseBody = pm.response.json();\r",
                                                                                    "\r",
                                                                                    "pm.test(\"caseId is greater than 0\", function () {\r",
                                                                                    "    pm.expect(responseBody.caseId).to.be.above(0);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "pm.test(\"caseId is an integer\", function () {\r",
                                                                                    "    pm.expect(Number.isInteger(responseBody.caseId)).to.be.true;\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "pm.test(\"URN format valid\", function () {\r",
                                                                                    "    const urnPattern = /^\\d{2}[A-Z0-9]{2}\\d{7}$/;\r",
                                                                                    "    pm.expect(responseBody.urn).to.match(urnPattern);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "// Store for subsequent requests\r",
                                                                                    "if (responseBody.caseId) {\r",
                                                                                    "    // Store caseId\r",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);\r",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);\r",
                                                                                    "    \r",
                                                                                    "    // Store full URN for case search\r",
                                                                                    "    pm.environment.set(\"caseUrn\", responseBody.urn);\r",
                                                                                    "    pm.environment.set(\"caseUrn\", responseBody.urn);\r",
                                                                                    "    \r",
                                                                                    "    // Store defendant surname for search\r",
                                                                                    "    const defendantSurname = pm.environment.get(\"defendantSurname\") || \"Miller\";\r",
                                                                                    "    pm.environment.set(\"searchDefendantName\", defendantSurname);\r",
                                                                                    "    pm.environment.set(\"searchDefendantName\", defendantSurname);\r",
                                                                                    "    \r",
                                                                                    "    console.log(\"=== CASE CREATED ===\");\r",
                                                                                    "    console.log(\"Case ID:\", responseBody.caseId);\r",
                                                                                    "    console.log(\"URN:\", responseBody.urn);\r",
                                                                                    "    console.log(\"Defendant:\", defendantSurname);\r",
                                                                                    "    console.log(\"\");\r",
                                                                                    "    console.log(\"Variables set for next calls:\");\r",
                                                                                    "    console.log(\"  caseId =\", responseBody.caseId);\r",
                                                                                    "    console.log(\"  caseUrn =\", responseBody.urn);\r",
                                                                                    "    console.log(\"  searchDefendantName =\", defendantSurname);\r",
                                                                                    "}\r",
                                                                                    "pm.execution.setNextRequest(\u00273. Search Case\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"urn\": {\r\n        \"policeForce\": \"45\",\r\n        \"policeUnit\": \"EL\",\r\n        \"uniqueRef\": \"{{urnUniqueRef}}\",\r\n        \"year\": 25\r\n    },\r\n    \"registeringAreaId\": 1001,\r\n    \"registeringUnitId\": 2002,\r\n    \"allocatedWcuId\": 2012391,\r\n    \"crest\": \"\",\r\n    \"operationName\": \"\",\r\n    \"courtLocationId\": 0,\r\n    \"courtLocationName\": \"\",\r\n    \"hearingDate\": null,\r\n    \"defendants\": [\r\n        {\r\n            \"isDefendant\": true,\r\n            \"surname\": \"{{egressWorkspaceName}}\",\r\n            \"firstname\": \"\",\r\n            \"companyName\": \"\",\r\n            \"dateOfBirth\": \"1984-05-23\",\r\n            \"gender\": \"M\",\r\n            \"disability\": \"U\",\r\n            \"ethnicity\": \"W1\",\r\n            \"religion\": \"NP\",\r\n            \"type\": \"UN\",\r\n            \"arrestDate\": null,\r\n            \"seriousDangerousOffender\": false,\r\n            \"arrestSummonsNumber\": \"\",\r\n            \"isNotYetCharged\": false,\r\n            \"aliases\": [\r\n                {\r\n                    \"listOrder\": 0,\r\n                    \"surname\": \"McCoy\",\r\n                    \"firstNames\": \"William Archibald\"\r\n                }\r\n            ],\r\n            \"charges\": [\r\n                {\r\n                    \"offenceCode\": \"FI68036\",\r\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\r\n                    \"offenceId\": \"22336\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 0,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"isDefendant\": true,\r\n            \"surname\": \"McGinty\",\r\n            \"firstname\": \"Bunty\",\r\n            \"companyName\": \"\",\r\n            \"dateOfBirth\": \"1969-10-14\",\r\n            \"gender\": \"F\",\r\n            \"disability\": \"U\",\r\n            \"ethnicity\": \"W1\",\r\n            \"religion\": \"NP\",\r\n            \"type\": \"UN\",\r\n            \"arrestDate\": null,\r\n            \"seriousDangerousOffender\": true,\r\n            \"arrestSummonsNumber\": \"ASN1234\",\r\n            \"isNotYetCharged\": false,\r\n            \"aliases\": [],\r\n            \"charges\": [\r\n                {\r\n                    \"offenceCode\": \"FI68036\",\r\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\r\n                    \"offenceId\": \"22336\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 0,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                },\r\n                {\r\n                    \"offenceCode\": \"AL79014\",\r\n                    \"offenceDescription\": \"Sold controlled liquor wholesale to a buyer who will sell or supply it through a trade or business\",\r\n                    \"offenceId\": \"38808\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 1,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"victims\": [\r\n        {\r\n            \"surname\": \"Jamieson\",\r\n            \"forename\": \"Bongo\",\r\n            \"isVulnerable\": false,\r\n            \"isIntimidated\": false,\r\n            \"isWitness\": false\r\n        },\r\n        {\r\n            \"surname\": \"McDonald\",\r\n            \"forename\": \"Ronaldo\",\r\n            \"isVulnerable\": false,\r\n            \"isIntimidated\": true,\r\n            \"isWitness\": false\r\n        }\r\n    ],\r\n    \"complexity\": \"\",\r\n    \"caseWeight\": \"\",\r\n    \"monitoringCodes\":[\r\n        {\r\n            \"code\": \"ATRY\",\r\n            \"selected\": true\r\n        }\r\n    ],\r\n    \"prosecutorId\": 0,\r\n    \"caseWorker\": \"\",\r\n    \"oicRank\": \"\",\r\n    \"oicSurname\": \"\",\r\n    \"oicFirstnames\": \"\",\r\n    \"oicShoulderNumber\": \"\",\r\n    \"oicPoliceUnit\": \"\"\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{caseApiBaseUrl}}/api/v1/cases",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-cm-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "cases"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/cases\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Correlation-Id: bc838a6f-a337-437f-8e42-4d65469f9798\u0027 \\\r\n--header \u0027Cookie: Cms-Auth-Values=%7B%22Cookies%22%3A%22ASP.NET_SessionId%3Dulpixrfdcvml3za1hdj422og%3B%20UID%3D107546%3B%20WindowID%3DMASTER%3B%20CMSUSER107546%3Dulpixrfdcvml3za1hdj422og%3B%20.CMSAUTH%3DFD05163543BAC665F4B154276A0CE0E5304706EE1D60FD09496CAB70192F9B9794955DEF363D04BEFBF320F354587066E6F4207F6D0D2A6F9F675E0B820107D8934D67E56C3F68794153A3B4B51D52498CB2EF0A81925FADDC9FC8E4F08E87356DF2157547D3742B010297C8EBCA2C15FB41A42519377A312B79BA1A6E42635066B8FF97%3B%20dtCookie%3Dv_4_srv_4_sn_E09DF4A74B6AAC89D762D0DB73BD9B9B_perc_100000_ol_0_mul_1_app-3A1d479dbf707b0c2a_1%3B%20BIGipServer~ent-s221~CPSACP-LTM-CM-WAN-CIN3-cin3.cps.gov.uk_POOL%3Drd1o00000000000000000000ffff0a02a00do80%22%2C%22Token%22%3A%226db92e06-827e-479b-9bf4-c0f5dd0bf721%22%2C%22ExpiryTime%22%3A%222026-01-15T16%3A56%3A29.8514537%2B00%3A00%22%7D\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--data \u0027{\r\n    \"urn\": {\r\n        \"policeForce\": \"45\",\r\n        \"policeUnit\": \"EL\",\r\n        \"uniqueRef\": \"45155\",\r\n        \"year\": 25\r\n    },\r\n    \"registeringAreaId\": 1001,\r\n    \"registeringUnitId\": 2002,\r\n    \"allocatedWcuId\": 2012391,\r\n    \"crest\": \"\",\r\n    \"operationName\": \"\",\r\n    \"courtLocationId\": 0,\r\n    \"courtLocationName\": \"\",\r\n    \"hearingDate\": null,\r\n    \"defendants\": [],\r\n    \"victims\": [],\r\n    \"complexity\": \"\",\r\n    \"caseWeight\": \"\",\r\n    \"monitoringCodes\":[\r\n        {\r\n            \"code\": \"CSEA\",\r\n            \"selected\": true\r\n        }\r\n    ],\r\n    \"prosecutorId\": 0,\r\n    \"caseWorker\": \"\",\r\n    \"oicRank\": \"\",\r\n    \"oicSurname\": \"\",\r\n    \"oicFirstnames\": \"\",\r\n    \"oicShoulderNumber\": \"\",\r\n    \"oicPoliceUnit\": \"\"\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "3. Search Case",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is array\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.be.an(\u0027array\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (Array.isArray(response) \u0026\u0026 response.length \u003e 0) {",
                                                                                    "    pm.test(\u0027Case has required fields\u0027, function() {",
                                                                                    "        const caseData = response[0];",
                                                                                    "        pm.expect(caseData).to.have.property(\u0027caseId\u0027);",
                                                                                    "        pm.expect(caseData).to.have.property(\u0027urn\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    const caseData = response[0];",
                                                                                    "    pm.environment.set(\u0027caseId\u0027, caseData.caseId);",
                                                                                    "    pm.environment.set(\u0027egressWorkspaceId\u0027, caseData.egressWorkspaceId || pm.environment.get(\u0027egressWorkspaceId\u0027));",
                                                                                    "    pm.environment.set(\u0027netappPath\u0027, caseData.netappFolderPath || \u0027capricorn/\u0027);",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Case found:\u0027, caseData.caseId);",
                                                                                    "    console.log(\u0027    URN:\u0027, caseData.urn);",
                                                                                    "    pm.execution.setNextRequest(\u00274. Egress connection\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027No cases found\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/case-search?urn={{caseUrn}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "case-search"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "urn",
                                                                                    "value":  "{{caseUrn}}"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "4. Egress connection",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00275. Create Netapp Connection\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\r\n    \"caseId\": {{caseId}}\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/connections",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/egress/connections\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027 \\\r\n--data \u0027{\r\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\r\n    \"caseId\": 2178476\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5. Create Netapp Connection",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00276. Get Netapp Folders\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"operationName\": \"{{egressWorkspaceName}}\",\r\n    \"folderPath\": \"{{netappFolderPath}}\",\r\n    \"caseId\": {{caseId}}\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/connections",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/netapp/connections\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027 \\\r\n--data \u0027{\r\n    \"operationName\": \"AUTOMATION-TESTING9\",\r\n    \"folderPath\": \"{{netappFolderPath}}\",\r\n    \"caseId\": 2178476\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "6. Get Netapp Folders",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00277. List Egress Files\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/folders?operation-name={{egressWorkspaceName}}\u0026path=\u0026take=50\u0026continuation-token=",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "folders"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "operation-name",
                                                                                    "value":  "{{egressWorkspaceName}}"
                                                                                },
                                                                                {
                                                                                    "key":  "path",
                                                                                    "value":  ""
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50"
                                                                                },
                                                                                {
                                                                                    "key":  "continuation-token",
                                                                                    "value":  ""
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/netapp/folders?operation-name=AUTOMATION-TESTING9\u0026path=\u0026take=50\u0026continuation-token=\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "7. List Egress Files",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Check if we have a folder ID (means this is the second call to list files in the folder)",
                                                                                    "const folderId = pm.environment.get(\u0027egressTargetFolderId\u0027) || \u0027\u0027;",
                                                                                    "",
                                                                                    "if (!folderId) {",
                                                                                    "    console.log(\u0027[LIST FILES] First call - listing root to find folder\u0027);",
                                                                                    "    // Clear folder-id for root listing",
                                                                                    "    pm.environment.set(\u0027egressTargetFolderId\u0027, \u0027\u0027);",
                                                                                    "} else {",
                                                                                    "    console.log(\u0027[LIST FILES] Second call - listing files in folder:\u0027, folderId);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const allItems = response.data || [];",
                                                                                    "const targetFolderName = \u00274. Served Evidence\u0027;",
                                                                                    "",
                                                                                    "console.log(\u0027=== List Egress Root (Step 7) ===\u0027);",
                                                                                    "console.log(\u0027Items in root:\u0027, allItems.length);",
                                                                                    "",
                                                                                    "// Find the target folder",
                                                                                    "const folder = allItems.find(item =\u003e item.isFolder \u0026\u0026 item.name === targetFolderName);",
                                                                                    "",
                                                                                    "if (folder) {",
                                                                                    "    console.log(\u0027[OK] Found folder:\u0027, targetFolderName);",
                                                                                    "    console.log(\u0027    Folder ID:\u0027, folder.id);",
                                                                                    "    pm.environment.set(\u0027egressServedEvidenceFolderId\u0027, folder.id);",
                                                                                    "    pm.execution.setNextRequest(\u00277b. List Files in Folder\u0027);",
                                                                                    "} else {",
                                                                                    "    console.log(\u0027[ERROR] Folder not found:\u0027, targetFolderName);",
                                                                                    "    console.log(\u0027Available folders:\u0027);",
                                                                                    "    allItems.filter(i =\u003e i.isFolder).forEach(f =\u003e console.log(\u0027  -\u0027, f.name, \u0027ID:\u0027, f.id));",
                                                                                    "    pm.test(\u0027Target folder found\u0027, function() {",
                                                                                    "        pm.expect.fail(\u0027Folder \"\u0027 + targetFolderName + \u0027\" not found\u0027);",
                                                                                    "    });",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.test(\u0027Target folder found\u0027, function() {",
                                                                                    "    pm.expect(folder).to.not.be.undefined;",
                                                                                    "});"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/workspaces/{{egressWorkspaceId}}/files?skip=0\u0026take=100",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "skip",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "100"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "7b. List Files in Folder",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "const folderId = pm.environment.get(\u0027egressServedEvidenceFolderId\u0027);",
                                                                                    "console.log(\u0027[7b] Listing files in folder ID:\u0027, folderId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const files = (response.data || []).filter(f =\u003e !f.isFolder);",
                                                                                    "",
                                                                                    "console.log(\u0027=== List Files in Folder (Step 7b) ===\u0027);",
                                                                                    "console.log(\u0027Files found:\u0027, files.length);",
                                                                                    "",
                                                                                    "// Get preset file names from upload script",
                                                                                    "const presetFileNames = pm.environment.get(\u0027egressFileNames\u0027) || \u0027\u0027;",
                                                                                    "const presetFileName = pm.environment.get(\u0027egressFileName\u0027) || \u0027\u0027;",
                                                                                    "let targetNames = [];",
                                                                                    "",
                                                                                    "if (presetFileNames) {",
                                                                                    "    targetNames = presetFileNames.split(\u0027,\u0027).map(s =\u003e s.trim().split(\u0027/\u0027).pop());",
                                                                                    "} else if (presetFileName) {",
                                                                                    "    targetNames = [presetFileName.trim().split(\u0027/\u0027).pop()];",
                                                                                    "}",
                                                                                    "",
                                                                                    "console.log(\u0027[INFO] Looking for files:\u0027, targetNames.join(\u0027, \u0027));",
                                                                                    "",
                                                                                    "// Match files by name and get LCC API IDs",
                                                                                    "let matchedFiles = [];",
                                                                                    "for (const name of targetNames) {",
                                                                                    "    const match = files.find(f =\u003e f.name === name);",
                                                                                    "    if (match) {",
                                                                                    "        matchedFiles.push(match);",
                                                                                    "        console.log(\u0027[MATCH]\u0027, name);",
                                                                                    "        console.log(\u0027    LCC API ID:\u0027, match.id);",
                                                                                    "    } else {",
                                                                                    "        console.log(\u0027[WARN] File not found:\u0027, name);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "if (matchedFiles.length \u003e 0) {",
                                                                                    "    // IMPORTANT: Update with LCC API file IDs",
                                                                                    "    const lccIds = matchedFiles.map(f =\u003e f.id).join(\u0027,\u0027);",
                                                                                    "    const lccNames = matchedFiles.map(f =\u003e f.name).join(\u0027,\u0027);",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027egressFileIds\u0027, lccIds);",
                                                                                    "    pm.environment.set(\u0027egressFileNames\u0027, lccNames);",
                                                                                    "    pm.environment.set(\u0027egressFileId\u0027, matchedFiles[0].id);",
                                                                                    "    pm.environment.set(\u0027egressFileName\u0027, matchedFiles[0].name);",
                                                                                    "    pm.environment.set(\u0027egressFileCount\u0027, matchedFiles.length.toString());",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Updated environment with LCC API file IDs:\u0027);",
                                                                                    "    console.log(\u0027    egressFileIds:\u0027, lccIds);",
                                                                                    "    console.log(\u0027    egressFileCount:\u0027, matchedFiles.length);",
                                                                                    "} else if (files.length \u003e 0) {",
                                                                                    "    // No match by name, use latest files",
                                                                                    "    console.log(\u0027[WARN] No exact name matches, using latest files\u0027);",
                                                                                    "    const sortedFiles = files.sort((a, b) =\u003e new Date(b.dateUpdated) - new Date(a.dateUpdated));",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027egressFileIds\u0027, sortedFiles.map(f =\u003e f.id).join(\u0027,\u0027));",
                                                                                    "    pm.environment.set(\u0027egressFileNames\u0027, sortedFiles.map(f =\u003e f.name).join(\u0027,\u0027));",
                                                                                    "    pm.environment.set(\u0027egressFileId\u0027, sortedFiles[0].id);",
                                                                                    "    pm.environment.set(\u0027egressFileName\u0027, sortedFiles[0].name);",
                                                                                    "    pm.environment.set(\u0027egressFileCount\u0027, sortedFiles.length.toString());",
                                                                                    "} else {",
                                                                                    "    console.log(\u0027[ERROR] No files found in folder!\u0027);",
                                                                                    "}",
                                                                                    "",
                                                                                    "// Clean up",
                                                                                    "pm.environment.unset(\u0027egressServedEvidenceFolderId\u0027);",
                                                                                    "",
                                                                                    "pm.test(\u0027Files found for transfer\u0027, function() {",
                                                                                    "    const fileId = pm.environment.get(\u0027egressFileId\u0027);",
                                                                                    "    pm.expect(fileId).to.be.a(\u0027string\u0027).and.not.empty;",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.execution.setNextRequest(\u00278. Validate Transfer\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/workspaces/{{egressWorkspaceId}}/files?folder-id={{egressServedEvidenceFolderId}}\u0026skip=0\u0026take=100",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "folder-id",
                                                                                    "value":  "{{egressServedEvidenceFolderId}}"
                                                                                },
                                                                                {
                                                                                    "key":  "skip",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "100"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "8. Validate Transfer",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has validation structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027caseId\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027workspaceId\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027files\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027isInvalid\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027validationErrors\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "",
                                                                                    "pm.test(\u0027Transfer is valid\u0027, function() {",
                                                                                    "    pm.expect(response.isInvalid).to.be.false;",
                                                                                    "});",
                                                                                    "",
                                                                                    "console.log(\u0027[INFO] Files to transfer: \u0027 + (response.files ? response.files.length : 0));",
                                                                                    "",
                                                                                    "if (!response.isInvalid) {",
                                                                                    "    console.log(\u0027[OK] Transfer validated\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u00279. Initiate Transfer\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Validation errors:\u0027, response.validationErrors);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Build sourcePaths for VALIDATE endpoint",
                                                                                    "// Format: { fileId, path: FULL_PATH, isFolder: false }",
                                                                                    "let sourcePaths = [];",
                                                                                    "const sourceFolder = pm.environment.get(\u0027egressUploadFolderPath\u0027) || \u00274. Served Evidence/\u0027;",
                                                                                    "",
                                                                                    "const fileCount = parseInt(pm.environment.get(\u0027egressFileCount\u0027) || \u00271\u0027);",
                                                                                    "const fileIds = pm.environment.get(\u0027egressFileIds\u0027) || \u0027\u0027;",
                                                                                    "const fileNames = pm.environment.get(\u0027egressFileNames\u0027) || \u0027\u0027;",
                                                                                    "",
                                                                                    "console.log(\u0027[VALIDATE] Building sourcePaths\u0027);",
                                                                                    "console.log(\u0027  Source folder:\u0027, sourceFolder);",
                                                                                    "",
                                                                                    "if (fileCount \u003e 1 \u0026\u0026 fileIds \u0026\u0026 fileNames) {",
                                                                                    "    const ids = fileIds.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const names = fileNames.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const count = Math.min(fileCount, ids.length, names.length);",
                                                                                    "    ",
                                                                                    "    for (let i = 0; i \u003c count; i++) {",
                                                                                    "        let fileName = names[i];",
                                                                                    "        if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "        const fullPath = sourceFolder + fileName;",
                                                                                    "        ",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: ids[i],",
                                                                                    "            path: fullPath,",
                                                                                    "            isFolder: false",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File\u0027, (i+1) + \u0027:\u0027, fullPath);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    const fileId = pm.environment.get(\u0027egressFileId\u0027) || \u0027\u0027;",
                                                                                    "    let fileName = pm.environment.get(\u0027egressFileName\u0027) || \u0027\u0027;",
                                                                                    "    if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "    ",
                                                                                    "    if (fileId \u0026\u0026 fileName) {",
                                                                                    "        const fullPath = sourceFolder + fileName;",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: fileId,",
                                                                                    "            path: fullPath,",
                                                                                    "            isFolder: false",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File:\u0027, fullPath);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.environment.set(\u0027sourcePathsJson\u0027, JSON.stringify(sourcePaths));",
                                                                                    "console.log(\u0027[DEBUG] sourcePathsJson:\u0027, JSON.stringify(sourcePaths, null, 2));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"transferDirection\": \"EgressToNetApp\",\n    \"transferType\": \"Move\",\n    \"sourcePaths\": {{sourcePathsJson}},\n    \"destinationPath\": \"{{netappMoveFolderPath}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"sourceRootFolderPath\": \"{{egressUploadFolderPath}}\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/files",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "files"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "9. Initiate Transfer",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Generate correlation ID",
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Build sourcePaths for INITIATE endpoint",
                                                                                    "// Format: { fileId, path: FILENAME_ONLY, fullFilePath: FULL_PATH }",
                                                                                    "let sourcePaths = [];",
                                                                                    "const sourceFolder = pm.environment.get(\u0027egressUploadFolderPath\u0027) || \u00274. Served Evidence/\u0027;",
                                                                                    "",
                                                                                    "const fileCount = parseInt(pm.environment.get(\u0027egressFileCount\u0027) || \u00271\u0027);",
                                                                                    "const fileIds = pm.environment.get(\u0027egressFileIds\u0027) || \u0027\u0027;",
                                                                                    "const fileNames = pm.environment.get(\u0027egressFileNames\u0027) || \u0027\u0027;",
                                                                                    "",
                                                                                    "console.log(\u0027[INITIATE] Building sourcePaths\u0027);",
                                                                                    "console.log(\u0027  Source folder:\u0027, sourceFolder);",
                                                                                    "",
                                                                                    "if (fileCount \u003e 1 \u0026\u0026 fileIds \u0026\u0026 fileNames) {",
                                                                                    "    const ids = fileIds.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const names = fileNames.split(\u0027,\u0027).map(s =\u003e s.trim()).filter(s =\u003e s.length \u003e 0);",
                                                                                    "    const count = Math.min(fileCount, ids.length, names.length);",
                                                                                    "    ",
                                                                                    "    for (let i = 0; i \u003c count; i++) {",
                                                                                    "        let fileName = names[i];",
                                                                                    "        if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "        ",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: ids[i],",
                                                                                    "            path: fileName,",
                                                                                    "            fullFilePath: sourceFolder + fileName",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File\u0027, (i+1) + \u0027:\u0027, fileName);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    const fileId = pm.environment.get(\u0027egressFileId\u0027) || \u0027\u0027;",
                                                                                    "    let fileName = pm.environment.get(\u0027egressFileName\u0027) || \u0027\u0027;",
                                                                                    "    if (fileName.includes(\u0027/\u0027)) fileName = fileName.split(\u0027/\u0027).pop();",
                                                                                    "    ",
                                                                                    "    if (fileId \u0026\u0026 fileName) {",
                                                                                    "        sourcePaths.push({",
                                                                                    "            fileId: fileId,",
                                                                                    "            path: fileName,",
                                                                                    "            fullFilePath: sourceFolder + fileName",
                                                                                    "        });",
                                                                                    "        console.log(\u0027  File:\u0027, fileName);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.environment.set(\u0027sourcePathsJson\u0027, JSON.stringify(sourcePaths));",
                                                                                    "console.log(\u0027[DEBUG] sourcePathsJson:\u0027, JSON.stringify(sourcePaths, null, 2));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 202\u0027, function() {",
                                                                                    "    pm.response.to.have.status(202);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has transfer initiation structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027id\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027status\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027createdAt\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.id) {",
                                                                                    "    pm.environment.set(\u0027transferId\u0027, response.id);",
                                                                                    "    pm.environment.set(\u0027transferPollCount\u0027, \u00270\u0027);",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Transfer initiated\u0027);",
                                                                                    "    console.log(\u0027    ID:\u0027, response.id);",
                                                                                    "    console.log(\u0027    Status:\u0027, response.status);",
                                                                                    "    pm.execution.setNextRequest(\u002710. Poll Transfer Status\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to initiate\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"sourcePaths\": {{sourcePathsJson}},\n    \"destinationPath\": \"{{netappMoveFolderPath}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"transferType\": \"Move\",\n    \"transferDirection\": \"EgressToNetApp\",\n    \"sourceRootFolderPath\": \"{{egressUploadFolderPath}}\"\n}"
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/initiate",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "initiate"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "10. Poll Transfer Status",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Add delay between polls",
                                                                                    "const pollCount = parseInt(pm.environment.get(\u0027transferPollCount\u0027) || \u00270\u0027);",
                                                                                    "if (pollCount \u003e 0) {",
                                                                                    "    const waitTime = 2000;",
                                                                                    "    const start = Date.now();",
                                                                                    "    while (Date.now() - start \u003c waitTime) {}",
                                                                                    "}",
                                                                                    "console.log(\u0027Polling status (attempt \u0027 + (pollCount + 1) + \u0027)...\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Handle both 200 and 404 (transfer might not be immediately available)",
                                                                                    "const statusCode = pm.response.code;",
                                                                                    "const pollCount = parseInt(pm.environment.get(\u0027transferPollCount\u0027) || \u00270\u0027);",
                                                                                    "",
                                                                                    "if (statusCode === 404) {",
                                                                                    "    // Transfer not yet available, retry",
                                                                                    "    console.log(\u0027Transfer not found yet (attempt \u0027 + (pollCount + 1) + \u0027), retrying...\u0027);",
                                                                                    "    pm.environment.set(\u0027transferPollCount\u0027, (pollCount + 1).toString());",
                                                                                    "    pm.execution.setNextRequest(\u002710. Poll Transfer Status\u0027);",
                                                                                    "} else if (statusCode === 200) {",
                                                                                    "    pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "        pm.response.to.have.status(200);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    pm.test(\u0027Response has status structure\u0027, function() {",
                                                                                    "        const response = pm.response.json();",
                                                                                    "        pm.expect(response).to.have.property(\u0027status\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    const status = response.status;",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[Poll \u0027 + (pollCount + 1) + \u0027] Status:\u0027, status);",
                                                                                    "    console.log(\u0027    Transfer Type:\u0027, response.transferType);",
                                                                                    "    console.log(\u0027    Direction:\u0027, response.direction);",
                                                                                    "    ",
                                                                                    "    // Log failed items if any",
                                                                                    "    if (response.failedItems \u0026\u0026 response.failedItems.length \u003e 0) {",
                                                                                    "        console.log(\u0027    Failed Items:\u0027);",
                                                                                    "        response.failedItems.forEach(item =\u003e {",
                                                                                    "            console.log(\u0027      - \u0027 + item.sourcePath + \u0027 (\u0027 + item.errorCode + \u0027)\u0027);",
                                                                                    "        });",
                                                                                    "    }",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027transferStatus\u0027, status);",
                                                                                    "    ",
                                                                                    "    // Terminal statuses: Completed, PartiallyCompleted, Failed",
                                                                                    "    // Keep polling for: Initiated, InProgress",
                                                                                    "    if (status === \u0027Completed\u0027 || status === \u0027PartiallyCompleted\u0027 || status === \u0027Failed\u0027) {",
                                                                                    "        console.log(\u0027[DONE] Transfer finished with status:\u0027, status);",
                                                                                    "        ",
                                                                                    "        if (response.completedAt) {",
                                                                                    "            console.log(\u0027    Completed At:\u0027, response.completedAt);",
                                                                                    "        }",
                                                                                    "        ",
                                                                                    "        // FAIL the test if status is not \u0027Completed\u0027",
                                                                                    "        pm.test(\u0027Transfer status is Completed (not PartiallyCompleted or Failed)\u0027, function() {",
                                                                                    "            pm.expect(status).to.equal(\u0027Completed\u0027);",
                                                                                    "        });",
                                                                                    "        ",
                                                                                    "        // Log result",
                                                                                    "        if (status === \u0027Completed\u0027) {",
                                                                                    "            console.log(\u0027[OK] Transfer completed successfully!\u0027);",
                                                                                    "        } else if (status === \u0027PartiallyCompleted\u0027) {",
                                                                                    "            console.log(\u0027[ERROR] Transfer PARTIALLY COMPLETED - some files failed!\u0027);",
                                                                                    "        } else if (status === \u0027Failed\u0027) {",
                                                                                    "            console.log(\u0027[ERROR] Transfer FAILED!\u0027);",
                                                                                    "        }",
                                                                                    "        ",
                                                                                    "        pm.execution.setNextRequest(\u002711. Verify Activity Log\u0027);",
                                                                                    "    } else {",
                                                                                    "        // Still in progress (Initiated or InProgress), continue polling",
                                                                                    "        console.log(\u0027    Transfer in progress, polling again...\u0027);",
                                                                                    "        pm.environment.set(\u0027transferPollCount\u0027, (pollCount + 1).toString());",
                                                                                    "        pm.execution.setNextRequest(\u002710. Poll Transfer Status\u0027);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    pm.test(\u0027Status code is 200 or 404\u0027, function() {",
                                                                                    "        pm.expect(statusCode).to.be.oneOf([200, 404]);",
                                                                                    "    });",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/{{transferId}}/status",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "{{transferId}}",
                                                                               "status"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "11. Verify Activity Log",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Wait for activity log to be recorded",
                                                                                    "const start = Date.now();",
                                                                                    "while (Date.now() - start \u003c 2000) {}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const activities = response.data || [];",
                                                                                    "const transferId = pm.environment.get(\u0027transferId\u0027);",
                                                                                    "",
                                                                                    "console.log(\u0027=== Activity Log Verification ===\u0027);",
                                                                                    "console.log(\u0027Looking for transfer:\u0027, transferId);",
                                                                                    "",
                                                                                    "// Find all activities for this transfer",
                                                                                    "const transferActivities = activities.filter(a =\u003e ",
                                                                                    "    a.details \u0026\u0026 a.details.transferId === transferId",
                                                                                    ");",
                                                                                    "",
                                                                                    "// Find TRANSFER_COMPLETED or TRANSFER_FAILED activity",
                                                                                    "const completedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_COMPLETED\u0027);",
                                                                                    "const failedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_FAILED\u0027);",
                                                                                    "const initiatedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_INITIATED\u0027);",
                                                                                    "",
                                                                                    "// Use completed activity for download, or failed, or initiated as fallback",
                                                                                    "const activityForDownload = completedActivity || failedActivity || initiatedActivity;",
                                                                                    "",
                                                                                    "pm.test(\u0027Transfer activity was logged\u0027, function() {",
                                                                                    "    pm.expect(activityForDownload).to.not.be.undefined;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (activityForDownload) {",
                                                                                    "    // Store activity ID for download",
                                                                                    "    pm.environment.set(\u0027latestActivityId\u0027, activityForDownload.id);",
                                                                                    "    pm.environment.set(\u0027activityId\u0027, activityForDownload.id);",
                                                                                    "    ",
                                                                                    "    const actionType = activityForDownload.actionType || \u0027\u0027;",
                                                                                    "    const details = activityForDownload.details || {};",
                                                                                    "    ",
                                                                                    "    // Extract transfer details",
                                                                                    "    const totalFiles = details.totalFiles || 0;",
                                                                                    "    const transferedFileCount = details.transferedFileCount || 0;",
                                                                                    "    const errorFileCount = details.errorFileCount || 0;",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Transfer activity found:\u0027);",
                                                                                    "    console.log(\u0027    Activity ID:\u0027, activityForDownload.id);",
                                                                                    "    console.log(\u0027    Action Type:\u0027, actionType);",
                                                                                    "    console.log(\u0027    Total Files:\u0027, totalFiles);",
                                                                                    "    console.log(\u0027    Transferred:\u0027, transferedFileCount);",
                                                                                    "    console.log(\u0027    Errors:\u0027, errorFileCount);",
                                                                                    "    console.log(\u0027    Time:\u0027, activityForDownload.createdAt);",
                                                                                    "    ",
                                                                                    "    // Determine actual status based on details (matching UI logic)",
                                                                                    "    let transferStatus = \u0027Unknown\u0027;",
                                                                                    "    if (actionType === \u0027TRANSFER_COMPLETED\u0027 || actionType === \u0027TRANSFER_FAILED\u0027) {",
                                                                                    "        if (!transferedFileCount || transferedFileCount === 0) {",
                                                                                    "            transferStatus = \u0027Failed\u0027;",
                                                                                    "        } else if (totalFiles === transferedFileCount \u0026\u0026 !errorFileCount) {",
                                                                                    "            transferStatus = \u0027Completed\u0027;",
                                                                                    "        } else {",
                                                                                    "            transferStatus = \u0027Completed with errors\u0027;",
                                                                                    "        }",
                                                                                    "    }",
                                                                                    "    ",
                                                                                    "    console.log(\u0027    Status:\u0027, transferStatus);",
                                                                                    "    pm.environment.set(\u0027activityTransferStatus\u0027, transferStatus);",
                                                                                    "    ",
                                                                                    "    // FAIL test if status is not \u0027Completed\u0027",
                                                                                    "    pm.test(\u0027Transfer status is Completed (not Failed or Completed with errors)\u0027, function() {",
                                                                                    "        pm.expect(transferStatus).to.equal(\u0027Completed\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    // Log result",
                                                                                    "    if (transferStatus === \u0027Completed\u0027) {",
                                                                                    "        console.log(\u0027[OK] Transfer completed successfully!\u0027);",
                                                                                    "    } else if (transferStatus === \u0027Failed\u0027) {",
                                                                                    "        console.log(\u0027[ERROR] Transfer FAILED! No files transferred.\u0027);",
                                                                                    "    } else if (transferStatus === \u0027Completed with errors\u0027) {",
                                                                                    "        console.log(\u0027[ERROR] Transfer PARTIALLY COMPLETED! Some files failed.\u0027);",
                                                                                    "        console.log(\u0027    Failed files:\u0027, errorFileCount);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.execution.setNextRequest(\u002712. Download Activity Log\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/logs?caseId={{caseId}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "logs"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "caseId",
                                                                                    "value":  "{{caseId}}"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "12. Download Activity Log",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const transferStatus = pm.environment.get(\u0027activityTransferStatus\u0027) || pm.environment.get(\u0027transferStatus\u0027);",
                                                                                    "",
                                                                                    "console.log(\u0027========================================\u0027);",
                                                                                    "console.log(\u0027  E2E TEST COMPLETE!\u0027);",
                                                                                    "console.log(\u0027========================================\u0027);",
                                                                                    "console.log(\u0027Transfer Status:\u0027, transferStatus);",
                                                                                    "console.log(\u0027Activity Log Downloaded: OK\u0027);",
                                                                                    "",
                                                                                    "// Final status check - fail if not Completed",
                                                                                    "pm.test(\u0027Final transfer status is Completed\u0027, function() {",
                                                                                    "    pm.expect(transferStatus).to.equal(\u0027Completed\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "// Cleanup",
                                                                                    "pm.environment.unset(\u0027transferPollCount\u0027);",
                                                                                    "pm.environment.unset(\u0027activityTransferStatus\u0027);",
                                                                                    "pm.execution.setNextRequest(null);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/{{latestActivityId}}/logs/download",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "{{latestActivityId}}",
                                                                               "logs",
                                                                               "download"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "End-to-end test: Copy file from Egress to NetApp with activity log verification.\n\n## Flow (9 steps)\n1. Get Azure AD Token\n2. Get CMS Auth\n3. Search Case\n4. List Egress Files (gets latest by timestamp)\n5. Validate Transfer\n6. Initiate Transfer\n7. Poll Status (loops until complete)\n8. Verify Activity Log\n9. Download Activity Log\n\n## Response Validation\nEach request validates:\n- HTTP 200 status\n- Required response fields\n- Data structure"
                 },
                 {
                     "name":  "E2E: Netapp to Egress Copy",
                     "item":  [
                                  {
                                      "name":  "1. Get Azure AD Token",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has token structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027access_token\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027token_type\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027expires_in\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.access_token) {",
                                                                                    "    pm.environment.set(\u0027accessToken\u0027, response.access_token);",
                                                                                    "    console.log(\u0027[OK] Azure AD Token obtained\u0027);",
                                                                                    "    console.log(\u0027    Expires in:\u0027, response.expires_in, \u0027seconds\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u00272. Get CMS Auth\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to get token\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "client_id",
                                                                                          "value":  "{{apiClientId}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "scope",
                                                                                          "value":  "api://{{apiClientId}}/user_impersonation"
                                                                                      },
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{azureUsername}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{azurePassword}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "grant_type",
                                                                                          "value":  "password"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "https://login.microsoftonline.com/{{tenantId}}/oauth2/v2.0/token",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "login",
                                                                               "microsoftonline",
                                                                               "com"
                                                                           ],
                                                                  "path":  [
                                                                               "{{tenantId}}",
                                                                               "oauth2",
                                                                               "v2.0",
                                                                               "token"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "2. Get CMS Auth",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has CMS auth structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027Cookies\u0027);",
                                                                                    "    pm.expect(response).to.have.property(\u0027Token\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (response.Cookies) {",
                                                                                    "    const encoded = encodeURIComponent(JSON.stringify(response));",
                                                                                    "    pm.environment.set(\u0027cmsAuth\u0027, encoded);",
                                                                                    "    console.log(\u0027[OK] CMS Auth obtained\u0027);",
                                                                                    "    pm.execution.setNextRequest(\u00273. Register Case\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027Failed to get CMS auth\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}",
                                                                                    "",
                                                                                    " pm.execution.setNextRequest(\u00273. Register Case\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "auth":  {
                                                                   "type":  "noauth"
                                                               },
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/x-www-form-urlencoded"
                                                                     },
                                                                     {
                                                                         "key":  "x-functions-key",
                                                                         "value":  "{{ddeiAccessKey}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "urlencoded",
                                                                   "urlencoded":  [
                                                                                      {
                                                                                          "key":  "username",
                                                                                          "value":  "{{cmsUsername}}"
                                                                                      },
                                                                                      {
                                                                                          "key":  "password",
                                                                                          "value":  "{{cmsPassword}}"
                                                                                      }
                                                                                  ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{ddeiBaseUrl}}/authenticate",
                                                                  "host":  [
                                                                               "{{ddeiBaseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "authenticate"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "3. Register Case",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {\r",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);\r",
                                                                                    "    return v.toString(16);\r",
                                                                                    "});\r",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\"Status code is 200 OK\", function () {\r",
                                                                                    "    pm.response.to.have.status(200);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "var responseBody = pm.response.json();\r",
                                                                                    "\r",
                                                                                    "pm.test(\"caseId is greater than 0\", function () {\r",
                                                                                    "    pm.expect(responseBody.caseId).to.be.above(0);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "pm.test(\"caseId is an integer\", function () {\r",
                                                                                    "    pm.expect(Number.isInteger(responseBody.caseId)).to.be.true;\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "pm.test(\"URN format valid\", function () {\r",
                                                                                    "    const urnPattern = /^\\d{2}[A-Z0-9]{2}\\d{7}$/;\r",
                                                                                    "    pm.expect(responseBody.urn).to.match(urnPattern);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "// Store for subsequent requests\r",
                                                                                    "if (responseBody.caseId) {\r",
                                                                                    "    // Store caseId\r",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);\r",
                                                                                    "    pm.environment.set(\"caseId\", responseBody.caseId);\r",
                                                                                    "    \r",
                                                                                    "    // Store full URN for case search\r",
                                                                                    "    pm.environment.set(\"caseUrn\", responseBody.urn);\r",
                                                                                    "    pm.environment.set(\"caseUrn\", responseBody.urn);\r",
                                                                                    "    \r",
                                                                                    "    // Store defendant surname for search\r",
                                                                                    "    const defendantSurname = pm.environment.get(\"defendantSurname\") || \"Miller\";\r",
                                                                                    "    pm.environment.set(\"searchDefendantName\", defendantSurname);\r",
                                                                                    "    pm.environment.set(\"searchDefendantName\", defendantSurname);\r",
                                                                                    "    \r",
                                                                                    "    console.log(\"=== CASE CREATED ===\");\r",
                                                                                    "    console.log(\"Case ID:\", responseBody.caseId);\r",
                                                                                    "    console.log(\"URN:\", responseBody.urn);\r",
                                                                                    "    console.log(\"Defendant:\", defendantSurname);\r",
                                                                                    "    console.log(\"\");\r",
                                                                                    "    console.log(\"Variables set for next calls:\");\r",
                                                                                    "    console.log(\"  caseId =\", responseBody.caseId);\r",
                                                                                    "    console.log(\"  caseUrn =\", responseBody.urn);\r",
                                                                                    "    console.log(\"  searchDefendantName =\", defendantSurname);\r",
                                                                                    "}\r",
                                                                                    "pm.execution.setNextRequest(\u00274. Search Case\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"urn\": {\r\n        \"policeForce\": \"45\",\r\n        \"policeUnit\": \"EL\",\r\n        \"uniqueRef\": \"{{urnUniqueRef}}\",\r\n        \"year\": 25\r\n    },\r\n    \"registeringAreaId\": 1001,\r\n    \"registeringUnitId\": 2002,\r\n    \"allocatedWcuId\": 2012391,\r\n    \"crest\": \"\",\r\n    \"operationName\": \"\",\r\n    \"courtLocationId\": 0,\r\n    \"courtLocationName\": \"\",\r\n    \"hearingDate\": null,\r\n    \"defendants\": [\r\n        {\r\n            \"isDefendant\": true,\r\n            \"surname\": \"{{egressWorkspaceName}}\",\r\n            \"firstname\": \"\",\r\n            \"companyName\": \"\",\r\n            \"dateOfBirth\": \"1984-05-23\",\r\n            \"gender\": \"M\",\r\n            \"disability\": \"U\",\r\n            \"ethnicity\": \"W1\",\r\n            \"religion\": \"NP\",\r\n            \"type\": \"UN\",\r\n            \"arrestDate\": null,\r\n            \"seriousDangerousOffender\": false,\r\n            \"arrestSummonsNumber\": \"\",\r\n            \"isNotYetCharged\": false,\r\n            \"aliases\": [\r\n                {\r\n                    \"listOrder\": 0,\r\n                    \"surname\": \"McCoy\",\r\n                    \"firstNames\": \"William Archibald\"\r\n                }\r\n            ],\r\n            \"charges\": [\r\n                {\r\n                    \"offenceCode\": \"FI68036\",\r\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\r\n                    \"offenceId\": \"22336\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 0,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"isDefendant\": true,\r\n            \"surname\": \"McGinty\",\r\n            \"firstname\": \"Bunty\",\r\n            \"companyName\": \"\",\r\n            \"dateOfBirth\": \"1969-10-14\",\r\n            \"gender\": \"F\",\r\n            \"disability\": \"U\",\r\n            \"ethnicity\": \"W1\",\r\n            \"religion\": \"NP\",\r\n            \"type\": \"UN\",\r\n            \"arrestDate\": null,\r\n            \"seriousDangerousOffender\": true,\r\n            \"arrestSummonsNumber\": \"ASN1234\",\r\n            \"isNotYetCharged\": false,\r\n            \"aliases\": [],\r\n            \"charges\": [\r\n                {\r\n                    \"offenceCode\": \"FI68036\",\r\n                    \"offenceDescription\": \"Possess a prohibited weapon ( automatic )\",\r\n                    \"offenceId\": \"22336\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 0,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                },\r\n                {\r\n                    \"offenceCode\": \"AL79014\",\r\n                    \"offenceDescription\": \"Sold controlled liquor wholesale to a buyer who will sell or supply it through a trade or business\",\r\n                    \"offenceId\": \"38808\",\r\n                    \"dateFrom\": \"2025-10-01\",\r\n                    \"dateTo\": null,\r\n                    \"comment\": \"\",\r\n                    \"offenceLocation\": {\r\n                        \"addressLine1\": \"\",\r\n                        \"addressLine2\": \"\",\r\n                        \"townCity\": \"\",\r\n                        \"postcode\": \"\"\r\n                    },\r\n                    \"victimIndexId\": 1,\r\n                    \"chargeDetailsSummary\": \"\",\r\n                    \"modeOfTrial\": \"EW\"\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"victims\": [\r\n        {\r\n            \"surname\": \"Jamieson\",\r\n            \"forename\": \"Bongo\",\r\n            \"isVulnerable\": false,\r\n            \"isIntimidated\": false,\r\n            \"isWitness\": false\r\n        },\r\n        {\r\n            \"surname\": \"McDonald\",\r\n            \"forename\": \"Ronaldo\",\r\n            \"isVulnerable\": false,\r\n            \"isIntimidated\": true,\r\n            \"isWitness\": false\r\n        }\r\n    ],\r\n    \"complexity\": \"\",\r\n    \"caseWeight\": \"\",\r\n    \"monitoringCodes\":[\r\n        {\r\n            \"code\": \"ATRY\",\r\n            \"selected\": true\r\n        }\r\n    ],\r\n    \"prosecutorId\": 0,\r\n    \"caseWorker\": \"\",\r\n    \"oicRank\": \"\",\r\n    \"oicSurname\": \"\",\r\n    \"oicFirstnames\": \"\",\r\n    \"oicShoulderNumber\": \"\",\r\n    \"oicPoliceUnit\": \"\"\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{caseApiBaseUrl}}/api/v1/cases",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-cm-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "cases"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/cases\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Correlation-Id: bc838a6f-a337-437f-8e42-4d65469f9798\u0027 \\\r\n--header \u0027Cookie: Cms-Auth-Values=%7B%22Cookies%22%3A%22ASP.NET_SessionId%3Dulpixrfdcvml3za1hdj422og%3B%20UID%3D107546%3B%20WindowID%3DMASTER%3B%20CMSUSER107546%3Dulpixrfdcvml3za1hdj422og%3B%20.CMSAUTH%3DFD05163543BAC665F4B154276A0CE0E5304706EE1D60FD09496CAB70192F9B9794955DEF363D04BEFBF320F354587066E6F4207F6D0D2A6F9F675E0B820107D8934D67E56C3F68794153A3B4B51D52498CB2EF0A81925FADDC9FC8E4F08E87356DF2157547D3742B010297C8EBCA2C15FB41A42519377A312B79BA1A6E42635066B8FF97%3B%20dtCookie%3Dv_4_srv_4_sn_E09DF4A74B6AAC89D762D0DB73BD9B9B_perc_100000_ol_0_mul_1_app-3A1d479dbf707b0c2a_1%3B%20BIGipServer~ent-s221~CPSACP-LTM-CM-WAN-CIN3-cin3.cps.gov.uk_POOL%3Drd1o00000000000000000000ffff0a02a00do80%22%2C%22Token%22%3A%226db92e06-827e-479b-9bf4-c0f5dd0bf721%22%2C%22ExpiryTime%22%3A%222026-01-15T16%3A56%3A29.8514537%2B00%3A00%22%7D\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--data \u0027{\r\n    \"urn\": {\r\n        \"policeForce\": \"45\",\r\n        \"policeUnit\": \"EL\",\r\n        \"uniqueRef\": \"45155\",\r\n        \"year\": 25\r\n    },\r\n    \"registeringAreaId\": 1001,\r\n    \"registeringUnitId\": 2002,\r\n    \"allocatedWcuId\": 2012391,\r\n    \"crest\": \"\",\r\n    \"operationName\": \"\",\r\n    \"courtLocationId\": 0,\r\n    \"courtLocationName\": \"\",\r\n    \"hearingDate\": null,\r\n    \"defendants\": [],\r\n    \"victims\": [],\r\n    \"complexity\": \"\",\r\n    \"caseWeight\": \"\",\r\n    \"monitoringCodes\":[\r\n        {\r\n            \"code\": \"CSEA\",\r\n            \"selected\": true\r\n        }\r\n    ],\r\n    \"prosecutorId\": 0,\r\n    \"caseWorker\": \"\",\r\n    \"oicRank\": \"\",\r\n    \"oicSurname\": \"\",\r\n    \"oicFirstnames\": \"\",\r\n    \"oicShoulderNumber\": \"\",\r\n    \"oicPoliceUnit\": \"\"\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "4. Search Case",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response is array\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.be.an(\u0027array\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "if (Array.isArray(response) \u0026\u0026 response.length \u003e 0) {",
                                                                                    "    pm.test(\u0027Case has required fields\u0027, function() {",
                                                                                    "        const caseData = response[0];",
                                                                                    "        pm.expect(caseData).to.have.property(\u0027caseId\u0027);",
                                                                                    "        pm.expect(caseData).to.have.property(\u0027urn\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    const caseData = response[0];",
                                                                                    "    pm.environment.set(\u0027caseId\u0027, caseData.caseId);",
                                                                                    "    pm.environment.set(\u0027egressWorkspaceId\u0027, caseData.egressWorkspaceId || pm.environment.get(\u0027egressWorkspaceId\u0027));",
                                                                                    "    pm.environment.set(\u0027netappPath\u0027, caseData.netappFolderPath || \u0027Automation-Testing/\u0027);",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Case found:\u0027, caseData.caseId);",
                                                                                    "    console.log(\u0027    URN:\u0027, caseData.urn);",
                                                                                    "    pm.execution.setNextRequest(\u00275. Egress connection\u0027);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027No cases found\u0027);",
                                                                                    "    pm.execution.setNextRequest(null);",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/case-search?urn={{caseUrn}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "case-search"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "urn",
                                                                                    "value":  "{{caseUrn}}"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "5. Egress connection",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00276. Create Netapp Connection\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\r\n    \"caseId\": {{caseId}}\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/connections",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/egress/connections\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027 \\\r\n--data \u0027{\r\n    \"egressWorkspaceId\": \"{{egressWorkspaceId}}\",\r\n    \"caseId\": 2178476\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "6. Create Netapp Connection",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00277. Get Netapp Folders\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\r\n    \"operationName\": \"{{egressWorkspaceName}}\",\r\n    \"folderPath\": \"{{netappFolderPath}}\",\r\n    \"caseId\": {{caseId}}\r\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/connections",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "connections"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/netapp/connections\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027 \\\r\n--data \u0027{\r\n    \"operationName\": \"AUTOMATION-TESTING9\",\r\n    \"folderPath\": \"{{netappFolderPath}}\",\r\n    \"caseId\": 2178476\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "7. Get Netapp Folders",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.execution.setNextRequest(\u00278. List Egress Files\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/folders?operation-name={{egressWorkspaceName}}\u0026path=\u0026take=50\u0026continuation-token=",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "folders"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "operation-name",
                                                                                    "value":  "{{egressWorkspaceName}}"
                                                                                },
                                                                                {
                                                                                    "key":  "path",
                                                                                    "value":  ""
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50"
                                                                                },
                                                                                {
                                                                                    "key":  "continuation-token",
                                                                                    "value":  ""
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/netapp/folders?operation-name=AUTOMATION-TESTING9\u0026path=\u0026take=50\u0026continuation-token=\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Correlation-Id: 885303ba-f706-4deb-82f8-c6fffb072021\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "8. List Egress Files",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const files = (response.data || []).filter(f =\u003e !f.isFolder);",
                                                                                    "",
                                                                                    "console.log(\u0027=== List Egress Files ===\u0027);",
                                                                                    "console.log(\u0027Files found in root:\u0027, files.length);",
                                                                                    "",
                                                                                    "// Check if we have preset file info from upload script",
                                                                                    "const presetFileId = pm.environment.get(\u0027egressFileId\u0027);",
                                                                                    "const presetFileName = pm.environment.get(\u0027egressFileName\u0027);",
                                                                                    "const presetFileIds = pm.environment.get(\u0027egressFileIds\u0027);",
                                                                                    "const presetFileNames = pm.environment.get(\u0027egressFileNames\u0027);",
                                                                                    "const presetFileCount = parseInt(pm.environment.get(\u0027egressFileCount\u0027) || \u00270\u0027);",
                                                                                    "",
                                                                                    "// If we have preset values from upload script, use those",
                                                                                    "if (presetFileId \u0026\u0026 presetFileName) {",
                                                                                    "    console.log(\u0027[OK] Using file info from upload script:\u0027);",
                                                                                    "    console.log(\u0027    File ID:\u0027, presetFileId);",
                                                                                    "    console.log(\u0027    File Name:\u0027, presetFileName);",
                                                                                    "    if (presetFileCount \u003e 1) {",
                                                                                    "        console.log(\u0027    Total Files:\u0027, presetFileCount);",
                                                                                    "        console.log(\u0027    All File IDs:\u0027, presetFileIds);",
                                                                                    "    }",
                                                                                    "    // Values already set, proceed to next step",
                                                                                    "} else if (files.length \u003e 0) {",
                                                                                    "    // No preset values, use files from API response",
                                                                                    "    // Sort by dateUpdated descending to get latest file",
                                                                                    "    const sortedFiles = files.sort((a, b) =\u003e new Date(b.dateUpdated) - new Date(a.dateUpdated));",
                                                                                    "    const latestFile = sortedFiles[0];",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027egressFileId\u0027, latestFile.id);",
                                                                                    "    pm.environment.set(\u0027egressFileName\u0027, latestFile.name);",
                                                                                    "    pm.environment.set(\u0027egressFilePath\u0027, (latestFile.path || \u0027\u0027) + \u0027/\u0027 + latestFile.name);",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Using latest file from API:\u0027);",
                                                                                    "    console.log(\u0027    ID:\u0027, latestFile.id);",
                                                                                    "    console.log(\u0027    Name:\u0027, latestFile.name);",
                                                                                    "    console.log(\u0027    Updated:\u0027, latestFile.dateUpdated);",
                                                                                    "} else {",
                                                                                    "    console.log(\u0027[ERROR] No files found and no preset values!\u0027);",
                                                                                    "    console.log(\u0027Make sure to run the upload script first or set egressFileId/egressFileName\u0027);",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.test(\u0027File info is available\u0027, function() {",
                                                                                    "    const fileId = pm.environment.get(\u0027egressFileId\u0027);",
                                                                                    "    const fileName = pm.environment.get(\u0027egressFileName\u0027);",
                                                                                    "    pm.expect(fileId).to.be.a(\u0027string\u0027).and.not.empty;",
                                                                                    "    pm.expect(fileName).to.be.a(\u0027string\u0027).and.not.empty;",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.execution.setNextRequest(\u00279. List Netapp Files\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/egress/workspaces/{{egressWorkspaceId}}/files?skip=0\u0026take=100",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "egress",
                                                                               "workspaces",
                                                                               "{{egressWorkspaceId}}",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "skip",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "9. List Netapp Files",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = pm.variables.replaceIn(\u0027{{$guid}}\u0027);\r",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);\r",
                                                                                    "\r",
                                                                                    "console.log(\u0027=== LIST NETAPP FILES ===\u0027);\r",
                                                                                    "console.log(\u0027Folder:\u0027, pm.environment.get(\u0027netappFolderPath\u0027));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    const files = response.data?.fileData || [];",
                                                                                    "    ",
                                                                                    "    console.log(\u0027=== NETAPP FILES ===\u0027);",
                                                                                    "    console.log(\u0027Root path:\u0027, response.data?.rootPath);",
                                                                                    "    console.log(\u0027Total files found:\u0027, files.length);",
                                                                                    "    ",
                                                                                    "    // Filter out 0-byte files and sort by lastModified (newest first)",
                                                                                    "    const validFiles = files.filter(f =\u003e f.filesize \u003e 0);",
                                                                                    "    validFiles.sort((a, b) =\u003e new Date(b.lastModified) - new Date(a.lastModified));",
                                                                                    "    ",
                                                                                    "    console.log(\u0027Valid files (non-zero size):\u0027, validFiles.length);",
                                                                                    "    ",
                                                                                    "    if (validFiles.length \u003e 0) {",
                                                                                    "        // Pick the most recent file",
                                                                                    "        const selectedFile = validFiles[0];",
                                                                                    "        const fileName = selectedFile.path.split(\u0027/\u0027).pop();",
                                                                                    "        ",
                                                                                    "        console.log(\u0027\u0027);",
                                                                                    "        console.log(\u0027[SELECTED] Most recent file:\u0027);",
                                                                                    "        console.log(\u0027  Path:\u0027, selectedFile.path);",
                                                                                    "        console.log(\u0027  Name:\u0027, fileName);",
                                                                                    "        console.log(\u0027  Size:\u0027, selectedFile.filesize, \u0027bytes\u0027);",
                                                                                    "        console.log(\u0027  Modified:\u0027, selectedFile.lastModified);",
                                                                                    "        ",
                                                                                    "        // Store for transfer",
                                                                                    "        pm.environment.set(\u0027netappFilePath\u0027, selectedFile.path);",
                                                                                    "        pm.environment.set(\u0027netappFileName\u0027, fileName);",
                                                                                    "        pm.environment.set(\u0027netappFileSize\u0027, selectedFile.filesize);",
                                                                                    "        ",
                                                                                    "        console.log(\u0027\u0027);",
                                                                                    "        console.log(\u0027Ready for NetApp to Egress transfer!\u0027);",
                                                                                    "    } else {",
                                                                                    "        console.error(\u0027[ERROR] No valid files found in NetApp folder!\u0027);",
                                                                                    "        pm.test(\u0027NetApp folder has files\u0027, function() {",
                                                                                    "            pm.expect.fail(\u0027No valid files found\u0027);",
                                                                                    "        });",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.execution.setNextRequest(\u002710. Validate Transfer NetApp to Egress\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/netapp/files?path=Automation-Testing%2F\u0026take=50\u0026continuation-token=",
                                                                  "protocol":  "https",
                                                                  "host":  [
                                                                               "fa-lacc-api-dev",
                                                                               "azurewebsites",
                                                                               "net"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "netapp",
                                                                               "files"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "path",
                                                                                    "value":  "Automation-Testing%2F"
                                                                                },
                                                                                {
                                                                                    "key":  "take",
                                                                                    "value":  "50"
                                                                                },
                                                                                {
                                                                                    "key":  "continuation-token",
                                                                                    "value":  ""
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/netapp/files?path=Automation-Testing%2F\u0026take=50\u0026continuation-token=\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Cookie: Cms-Auth-Values=%7B%22Cookies%22%3A%22ASP.NET_SessionId%3Dx2mjenlx0zvmz4tg0yftxcux%3B%20UID%3D107546%3B%20WindowID%3DMASTER%3B%20CMSUSER107546%3Dx2mjenlx0zvmz4tg0yftxcux%3B%20.CMSAUTH%3D107E2390776ABA0C9B1575A9D1518BE8522F666349079B91CEC36C6A8AC4123821EB05911FCD69524EAE35131ECB2E968A021C48F43DFA26E08CD5401E2A2993D549FB32977A18E1A9939DFBC185C06F3B88E8EC1CB093A65A849F47A59E2FFF2687078A2F983AD00561A3817B942F9381DB78BA6C7A2A64A7F97D29790621CFC81C6837%3B%20dtCookie%3Dv_4_srv_1_sn_ED49F7B0D0864FB49D0315624A846BF7_perc_100000_ol_0_mul_1_app-3A1d479dbf707b0c2a_1_rcs-3Acss_0%3B%20BIGipServer~ent-s221~CPSACP-LTM-CM-WAN-CIN3-cin3.cps.gov.uk_POOL%3Drd1o00000000000000000000ffff0a02a00do80%22%2C%22Token%22%3A%224dd44435-cc3e-4509-9436-72dd794d44fb%22%2C%22ExpiryTime%22%3A%222026-01-20T18%3A51%3A59.9219991%2B00%3A00%22%7D\u0027 \\\r\n--header \u0027Correlation-Id: 6ecc9f0b-2cf9-4b31-9939-057144f82045\u0027 \\\r\n--header \u0027Origin: https://lacc-app-ui-spa-dev.azurewebsites.net\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "10. Validate Transfer NetApp to Egress",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Build sourcePaths for NetApp to Egress VALIDATE",
                                                                                    "const netappFilePath = pm.environment.get(\u0027netappFilePath\u0027) || \u0027\u0027;",
                                                                                    "const netappFolderPath = pm.environment.get(\u0027netappFolderPath\u0027) || \u0027Automation-Testing/\u0027;",
                                                                                    "",
                                                                                    "let sourcePaths = [];",
                                                                                    "",
                                                                                    "if (netappFilePath) {",
                                                                                    "    // Validate just needs path",
                                                                                    "    sourcePaths.push({",
                                                                                    "        path: netappFilePath",
                                                                                    "    });",
                                                                                    "    console.log(\u0027[VALIDATE NetApp-\u003eEgress] Source path:\u0027, netappFilePath);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027[ERROR] No netappFilePath set!\u0027);",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.environment.set(\u0027sourcePathsJson\u0027, JSON.stringify(sourcePaths));",
                                                                                    "console.log(\u0027[DEBUG] sourcePathsJson:\u0027, JSON.stringify(sourcePaths));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {\r",
                                                                                    "    pm.response.to.have.status(200);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "if (pm.response.code === 200) {\r",
                                                                                    "    const response = pm.response.json();\r",
                                                                                    "    \r",
                                                                                    "    console.log(\u0027=== Transfer Validation ===\u0027);\r",
                                                                                    "    console.log(\u0027Valid:\u0027, !response.isInvalid);\r",
                                                                                    "    console.log(\u0027Files:\u0027, response.files?.length || 0);\r",
                                                                                    "    \r",
                                                                                    "    if (response.validationErrors?.length \u003e 0) {\r",
                                                                                    "        console.error(\u0027Errors:\u0027, response.validationErrors);\r",
                                                                                    "    }\r",
                                                                                    "    \r",
                                                                                    "    pm.test(\u0027Transfer is valid\u0027, function() {\r",
                                                                                    "        pm.expect(response.isInvalid).to.be.false;\r",
                                                                                    "    });\r",
                                                                                    "}\r",
                                                                                    "pm.execution.setNextRequest(\u002711. Initiate Transfer (NetApp to Egress)\u0027)"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"transferDirection\": \"NetAppToEgress\",\n    \"transferType\": \"Copy\",\n    \"sourcePaths\": {{sourcePathsJson}},\n    \"destinationPath\": \"{{egressDestinationFolder}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"sourceRootFolderPath\": \"{{netappFolderPath}}\"\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/files",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "files"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/filetransfer/files\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Cookie: Cms-Auth-Values=%7B%22Cookies%22%3A%22ASP.NET_SessionId%3Dx2mjenlx0zvmz4tg0yftxcux%3B%20UID%3D107546%3B%20WindowID%3DMASTER%3B%20CMSUSER107546%3Dx2mjenlx0zvmz4tg0yftxcux%3B%20.CMSAUTH%3D107E2390776ABA0C9B1575A9D1518BE8522F666349079B91CEC36C6A8AC4123821EB05911FCD69524EAE35131ECB2E968A021C48F43DFA26E08CD5401E2A2993D549FB32977A18E1A9939DFBC185C06F3B88E8EC1CB093A65A849F47A59E2FFF2687078A2F983AD00561A3817B942F9381DB78BA6C7A2A64A7F97D29790621CFC81C6837%3B%20dtCookie%3Dv_4_srv_1_sn_ED49F7B0D0864FB49D0315624A846BF7_perc_100000_ol_0_mul_1_app-3A1d479dbf707b0c2a_1_rcs-3Acss_0%3B%20BIGipServer~ent-s221~CPSACP-LTM-CM-WAN-CIN3-cin3.cps.gov.uk_POOL%3Drd1o00000000000000000000ffff0a02a00do80%22%2C%22Token%22%3A%224dd44435-cc3e-4509-9436-72dd794d44fb%22%2C%22ExpiryTime%22%3A%222026-01-20T18%3A51%3A59.9219991%2B00%3A00%22%7D\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Correlation-Id: 6ecc9f0b-2cf9-4b31-9939-057144f82045\u0027 \\\r\n--header \u0027Origin: https://lacc-app-ui-spa-dev.azurewebsites.net\u0027 \\\r\n--data \u0027{\r\n    \"caseId\": 2178698,\r\n    \"transferDirection\": \"EgressToNetApp\",\r\n    \"transferType\": \"Copy\",\r\n    \"sourcePaths\": [\r\n        {\r\n            \"fileId\": \"696f8ba3c8d0267aeb7f80d0\",\r\n            \"path\": \"generated-1GB-2026-01-20-14-04-46.bin\",\r\n            \"isFolder\": false\r\n        }\r\n    ],\r\n    \"destinationPath\": \"{{netappFolderPath}}\",\r\n    \"workspaceId\": \"696f8b7f6c57db45e56a6d1a\",\r\n    \"sourceRootFolderPath\": \"/\"\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "11. Initiate Transfer (NetApp to Egress)",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Build sourcePaths for NetApp to Egress INITIATE",
                                                                                    "const netappFilePath = pm.environment.get(\u0027netappFilePath\u0027) || \u0027\u0027;",
                                                                                    "const netappFileName = pm.environment.get(\u0027netappFileName\u0027) || \u0027\u0027;",
                                                                                    "",
                                                                                    "let sourcePaths = [];",
                                                                                    "",
                                                                                    "if (netappFilePath) {",
                                                                                    "    // Initiate needs path AND relativePath",
                                                                                    "    sourcePaths.push({",
                                                                                    "        path: netappFilePath,",
                                                                                    "        relativePath: netappFileName || netappFilePath.split(\u0027/\u0027).pop()",
                                                                                    "    });",
                                                                                    "    console.log(\u0027[INITIATE NetApp-\u003eEgress] Source path:\u0027, netappFilePath);",
                                                                                    "    console.log(\u0027[INITIATE NetApp-\u003eEgress] Relative path:\u0027, netappFileName);",
                                                                                    "} else {",
                                                                                    "    console.error(\u0027[ERROR] No netappFilePath set!\u0027);",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.environment.set(\u0027sourcePathsJson\u0027, JSON.stringify(sourcePaths));",
                                                                                    "console.log(\u0027[DEBUG] sourcePathsJson:\u0027, JSON.stringify(sourcePaths));"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 202\u0027, function() {\r",
                                                                                    "    pm.response.to.have.status(202);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "pm.test(\u0027Response has transfer initiation structure\u0027, function() {\r",
                                                                                    "    const response = pm.response.json();\r",
                                                                                    "    pm.expect(response).to.have.property(\u0027id\u0027);\r",
                                                                                    "    pm.expect(response).to.have.property(\u0027status\u0027);\r",
                                                                                    "    pm.expect(response).to.have.property(\u0027createdAt\u0027);\r",
                                                                                    "});\r",
                                                                                    "\r",
                                                                                    "const response = pm.response.json();\r",
                                                                                    "if (response.id) {\r",
                                                                                    "    pm.environment.set(\u0027transferId\u0027, response.id);\r",
                                                                                    "    pm.environment.set(\u0027transferPollCount\u0027, \u00270\u0027);\r",
                                                                                    "    \r",
                                                                                    "    console.log(\u0027[OK] Transfer initiated\u0027);\r",
                                                                                    "    console.log(\u0027    ID:\u0027, response.id);\r",
                                                                                    "    console.log(\u0027    Status:\u0027, response.status);\r",
                                                                                    "    pm.execution.setNextRequest(\u002712. Poll Transfer Status\u0027);\r",
                                                                                    "} else {\r",
                                                                                    "    console.error(\u0027Failed to initiate\u0027);\r",
                                                                                    "    pm.execution.setNextRequest(null);\r",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n    \"caseId\": {{caseId}},\n    \"destinationPath\": \"{{egressDestinationFolder}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"sourceRootFolderPath\": \"\",\n    \"sourcePaths\": {{sourcePathsJson}},\n    \"transferType\": \"Copy\",\n    \"transferDirection\": \"NetAppToEgress\"\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/initiate",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "initiate"
                                                                           ]
                                                              },
                                                      "description":  "Generated from cURL: curl --location \u0027{{baseUrl}}/api/v1/filetransfer/initiate\u0027 \\\r\n--header \u0027Authorization: Bearer {{accessToken}}\u0027 \\\r\n--header \u0027Accept: */*\u0027 \\\r\n--header \u0027Content-Type: application/json\u0027 \\\r\n--header \u0027Cookie: Cms-Auth-Values=%7B%22Cookies%22%3A%22ASP.NET_SessionId%3Dx2mjenlx0zvmz4tg0yftxcux%3B%20UID%3D107546%3B%20WindowID%3DMASTER%3B%20CMSUSER107546%3Dx2mjenlx0zvmz4tg0yftxcux%3B%20.CMSAUTH%3D107E2390776ABA0C9B1575A9D1518BE8522F666349079B91CEC36C6A8AC4123821EB05911FCD69524EAE35131ECB2E968A021C48F43DFA26E08CD5401E2A2993D549FB32977A18E1A9939DFBC185C06F3B88E8EC1CB093A65A849F47A59E2FFF2687078A2F983AD00561A3817B942F9381DB78BA6C7A2A64A7F97D29790621CFC81C6837%3B%20dtCookie%3Dv_4_srv_1_sn_ED49F7B0D0864FB49D0315624A846BF7_perc_100000_ol_0_mul_1_app-3A1d479dbf707b0c2a_1_rcs-3Acss_0%3B%20BIGipServer~ent-s221~CPSACP-LTM-CM-WAN-CIN3-cin3.cps.gov.uk_POOL%3Drd1o00000000000000000000ffff0a02a00do80%22%2C%22Token%22%3A%224dd44435-cc3e-4509-9436-72dd794d44fb%22%2C%22ExpiryTime%22%3A%222026-01-20T18%3A51%3A59.9219991%2B00%3A00%22%7D\u0027 \\\r\n--header \u0027Correlation-Id: 6ecc9f0b-2cf9-4b31-9939-057144f82045\u0027 \\\r\n--header \u0027Origin: https://lacc-app-ui-spa-dev.azurewebsites.net\u0027 \\\r\n--data \u0027{\r\n    \"caseId\": 2178698,\r\n    \"transferDirection\": \"NetAppToEgress\",\r\n    \"transferType\": \"Copy\",\r\n    \"sourcePaths\": [\r\n        {\r\n            \"path\": \"\"\r\n        }\r\n    ],\r\n    \"destinationPath\": \"{{egressUploadFolderPath}}\",\r\n    \"workspaceId\": \"696f8b7f6c57db45e56a6d1a\",\r\n    \"sourceRootFolderPath\": \"{{netappFolderPath}}\"\r\n}\u0027"
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "12. Poll Transfer Status",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Add delay between polls",
                                                                                    "const pollCount = parseInt(pm.environment.get(\u0027transferPollCount\u0027) || \u00270\u0027);",
                                                                                    "if (pollCount \u003e 0) {",
                                                                                    "    const waitTime = 2000;",
                                                                                    "    const start = Date.now();",
                                                                                    "    while (Date.now() - start \u003c waitTime) {}",
                                                                                    "}",
                                                                                    "console.log(\u0027Polling status (attempt \u0027 + (pollCount + 1) + \u0027)...\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "// Handle both 200 and 404 (transfer might not be immediately available)",
                                                                                    "const statusCode = pm.response.code;",
                                                                                    "const pollCount = parseInt(pm.environment.get(\u0027transferPollCount\u0027) || \u00270\u0027);",
                                                                                    "",
                                                                                    "if (statusCode === 404) {",
                                                                                    "    // Transfer not yet available, retry",
                                                                                    "    console.log(\u0027Transfer not found yet (attempt \u0027 + (pollCount + 1) + \u0027), retrying...\u0027);",
                                                                                    "    pm.environment.set(\u0027transferPollCount\u0027, (pollCount + 1).toString());",
                                                                                    "    pm.execution.setNextRequest(\u002712. Poll Transfer Status\u0027);",
                                                                                    "} else if (statusCode === 200) {",
                                                                                    "    pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "        pm.response.to.have.status(200);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    pm.test(\u0027Response has status structure\u0027, function() {",
                                                                                    "        const response = pm.response.json();",
                                                                                    "        pm.expect(response).to.have.property(\u0027id\u0027);",
                                                                                    "        pm.expect(response).to.have.property(\u0027status\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    const status = response.status;",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[Poll \u0027 + (pollCount + 1) + \u0027] Status:\u0027, status);",
                                                                                    "    console.log(\u0027    Progress:\u0027, (response.completedFilesCount || 0) + \u0027/\u0027 + (response.totalFilesCount || 0), \u0027files\u0027);",
                                                                                    "    ",
                                                                                    "    // Log individual file statuses if available",
                                                                                    "    if (response.fileStatuses \u0026\u0026 response.fileStatuses.length \u003e 0) {",
                                                                                    "        response.fileStatuses.forEach(file =\u003e {",
                                                                                    "            if (file.status === \u0027Failed\u0027 || file.status === \u0027Error\u0027) {",
                                                                                    "                console.log(\u0027    [FAILED] \u0027 + file.fileName + \u0027: \u0027 + (file.errorCode || \u0027Unknown error\u0027));",
                                                                                    "            }",
                                                                                    "        });",
                                                                                    "    }",
                                                                                    "    ",
                                                                                    "    pm.environment.set(\u0027transferStatus\u0027, status);",
                                                                                    "    ",
                                                                                    "    // Check for terminal status: Completed, PartiallyCompleted, or Failed",
                                                                                    "    if (status === \u0027Completed\u0027 || status === \u0027PartiallyCompleted\u0027 || status === \u0027Failed\u0027) {",
                                                                                    "        console.log(\u0027[DONE] Transfer finished with status:\u0027, status);",
                                                                                    "        ",
                                                                                    "        // FAIL THE TEST if transfer status is Failed",
                                                                                    "        pm.test(\u0027Transfer status is not Failed\u0027, function() {",
                                                                                    "            pm.expect(status).to.not.equal(\u0027Failed\u0027);",
                                                                                    "        });",
                                                                                    "        ",
                                                                                    "        pm.execution.setNextRequest(\u002713. Verify Activity Log\u0027);",
                                                                                    "    } else {",
                                                                                    "        // Still in progress, continue polling",
                                                                                    "        pm.environment.set(\u0027transferPollCount\u0027, (pollCount + 1).toString());",
                                                                                    "        pm.execution.setNextRequest(\u002712. Poll Transfer Status\u0027);",
                                                                                    "    }",
                                                                                    "} else {",
                                                                                    "    pm.test(\u0027Status code is 200 or 404\u0027, function() {",
                                                                                    "        pm.expect(statusCode).to.be.oneOf([200, 404]);",
                                                                                    "    });",
                                                                                    "}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/filetransfer/{{transferId}}/status",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "filetransfer",
                                                                               "{{transferId}}",
                                                                               "status"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "13. Verify Activity Log",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                                                    "",
                                                                                    "// Wait for activity log to be recorded",
                                                                                    "const start = Date.now();",
                                                                                    "while (Date.now() - start \u003c 2000) {}"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "pm.test(\u0027Response has correct structure\u0027, function() {",
                                                                                    "    const response = pm.response.json();",
                                                                                    "    pm.expect(response).to.have.property(\u0027data\u0027);",
                                                                                    "});",
                                                                                    "",
                                                                                    "const response = pm.response.json();",
                                                                                    "const activities = response.data || [];",
                                                                                    "const transferId = pm.environment.get(\u0027transferId\u0027);",
                                                                                    "",
                                                                                    "console.log(\u0027=== Activity Log Verification ===\u0027);",
                                                                                    "console.log(\u0027Looking for transfer:\u0027, transferId);",
                                                                                    "",
                                                                                    "// Find all activities for this transfer",
                                                                                    "const transferActivities = activities.filter(a =\u003e ",
                                                                                    "    a.details \u0026\u0026 a.details.transferId === transferId",
                                                                                    ");",
                                                                                    "",
                                                                                    "// Find TRANSFER_COMPLETED or TRANSFER_FAILED activity",
                                                                                    "const completedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_COMPLETED\u0027);",
                                                                                    "const failedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_FAILED\u0027);",
                                                                                    "const initiatedActivity = transferActivities.find(a =\u003e a.actionType === \u0027TRANSFER_INITIATED\u0027);",
                                                                                    "",
                                                                                    "// Use completed activity for download, or failed, or initiated as fallback",
                                                                                    "const activityForDownload = completedActivity || failedActivity || initiatedActivity;",
                                                                                    "",
                                                                                    "pm.test(\u0027Transfer activity was logged\u0027, function() {",
                                                                                    "    pm.expect(activityForDownload).to.not.be.undefined;",
                                                                                    "});",
                                                                                    "",
                                                                                    "if (activityForDownload) {",
                                                                                    "    // Store activity ID for download",
                                                                                    "    pm.environment.set(\u0027latestActivityId\u0027, activityForDownload.id);",
                                                                                    "    pm.environment.set(\u0027activityId\u0027, activityForDownload.id);",
                                                                                    "    ",
                                                                                    "    const actionType = activityForDownload.actionType || \u0027\u0027;",
                                                                                    "    ",
                                                                                    "    console.log(\u0027[OK] Transfer activity found:\u0027);",
                                                                                    "    console.log(\u0027    Activity ID:\u0027, activityForDownload.id);",
                                                                                    "    console.log(\u0027    Action Type:\u0027, actionType);",
                                                                                    "    console.log(\u0027    Time:\u0027, activityForDownload.createdAt);",
                                                                                    "    ",
                                                                                    "    // Get all action types for this transfer",
                                                                                    "    const allActions = transferActivities.map(a =\u003e a.actionType);",
                                                                                    "    console.log(\u0027    Actions logged:\u0027, allActions.join(\u0027, \u0027));",
                                                                                    "    ",
                                                                                    "    // FAIL test if actionType is TRANSFER_FAILED",
                                                                                    "    pm.test(\u0027Transfer did not fail (actionType !== TRANSFER_FAILED)\u0027, function() {",
                                                                                    "        pm.expect(actionType).to.not.equal(\u0027TRANSFER_FAILED\u0027);",
                                                                                    "    });",
                                                                                    "    ",
                                                                                    "    // Log status",
                                                                                    "    if (actionType === \u0027TRANSFER_COMPLETED\u0027) {",
                                                                                    "        console.log(\u0027[OK] Transfer completed successfully!\u0027);",
                                                                                    "    } else if (actionType === \u0027TRANSFER_FAILED\u0027) {",
                                                                                    "        console.log(\u0027[ERROR] Transfer FAILED!\u0027);",
                                                                                    "    } else {",
                                                                                    "        console.log(\u0027[INFO] Transfer actionType:\u0027, actionType);",
                                                                                    "    }",
                                                                                    "}",
                                                                                    "",
                                                                                    "pm.execution.setNextRequest(\u002714. Download Activity Log\u0027);"
                                                                                ],
                                                                       "type":  "text/javascript",
                                                                       "packages":  {

                                                                                    },
                                                                       "requests":  {

                                                                                    }
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/logs?caseId={{caseId}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "logs"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "caseId",
                                                                                    "value":  "{{caseId}}"
                                                                                }
                                                                            ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  },
                                  {
                                      "name":  "14. Download Activity Log",
                                      "event":  [
                                                    {
                                                        "listen":  "prerequest",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                                    "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                                    "    return v.toString(16);",
                                                                                    "});",
                                                                                    "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    },
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "exec":  [
                                                                                    "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                                    "    pm.response.to.have.status(200);",
                                                                                    "});",
                                                                                    "",
                                                                                    "console.log(\u0027========================================\u0027);",
                                                                                    "console.log(\u0027  E2E TEST COMPLETE!\u0027);",
                                                                                    "console.log(\u0027========================================\u0027);",
                                                                                    "console.log(\u0027Transfer Status:\u0027, pm.environment.get(\u0027transferStatus\u0027));",
                                                                                    "console.log(\u0027Activity Log Downloaded: OK\u0027);",
                                                                                    "",
                                                                                    "// Cleanup",
                                                                                    "pm.environment.unset(\u0027transferPollCount\u0027);",
                                                                                    "pm.execution.setNextRequest(null);"
                                                                                ],
                                                                       "type":  "text/javascript"
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Accept",
                                                                         "value":  "*/*"
                                                                     },
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{accessToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Cookie",
                                                                         "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                                     },
                                                                     {
                                                                         "key":  "Correlation-Id",
                                                                         "value":  "{{correlationId}}"
                                                                     },
                                                                     {
                                                                         "key":  "Origin",
                                                                         "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/api/v1/activity/{{latestActivityId}}/logs/download",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "api",
                                                                               "v1",
                                                                               "activity",
                                                                               "{{latestActivityId}}",
                                                                               "logs",
                                                                               "download"
                                                                           ]
                                                              }
                                                  },
                                      "response":  [

                                                   ]
                                  }
                              ],
                     "description":  "End-to-end test: Copy file from Egress to NetApp with activity log verification.\n\n## Flow (9 steps)\n\n1. Get Azure AD Token\n    \n2. Get CMS Auth\n    \n3. Search Case\n    \n4. List Egress Files (gets latest by timestamp)\n    \n5. Validate Transfer\n    \n6. Initiate Transfer\n    \n7. Poll Status (loops until complete)\n    \n8. Verify Activity Log\n    \n9. Download Activity Log\n    \n\n## Response Validation\n\nEach request validates:\n\n- HTTP 200 status\n    \n- Required response fields\n    \n- Data structure"
                 },
                 {
                     "name":  "8. Validate Transfer",
                     "event":  [
                                   {
                                       "listen":  "prerequest",
                                       "script":  {
                                                      "exec":  [
                                                                   "const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                                   "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                                   "    return v.toString(16);",
                                                                   "});",
                                                                   "pm.environment.set(\u0027correlationId\u0027, correlationId);"
                                                               ],
                                                      "type":  "text/javascript",
                                                      "packages":  {

                                                                   },
                                                      "requests":  {

                                                                   }
                                                  }
                                   },
                                   {
                                       "listen":  "test",
                                       "script":  {
                                                      "exec":  [
                                                                   "pm.test(\u0027Status code is 200\u0027, function() {",
                                                                   "    pm.response.to.have.status(200);",
                                                                   "});",
                                                                   "",
                                                                   "pm.test(\u0027Response has validation structure\u0027, function() {",
                                                                   "    const response = pm.response.json();",
                                                                   "    pm.expect(response).to.have.property(\u0027caseId\u0027);",
                                                                   "    pm.expect(response).to.have.property(\u0027workspaceId\u0027);",
                                                                   "    pm.expect(response).to.have.property(\u0027files\u0027);",
                                                                   "    pm.expect(response).to.have.property(\u0027isInvalid\u0027);",
                                                                   "    pm.expect(response).to.have.property(\u0027validationErrors\u0027);",
                                                                   "});",
                                                                   "",
                                                                   "const response = pm.response.json();",
                                                                   "",
                                                                   "pm.test(\u0027Transfer is valid\u0027, function() {",
                                                                   "    pm.expect(response.isInvalid).to.be.false;",
                                                                   "});",
                                                                   "",
                                                                   "if (!response.isInvalid) {",
                                                                   "    console.log(\u0027[OK] Transfer validated\u0027);",
                                                                   "    pm.execution.setNextRequest(\u00279. Initiate Transfer\u0027);",
                                                                   "} else {",
                                                                   "    console.error(\u0027Validation errors:\u0027, response.validationErrors);",
                                                                   "    pm.execution.setNextRequest(null);",
                                                                   "}"
                                                               ],
                                                      "type":  "text/javascript",
                                                      "packages":  {

                                                                   },
                                                      "requests":  {

                                                                   }
                                                  }
                                   }
                               ],
                     "request":  {
                                     "method":  "POST",
                                     "header":  [
                                                    {
                                                        "key":  "Accept",
                                                        "value":  "*/*"
                                                    },
                                                    {
                                                        "key":  "Authorization",
                                                        "value":  "Bearer {{accessToken}}"
                                                    },
                                                    {
                                                        "key":  "Cookie",
                                                        "value":  "Cms-Auth-Values={{cmsAuth}}"
                                                    },
                                                    {
                                                        "key":  "Content-Type",
                                                        "value":  "application/json"
                                                    },
                                                    {
                                                        "key":  "Correlation-Id",
                                                        "value":  "{{correlationId}}"
                                                    },
                                                    {
                                                        "key":  "Origin",
                                                        "value":  "https://lacc-app-ui-spa-dev.azurewebsites.net"
                                                    }
                                                ],
                                     "body":  {
                                                  "mode":  "raw",
                                                  "raw":  "{\n    \"caseId\": {{caseId}},\n    \"transferDirection\": \"EgressToNetApp\",\n    \"transferType\": \"Copy\",\n    \"sourcePaths\": [\n        {\n            \"fileId\": \"{{egressFileId}}\",\n            \"path\": \"{{egressFileName}}\",\n            \"isFolder\": false\n        }\n    ],\n    \"destinationPath\": \"{{netappFolderPath}}\",\n    \"workspaceId\": \"{{egressWorkspaceId}}\",\n    \"sourceRootFolderPath\": \"/\"\n}"
                                              },
                                     "url":  {
                                                 "raw":  "{{baseUrl}}/api/v1/filetransfer/files",
                                                 "host":  [
                                                              "{{baseUrl}}"
                                                          ],
                                                 "path":  [
                                                              "api",
                                                              "v1",
                                                              "filetransfer",
                                                              "files"
                                                          ]
                                             }
                                 },
                     "response":  [

                                  ]
                 }
             ],
    "auth":  {
                 "type":  "bearer",
                 "bearer":  [
                                {
                                    "key":  "token",
                                    "value":  "{{accessToken}}",
                                    "type":  "string"
                                }
                            ]
             },
    "event":  [
                  {
                      "listen":  "prerequest",
                      "script":  {
                                     "type":  "text/javascript",
                                     "requests":  {

                                                  },
                                     "exec":  [
                                                  "/**",
                                                  " * Collection-level Pre-Request Script",
                                                  " * ",
                                                  " * Automatic authentication:",
                                                  " * 1. Azure AD Token - ROPC flow (user_impersonation)",
                                                  " * 2. CMS Auth - DDEI /authenticate endpoint",
                                                  " * 3. Variable generation",
                                                  " */",
                                                  "",
                                                  "(function () {",
                                                  "  const vars = pm.variables;",
                                                  "  // collVars removed - using pm.environment only",
                                                  "",
                                                  "  // ============================================",
                                                  "  // PART 1: Azure AD Token (ROPC Flow)",
                                                  "  // ============================================",
                                                  "  console.log(\u0027=== Azure AD Token (ROPC) ===\u0027);",
                                                  "  ",
                                                  "  const tenantId = vars.get(\u0027tenantId\u0027);",
                                                  "  const uiClientId = vars.get(\u0027uiClientId\u0027);",
                                                  "  const apiClientId = vars.get(\u0027apiClientId\u0027);",
                                                  "  const azureUsername = vars.get(\u0027azureUsername\u0027);",
                                                  "  const azurePassword = vars.get(\u0027azurePassword\u0027);",
                                                  "",
                                                  "  const missingAadVars = [];",
                                                  "  if (!tenantId) missingAadVars.push(\u0027tenantId\u0027);",
                                                  "  if (!uiClientId) missingAadVars.push(\u0027uiClientId\u0027);",
                                                  "  if (!apiClientId) missingAadVars.push(\u0027apiClientId\u0027);",
                                                  "  if (!azureUsername) missingAadVars.push(\u0027azureUsername\u0027);",
                                                  "  if (!azurePassword) missingAadVars.push(\u0027azurePassword\u0027);",
                                                  "",
                                                  "  if (missingAadVars.length \u003e 0) {",
                                                  "    console.log(\u0027[AAD] Skipping - missing: \u0027 + missingAadVars.join(\u0027, \u0027));",
                                                  "  } else {",
                                                  "    const now = Date.now();",
                                                  "    const expiry = parseInt(pm.environment.get(\u0027accessTokenExpiry\u0027) || \u00270\u0027);",
                                                  "    ",
                                                  "    // Refresh if expired or expiring in 60 seconds",
                                                  "    if (!expiry || now \u003e= expiry - 60000) {",
                                                  "      console.log(\u0027[AAD] Requesting token via ROPC...\u0027);",
                                                  "      const tokenUrl = \u0027https://login.microsoftonline.com/\u0027 + tenantId + \u0027/oauth2/v2.0/token\u0027;",
                                                  "      const scope = \u0027api://\u0027 + apiClientId + \u0027/user_impersonation\u0027;",
                                                  "",
                                                  "      pm.sendRequest({",
                                                  "        url: tokenUrl,",
                                                  "        method: \u0027POST\u0027,",
                                                  "        header: { \u0027Content-Type\u0027: \u0027application/x-www-form-urlencoded\u0027 },",
                                                  "        body: {",
                                                  "          mode: \u0027urlencoded\u0027,",
                                                  "          urlencoded: [",
                                                  "            { key: \u0027client_id\u0027, value: uiClientId },",
                                                  "            { key: \u0027scope\u0027, value: scope },",
                                                  "            { key: \u0027username\u0027, value: azureUsername },",
                                                  "            { key: \u0027password\u0027, value: azurePassword },",
                                                  "            { key: \u0027grant_type\u0027, value: \u0027password\u0027 }",
                                                  "          ]",
                                                  "        }",
                                                  "      }, function (err, res) {",
                                                  "        if (err) {",
                                                  "          console.error(\u0027[AAD] Request failed: \u0027 + err);",
                                                  "          return;",
                                                  "        }",
                                                  "        ",
                                                  "        let json;",
                                                  "        try {",
                                                  "          json = res.json();",
                                                  "        } catch (e) {",
                                                  "          console.error(\u0027[AAD] Failed to parse response\u0027);",
                                                  "          return;",
                                                  "        }",
                                                  "        ",
                                                  "        if (json.error) {",
                                                  "          console.error(\u0027[AAD] Error: \u0027 + json.error + \u0027 - \u0027 + (json.error_description || \u0027\u0027));",
                                                  "          return;",
                                                  "        }",
                                                  "        ",
                                                  "        const accessToken = json.access_token;",
                                                  "        const expiresIn = Number(json.expires_in);",
                                                  "        ",
                                                  "        if (accessToken) {",
                                                  "          pm.environment.set(\u0027accessToken\u0027, accessToken);",
                                                  "          pm.environment.set(\u0027bearerToken\u0027, accessToken);",
                                                  "          pm.environment.set(\u0027accessTokenExpiry\u0027, String(now + (expiresIn * 1000)));",
                                                  "          console.log(\u0027[AAD] Token obtained (expires in \u0027 + expiresIn + \u0027s)\u0027);",
                                                  "        }",
                                                  "      });",
                                                  "    } else {",
                                                  "      console.log(\u0027[AAD] Using cached token\u0027);",
                                                  "    }",
                                                  "  }",
                                                  "",
                                                  "  // ============================================",
                                                  "  // PART 2: CMS Authentication via DDEI",
                                                  "  // ============================================",
                                                  "  console.log(\u0027=== CMS Authentication (DDEI) ===\u0027);",
                                                  "  ",
                                                  "  const ddeiBaseUrl = vars.get(\u0027ddeiBaseUrl\u0027);",
                                                  "  const ddeiAccessKey = vars.get(\u0027ddeiAccessKey\u0027);",
                                                  "  const cmsUsername = vars.get(\u0027cmsUsername\u0027);",
                                                  "  const cmsPassword = vars.get(\u0027cmsPassword\u0027);",
                                                  "",
                                                  "  const missingCmsVars = [];",
                                                  "  if (!ddeiBaseUrl) missingCmsVars.push(\u0027ddeiBaseUrl\u0027);",
                                                  "  if (!ddeiAccessKey) missingCmsVars.push(\u0027ddeiAccessKey\u0027);",
                                                  "  if (!cmsUsername) missingCmsVars.push(\u0027cmsUsername\u0027);",
                                                  "  if (!cmsPassword) missingCmsVars.push(\u0027cmsPassword\u0027);",
                                                  "",
                                                  "  if (missingCmsVars.length \u003e 0) {",
                                                  "    console.log(\u0027[CMS] Skipping - missing: \u0027 + missingCmsVars.join(\u0027, \u0027));",
                                                  "  } else {",
                                                  "    // Check if CMS auth is still valid (has Token)",
                                                  "    const existingAuth = pm.environment.get(\u0027cmsAuth\u0027);",
                                                  "    const cmsExpiry = parseInt(pm.environment.get(\u0027cmsAuthExpiry\u0027) || \u00270\u0027);",
                                                  "    const now = Date.now();",
                                                  "    ",
                                                  "    if (existingAuth \u0026\u0026 cmsExpiry \u0026\u0026 now \u003c cmsExpiry - 60000) {",
                                                  "      console.log(\u0027[CMS] Using cached auth\u0027);",
                                                  "    } else {",
                                                  "      console.log(\u0027[CMS] Authenticating via DDEI...\u0027);",
                                                  "      const authUrl = ddeiBaseUrl + \u0027/authenticate\u0027;",
                                                  "",
                                                  "      pm.sendRequest({",
                                                  "        url: authUrl,",
                                                  "        method: \u0027POST\u0027,",
                                                  "        header: {",
                                                  "          \u0027Content-Type\u0027: \u0027application/x-www-form-urlencoded\u0027,",
                                                  "          \u0027x-functions-key\u0027: ddeiAccessKey",
                                                  "        },",
                                                  "        body: {",
                                                  "          mode: \u0027urlencoded\u0027,",
                                                  "          urlencoded: [",
                                                  "            { key: \u0027username\u0027, value: cmsUsername },",
                                                  "            { key: \u0027password\u0027, value: cmsPassword }",
                                                  "          ]",
                                                  "        }",
                                                  "      }, function (err, res) {",
                                                  "        if (err) {",
                                                  "          console.error(\u0027[CMS] Auth failed: \u0027 + err);",
                                                  "          return;",
                                                  "        }",
                                                  "        ",
                                                  "        if (res.code \u003e= 400) {",
                                                  "          console.error(\u0027[CMS] Auth failed with status \u0027 + res.code);",
                                                  "          return;",
                                                  "        }",
                                                  "        ",
                                                  "        let json;",
                                                  "        try {",
                                                  "          json = res.json();",
                                                  "        } catch (e) {",
                                                  "          console.error(\u0027[CMS] Failed to parse response\u0027);",
                                                  "          return;",
                                                  "        }",
                                                  "        ",
                                                  "        if (json \u0026\u0026 json.Cookies) {",
                                                  "          const compactJson = JSON.stringify(json);",
                                                  "          const encoded = encodeURIComponent(compactJson);",
                                                  "          ",
                                                  "          pm.environment.set(\u0027cmsAuth\u0027, encoded);",
                                                  "          pm.environment.set(\u0027cmsAuthValues\u0027, encoded);",
                                                  "          ",
                                                  "          // Set expiry (default 20 minutes if not provided)",
                                                  "          if (json.ExpiryTime) {",
                                                  "            const expiryTime = new Date(json.ExpiryTime).getTime();",
                                                  "            pm.environment.set(\u0027cmsAuthExpiry\u0027, String(expiryTime));",
                                                  "          } else {",
                                                  "            pm.environment.set(\u0027cmsAuthExpiry\u0027, String(now + 20 * 60 * 1000));",
                                                  "          }",
                                                  "          ",
                                                  "          console.log(\u0027[CMS] Authentication successful\u0027);",
                                                  "        }",
                                                  "      });",
                                                  "    }",
                                                  "  }",
                                                  "",
                                                  "  // ============================================",
                                                  "  // PART 3: Generate Request Variables",
                                                  "  // ============================================",
                                                  "  console.log(\u0027=== Request Variables ===\u0027);",
                                                  "  ",
                                                  "  // Generate correlation ID",
                                                  "  const correlationId = \u0027xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\u0027.replace(/[xy]/g, function(c) {",
                                                  "    var r = Math.random() * 16 | 0, v = c == \u0027x\u0027 ? r : (r \u0026 0x3 | 0x8);",
                                                  "    return v.toString(16);",
                                                  "  });",
                                                  "  pm.environment.set(\u0027correlationId\u0027, correlationId);",
                                                  "  ",
                                                  "  // Generate dates",
                                                  "  const today = new Date();",
                                                  "  const tomorrow = new Date(today);",
                                                  "  tomorrow.setDate(tomorrow.getDate() + 1);",
                                                  "  ",
                                                  "  pm.environment.set(\u0027today\u0027, today.toISOString().split(\u0027T\u0027)[0]);",
                                                  "  pm.environment.set(\u0027tomorrow\u0027, tomorrow.toISOString().split(\u0027T\u0027)[0]);",
                                                  "  ",
                                                  "  // Generate unique URN reference",
                                                  "  const uniqueRef = String(Math.floor(10000 + Math.random() * 90000));",
                                                  "  pm.environment.set(\u0027urnUniqueRef\u0027, uniqueRef);",
                                                  "  ",
                                                  "  console.log(\u0027[VAR] correlationId: \u0027 + correlationId);",
                                                  "  console.log(\u0027=== Pre-Request Complete ===\u0027);",
                                                  "",
                                                  "})();"
                                              ]
                                 }
                  },
                  {
                      "listen":  "test",
                      "script":  {
                                     "type":  "text/javascript",
                                     "requests":  {

                                                  },
                                     "exec":  [
                                                  "// Collection-level tests"
                                              ]
                                 }
                  }
              ]}
