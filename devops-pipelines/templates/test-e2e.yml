parameters:
  workingDir: 'ui-spa'
  runE2ECommand: ''

steps:   
  - task: Npm@1
    displayName: 'Install Playwright Browsers'
    inputs:
      command: 'custom'
      customCommand: 'exec playwright install --with-deps'
      workingDir: ${{ parameters.workingDir }}
    continueOnError: true

  - task: Npm@1
    displayName: 'Run E2E Tests'
    inputs:
      command: 'custom'
      customCommand: ${{ parameters.runE2ECommand }}
      workingDir: ${{ parameters.workingDir }}
    continueOnError: true

  - task: PublishTestResults@2
    displayName: 'Publish E2E Test Results'
    inputs:
      testResultsFormat: 'JUnit'
      testResultsFiles: '${{ parameters.workingDir }}/playwright/test-results/junit.xml'
      publishRunAttachments: true

  - task: PublishBuildArtifacts@1
    displayName: 'Publish E2E Test Report'
    inputs:
      pathtoPublish: '${{ parameters.workingDir }}/playwright/playwright-report'
      artifactName: 'e2e-test-report'